<!-- Wappler include head-page="layouts/layout2" is="dmx-app" id="classes" appconnect="local" fontawesome_5="cdn" components="{dmxBootstrap4Modal:{},dmxValidator:{},dmxFormatter:{},dmxBootbox:{},dmxDataTraversal:{},dmxBootstrap4PagingGenerator:{},dmxBootstrap4Alert:{},dmxBootstrap4TableGenerator:{},dmxBootstrap4Collapse:{},dmxStateManagement:{},dmxPreloader:{},dmxDatePicker:{},dmxBootstrap5Navigation:{},dmxBootstrap5Collapse:{},dmxBootstrap5Modal:{},dmxBootstrap5PagingGenerator:{},dmxBootstrap5TableGenerator:{},dmxSockets:{},dmxBootstrap5Popovers:{},dmxBootstrap5Tooltips:{}}" jquery_35="cdn" moment_2="local with locales" bootstrap5="local" dmx-on:load="classesQuery.set('limit',20);classesQuery.set('offset',0)" -->
<script is="dmx-flow" id="tuitioncharge_existsChargeAhead" type="text/dmx-flow">{
  meta: {
    $param: [
      {type: "date", name: "startdate"},
      {type: "object", name: "class"},
      {type: "number", name: "familyid"},
      {type: "date", name: "timenow"},
      {type: "object", name: "student"},
      {type: "number", name: "enroltype"}
    ]
  },
  exec: {
    steps: [
      {
        serverConnect: {
          url: "/api/families/ledger/tuition_checkCurrentPeriodExists",
          site: "SSA-CRM",
          params: {
            startdate: "{{$param.startdate}}",
            chargeahead: "{{appSettings.billing_cycle_charge_ahead}}",
            familyid: "{{$param.familyid}}",
            family_uuid: "{{$param.familyid}}"
          },
          name: "checkTuitionCharges",
          output: true
        }
      },
      {
        run: {
          action: "{{newEnrolmentModal.var_chargeObject.setValue(checkTuitionCharges.data.chargeDetails);newEnrolmentModal.var_ne_enrolType.setValue($_PARAM.enroltype);newEnrolmentModal.var_classDetailsObject.setValue($_PARAM.class);newEnrolmentModal.var_studentDetailsObject.setValue($_PARAM.student)}}"
        }
      }
    ]
  }
}</script>
<link rel="wappler-include" type="content-page" href="classes/classesCalendar.ejs" path="/classes/calview">

<dmx-query-manager id="classesQuery"></dmx-query-manager>
<dmx-serverconnect id="checkClassTimeslot" noload url="/api/classes/checkClassTimeslot"></dmx-serverconnect>


<dmx-serverconnect id="classesBase" url="/api/classes/classesBase" dmx-param:sort="classesQuery.data.sort" dmx-param:dir="classesQuery.data.dir" dmx-param:offset="query.offset" dmx-param:limit="query.limit" dmx-param:startdate="dr_startDate.value" dmx-param:enddate="dr_endDate.value" dmx-on:start="" dmx-param:checkavail_max="appSettings.enrol_availability_max_weeks" dmx-param:makeup_max_book_days="appSettings.enrol_makeup_book_ahead_days" dmx-param:viewtype="" dmx-param:filter_days="class_filter_store.data.filter_days || []" dmx-param:filter_times="class_filter_store.data.filter_times || []" dmx-param:filter_levels="class_filter_store.data.filter_levels || []" dmx-param:filter_instructors="class_filter_store.data.filter_instructors || []" dmx-param:avails_amount="class_filter_store.data.availabilities.amount" dmx-param:avails_type="class_filter_store.data.availabilities.type">
</dmx-serverconnect>


<dmx-serverconnect id="getInstructors" url="/api/staff/getInstructors"></dmx-serverconnect>


<dmx-serverconnect id="searchClasses" url="/api/classes/searchClasses" noload dmx-param:offset=""></dmx-serverconnect>
<dmx-serverconnect id="classHumanDetailsGlobal" url="/api/classes/getClassHumanDetails_SINGLE" noload=""></dmx-serverconnect>

<dmx-serverconnect id="getClassDetails" url="/api/classes/getClassDetails" noload></dmx-serverconnect>

<div class="modal fade" id="enrolmentSearchModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header bg-active" dmx-class:bg-active="dd_classdetails_searchenrol.var_enroltype.value === 'active'" dmx-class:bg-waitlist="dd_classdetails_searchenrol.var_enroltype.value === 'waitlist'" dmx-class:bg-makeup="dd_classdetails_searchenrol.var_enroltype.value === 'makeup'" dmx-class:bg-trial="dd_classdetails_searchenrol.var_enroltype.value === 'trial'" dmx-class:bg-casual="dd_classdetails_searchenrol.var_enroltype.value === 'casual'">
                <h5 class="modal-title" dmx-html="dd_classdetails_searchenrol.var_enroltype.value === 'waitlist' ? '<i class=&quot;fas fa-history fa-fw me-2&quot;></i> Create Waitlist' : dd_classdetails_searchenrol.var_enroltype.value === 'makeup' ? '<i class=&quot;fas fa-arrow-alt-circle-up fa-fw me-2&quot;></i> Create Makeup' : dd_classdetails_searchenrol.var_enroltype.value === 'trial' ? '<i class=&quot;fas fa-question-circle fa-fw me-2&quot;></i> Create Trial' : dd_classdetails_searchenrol.var_enroltype.value === 'casual' ? '<i class=&quot;fas fa-bookmark fa-fw me-2&quot;></i> Create Casual' : '<i class=&quot;fas fa-check-circle fa-fw me-2&quot;></i> Create Active'"><i class="fas fa-check-circle me-2 fa-fw"></i>Create Active

                </h5>
            </div>
            <div class="modal-body">
                <dmx-data-detail id="dd_classdetails_searchenrol" dmx-bind:data="classesBase.data.nextavail.classes" key="uuid">
                    <dmx-value id="var_enroltype" dmx-bind:value="enrolmentSearchModal.active_enroltype_toggle.checked ? 'active' : enrolmentSearchModal.waitlist_enroltype_toggle.checked ? 'waitlist' : enrolmentSearchModal.trial_enroltype_toggle.checked ? 'trial' : enrolmentSearchModal.makeup_enroltype_toggle.checked ? 'makeup' : 'casual'"></dmx-value>
                </dmx-data-detail>
                <p class="d-flex align-items-center mb-2 pb-2 border-bottom" dmx-html="'<i class=&quot;bi-arrow-right-circle fs-5 me-2&quot;></i> Class: '+appSettings.days_array[dd_classdetails_searchenrol.data.day]+' - '+dd_classdetails_searchenrol.data.startTimeDisplay+' '+appSettings.classLevelsByID[dd_classdetails_searchenrol.data.classlevel_uuid].name+' - '+appSettings.instructorsById[dd_classdetails_searchenrol.data.instructor_uuid].trunc_name"><i class="bi-arrow-right-circle fs-5 me-2"></i>Class
                    Details
                </p>
                <section class="pb-4">
                    <div class="row row-cols-1">
                        <div class="col">

                            <label for="inp_searchModal" class="col-form-label">Search</label>
                            <input id="inp_searchModal" name="inp_searchModal" type="text" class="form-control form-control" style="font-size: 0.9rem;" dmx-bind:value="var_fulltextConvert.value" autocomplete="off" dmx-on:updated.debounce:300="run([{runJS:{function:'fulltextConvert',args:[`value`],name:'fullTextConvert'}},{run:{action:`queryManager.set(\'searchtextfilter\',fullTextConvert);searchAll_ResultsModal.var_fulltextConvert.setValue(value)`}},{wait:{delay:200}},{run:{action:`GET_FAMILIES_STUDENTS_FT_search.load({searchtextfilter: query.searchtextfilter})`}}])">
                            <p class="mb-0 form-text">Start searching for families and students to show below.</p>
                        </div>
                        <div class="col d-flex justify-content-start mt-3">

                            <input type="radio" class="btn-check" name="btnradio" id="active_enroltype_toggle" autocomplete="off" checked dmx-bind:checked="enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.value === 'active'" value="standard">
                            <label class="btn btn-sm me-2 btn-active-outline" for="active_enroltype_toggle">Active Enrolment</label>

                            <input type="radio" class="btn-check" name="btnradio" id="trial_enroltype_toggle" autocomplete="off" checked dmx-bind:checked="enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.value === 'trial'" value="trial">
                            <label class="btn btn-sm me-2 btn-trial-outline" for="trial_enroltype_toggle">Trial Enrolment</label>

                            <input type="radio" class="btn-check" name="btnradio" id="makeup_enroltype_toggle" autocomplete="off" dmx-bind:checked="enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.value === 'makeup'" value="makeup" dmx-bind:disabled="enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup_response.code === 101 || enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup_response.code === 102">
                            <label class="btn btn-sm me-2 btn-makeup-outline" for="makeup_enroltype_toggle">Makeup</label>

                            <input type="radio" class="btn-check" name="btnradio" id="casual_enroltype_toggle" autocomplete="off" dmx-bind:checked="enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.value === 'casual'" value="casual" dmx-bind:disabled="enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup_response.code === 101 || enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup_response.code === 102">
                            <label class="btn btn-sm me-2 btn-casual-outline" for="casual_enroltype_toggle">Casual</label>

                            <input type="radio" class="btn-check" name="btnradio" id="waitlist_enroltype_toggle" autocomplete="off" dmx-bind:checked="enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.value === 'waitlist'" value="waitlist">
                            <label class="btn btn-sm me-2 btn-outline-dark" for="waitlist_enroltype_toggle">Waitlist</label>

                        </div>

                    </div>

                </section>
                <section>
                    <div class="row row-cols-1 gx-0" id="rp_families" is="dmx-repeat" dmx-bind:repeat="GET_FAMILIES_STUDENTS_FT_search.data.studentsAndFamilies">
                        <div class="col mb-3">
                            <div class="row gx-0">

                                <div class="col">
                                    <div class="row gx-2">

                                        <div class="col-auto"><a href="#" class="btn btn-outline-light text-body border-2" dmx-bs-tooltip="'Go to Family<br><small>Opens in new tab.</small>'" data-bs-html="true" data-bs-trigger="hover" data-bs-placement="top" dmx-bind:href="'/families/familydetail/'+family" target="_blank"><i class="bi-people fs-4"></i></a></div>
                                        <div class="col d-flex flex-column align-items-start justify-content-center">
                                            <h5 class="mb-0">{{primaryGuardian.firstName+' '+primaryGuardian.lastName}}<br></h5>
                                            <p class="mb-0 mt-1 small text-muted" style="">{{guardians.values(`' ' + firstName +' '+lastName`)}}</p>



                                        </div>

                                    </div>
                                    <div class="row mt-2 g-0">
                                        <div class="col">
                                            <table class="table small align-middle table-bordered">
                                                <thead class="fw-bold border-bottom">
                                                    <tr>
                                                        <th scope="row" class="collapse-cell"></th>
                                                        <th>Student</th>
                                                        <th>Level</th>
                                                        <th>Gender</th>
                                                        <th>Dob</th>
                                                        <th>Age</th>
                                                    </tr>
                                                </thead>
                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="students" id="tb_es_repeatStudents">
                                                    <tr>
                                                        <td class="collapse-cell">
                                                            <button id="addActive" class="btn btn-sm btn-active-outline" dmx-on:click="run([{run:{action:`tuitioncharge_existsChargeAhead.run({class: enrolmentSearchModal.dd_classdetails_searchenrol.data, startdate: dd_classdetails_searchenrol.data.details.active, familyid: family, student: id, enroltype: 1})`}},{wait:{delay:150}},{run:{action:`newEnrolmentModal.var_classDetailsObject.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data);newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.setValue(dd_classdetails_searchenrol.data.details.active)`}},{run:{action:`newEnrolmentModal.var_ne_enrolType.setValue(1)`}},{run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue($value)`}},{run:{action:`enrolmentSearchModal.hide()`}},{run:{action:`newEnrolmentModal.show()`}}])" dmx-show="dd_classdetails_searchenrol.var_enroltype.value === 'active'"><i class="bi-person-plus-fill fs-6"></i>
                                                            </button>
                                                            <button id="addTrial" class="btn btn-sm btn-trial-outline" dmx-on:click="run([{runJS:{function:'nextStartDate',args:[`dateAndTime_days.datetime`,`enrolmentSearchModal.dd_classdetails_searchenrol.data`],name:'nextstartdate'}},{condition:{if:`enrolmentSearchModal.dd_classdetails_searchenrol.data.details.active.formatDate(\'yyyy-MM-dd\') > nextstartdate.formatDate(\'yyyy-MM-dd\')`,then:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data.details.active);newEnrolmentModal.var_overbookingPotential.setValue(true)`}}},else:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.setValue(nextstartdate)`}}}}},{run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue($value);newEnrolmentModal.var_classDetailsObject.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data);newEnrolmentModal.var_ne_enrolType.setValue(3)`}},{run:{action:`enrolmentSearchModal.hide();newEnrolmentModal.show()`}}])" dmx-show="dd_classdetails_searchenrol.var_enroltype.value === 'trial'"><i class="fas fa-question-circle fs-6"></i>
                                                            </button><button id="addMakeup" class="btn btn-sm btn-makeup-outline" dmx-on:click="run([{run:{action:`newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup[0].date.formatDate(\'yyyy-MM-dd\'));newEnrolmentModal.createEnrolmentForm.inp_ne_dropDate.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup[0].date.formatDate(\'yyyy-MM-dd\'))`}},{run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue($value);newEnrolmentModal.var_classDetailsObject.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data);newEnrolmentModal.var_ne_enrolType.setValue(2)`}},{run:{action:`enrolmentSearchModal.hide();newEnrolmentModal.show()`}}])" dmx-show="dd_classdetails_searchenrol.var_enroltype.value === 'makeup'"><i class="fas fa-arrow-alt-circle-up fs-6"></i>
                                                            </button><button id="addCasual" class="btn btn-sm btn-casual-outline" dmx-on:click="run([{run:{action:`newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup[0].date.formatDate(\'yyyy-MM-dd\'));newEnrolmentModal.createEnrolmentForm.inp_ne_dropDate.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data.details.makeup[0].date.formatDate(\'yyyy-MM-dd\'))`}},{run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue($value);newEnrolmentModal.var_classDetailsObject.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data);newEnrolmentModal.var_ne_enrolType.setValue(5)`}},{run:{action:`enrolmentSearchModal.hide();newEnrolmentModal.show()`}}])" dmx-show="dd_classdetails_searchenrol.var_enroltype.value === 'casual'"><i class="fas fa-bookmark fs-6"></i>
                                                            </button><button id="addWaitlist" class="btn btn-sm btn-waitlist-outline" dmx-on:click="run([{run:{action:`enrolmentSearchModal.hide()`}},{run:{action:`newWaitlistModal.var_wl_classDetailsObject.setValue(enrolmentSearchModal.dd_classdetails_searchenrol.data);newWaitlistModal.var_wl_studentDetailsObject.setValue($value)`}},{run:{action:`newWaitlistModal.show()`}}])" dmx-show="dd_classdetails_searchenrol.var_enroltype.value === 'waitlist'"><i class="fas fa-history fs-6"></i>
                                                            </button>



                                                        </td>
                                                        <td dmx-text="firstName +' '+lastName">Jane Doe</td>
                                                        <td dmx-text="level">Ducklings</td>
                                                        <td dmx-text="gender">Female</td>
                                                        <td dmx-text="dob.formatDate('dd-MM-yyyy')">13-12-2019</td>
                                                        <td dmx-text="age">1y 11m</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>



                                </div>
                            </div>
                        </div>

                    </div>
                </section>
            </div>
            <div class="modal-footer border-top">
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal" dmx-on:click="inp_searchModal.setValue(null);queryManager.remove('searchtextfilter')">Cancel</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" is="dmx-bs5-modal" tabindex="-1" role="dialog" id="newEnrolmentModal" nocloseonclick="true" dmx-on:hidden-bs-modal="run({run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue(null);newEnrolmentModal.var_classDetailsObject.setValue(null)`}})">
    <dmx-value id="var_studentDetailsObject"></dmx-value>
    <dmx-value id="var_classDetailsObject"></dmx-value>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <dmx-value id="var_chargeObject"></dmx-value>
            <dmx-value id="var_ne_enrolType"></dmx-value>
            <dmx-value id="var_overbookingPotential"></dmx-value>

            <div class="modal-header bg-active" dmx-class:bg-active="var_ne_enrolType.value == 1" dmx-class:bg-trial="var_ne_enrolType.value == 3" dmx-class:bg-makeup="var_ne_enrolType.value == 2" dmx-class:bg-casual="var_ne_enrolType.value == 5">
                <h5 class="modal-title fw-500" dmx-html="'New '+ appSettings.enrolTypesById[var_ne_enrolType.value].name+' Enrolment: <span class=&quot;fw-400&quot;>'+var_studentDetailsObject.value.firstName+' '+var_studentDetailsObject.value.lastName+'</span>'">Enrol: Jane Doe<br>
                </h5>
                <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">&times;</span>
                </button>
            </div>
            <form is="dmx-serverconnect-form" id="createEnrolmentForm" method="post" action="/api/classes/enrolments/createEnrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-param:isvalid="1" dmx-param:chargeahead="appSettings.billing_charge_ahead" dmx-param:family_uuid="var_studentDetailsObject.value.family" dmx-on:success="run([{run:{action:`notifies1.success(var_studentDetailsObject.value.getValueOrKey(\'fullName\')+\' enroled successfully to - \'+classHumanDetailsGlobal.data.classHumanDetails.day+\' \'+classHumanDetailsGlobal.data.classHumanDetails.level+\' - with \'+classHumanDetailsGlobal.data.classHumanDetails.instructor)`}},{run:{action:`createEnrolmentForm.reset()`}},{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`classesBase.load({days: classesQuery.data.days, times: classesQuery.data.times},true)`,disabled:true}},{run:{action:`enrolmentSearchModal.inp_searchModal.setValue(null);queryManager.remove(\'searchtextfilter\')`}}])" dmx-on:error="run({condition:{if:`newEnrolmentModal.createEnrolmentForm.lastError.status == 901`,then:{steps:{run:{action:`newEnrolEnterDueDate.var_chargeDates.setValue(inp_ne_startDate.value);newEnrolEnterDueDate.show()`}}}}})">
                <div class="modal-body">
                    <p class="d-flex align-items-center mb-4" dmx-html="'<i class=&quot;bi-arrow-right-circle fs-5 me-2&quot;></i> Class: '+var_classDetailsObject.value.day_name+' - '+var_classDetailsObject.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_classDetailsObject.value.classLevel].name+' - '+appSettings.instructorsById[var_classDetailsObject.value.instructorid].trunc_name"><i class="bi-arrow-right-circle fs-5 me-2"></i>Class Details
                    </p>

                    <input type="hidden" class="form-control" id="inp_class_uuid" name="class_uuid" aria-describedby="inp_classId_help" placeholder="Enter Class" dmx-bind:value="newEnrolmentModal.var_classDetailsObject.value.uuid">
                    <input type="hidden" class="form-control" id="inp_student" name="student_uuid" aria-describedby="inp_student_help" placeholder="Enter Student" dmx-bind:value="newEnrolmentModal.var_studentDetailsObject.value.uuid">
                    <div class="row row-cols-3 gy-2 pb-3 border-bottom border-top">
                        <div class="col">
                            <label for="inp_enrolmentType" class="col-form-label form-label">Enrolment type</label>
                            <select id="sel_enrolmentType" class="form-select" name="enrolmentType-sel" dmx-bind:options="appSettings.enrolTypesArray" optiontext="type" optionvalue="id" dmx-bind:value="newEnrolmentModal.var_ne_enrolType.value" dmx-on:changed="run({condition:{if:`sel_enrolmentType.value == 5 || sel_enrolmentType.value == 2`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(inp_ne_startDate.value)`}}},else:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})" readonly="true" disabled="true"></select>
                            <input id="inp_hd_enrolType" name="enrolmentType" type="hidden" class="form-control" dmx-bind:value="sel_enrolmentType.value">
                        </div>
                        <div class="col">

                            <label for="inp_ne_startDate" class="col-form-label form-label">Start date: <span class="text-danger fw-700">*</span></label>

                            <input step="7" is="dmx-date-picker" dmx-bind:mindate="dateAndTime_days.datetime.addDays(dateAndTime_days.datetime.getDate() + ((((var_classDetailsObject.value.day_int - 1) + 7 - dateAndTime_days.datetime.getDay()) % 7) || 7) - dateAndTime_days.datetime.getDate()).addWeeks(-2).formatDate('yyyy-MM-dd')" class="form-control" id="inp_ne_startDate" name="startDate" aria-describedby="inp_ne_startDate_help" placeholder="dd/mm/yyyy" dmx-on:changed="run({condition:{if:`!inp_ne_dropDate.value &amp;&amp; -inp_ne_dropDate.value.formatDate(\'yyyy-MM-dd\').toTimestring() < inp_ne_startDate.value.formatDate(\'yyyy-MM-dd\').toTimesting()`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})" opens="left" format="DD/MM/YYYY" showdropdowns="true" onkeydown="return false">

                        </div>
                        <div class="col">

                            <label for="inp_dropDate" class="col-form-label form-label">Drop date: <span class="text-danger fw-700">*</span></label>
                            <input class="form-control" id="inp_ne_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="dd/mm/yyyy" type="text" is="dmx-date-picker" showdropdowns="true" format="DD/MM/YYYY">

                        </div>
                    </div>
                    <div class="row row-cols-1">
                        <div class="col mt-3 " dmx-show="newEnrolmentModal.var_overbookingPotential.value === true">
                            <p class="fs-5 fw-600 mb-0 text-danger"><i class="bi-exclamation-octagon-fill me-2"></i>WARNING: OVERBOOKING POTENTIAL</p>
                            <p class="mb-2">Please confirm start date with customer. Puddle has defaulted the start date to the next available date for permanent enrolments (active/trial).&nbsp;The next available date for a <b>permanent</b> enrolment is <b>{{newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')}}&nbsp;.</b></p>
                        </div>
                        <div class="col my-2 border-top pt-3" dmx-show="dateAndTime_days.datetime.getDay() == (newEnrolmentModal.var_classDetailsObject.value.day_int - 1)">
                            <div class="row g-0">
                                <div class="col">
                                    <p class="fs-5 fw-600 mb-0 text-danger"><i class="bi-exclamation-octagon-fill me-2"></i>WARNING: CONFIRM START DATE</p>

                                    <p class="mb-0">By default, Puddle automatically sets the start date to the next day (including today) that the class is available.&nbsp;Time is not currently factored into start dates, and there is potential to enrol a student to start today when the class time has already passed.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-body border-top">
                    <div class="row" id="chargedetails">
                        <div class="col">
                            <h5><i class="bi-lightning-charge-fill me-2 text-danger"></i>Charge Details Required
                            </h5>
                            <p>Charges are automatically calculated by Puddle. If charges in the future are detected, Puddle will show all charges that need a charge date and due date below, up to the latest charge in the future. Any missing charges between will be show here and must have the due dates filled out.</p>
                        </div>
                    </div>
                    <div class="row row-cols-2 border-top pt-3 mt-2" dmx-repeat:rp_ne_chargecalc_dates="tuitioncharge_existsChargeAhead.data.checkTuitionCharges.data.chargeahead">
                        <div class="col">
                            <h5 class="fw-400" dmx-text="date.formatDate('MMMM yyyy')">December 2021</h5>
                            <input id="inp_updcharge_monthtoprocess" name="monthtoprocess" type="text" class="form-control" dmx-bind:name="'charges['+$index+'][monthtoprocess]'" dmx-bind:value="date.formatDate('yyyy-MM-dd')">
                        </div>
                        <div class="col-break w-100"></div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="inp_updcharge_chargedate" class="form-label col-form-label">Charge date: <span class="text-danger fw-700">*</span></label>
                                <input type="text" class="form-control" id="inp_updcharge_chargedate" name="inp_updcharge_chargedate" aria-describedby="input1_help" is="dmx-date-picker" dmx-bind:placeholder="appSettings.localization_dateformat" dmx-bind:format="appSettings.localization_dateformat.uppercase()" format="DD/MM/YYYY" placeholder="DD/MM/YYYY" dmx-bind:value="charge ? charge : dateAndTime_days.datetime.formatDate('yyyy-MM-dd')" dmx-bind:readonly="charge ? true : false" required="" dmx-bind:name="'charges['+$index+'][chargedate]'">
                                <small id="bs5-form-group-help2" class="form-text text-muted">Charge date prefilled with database value or today's date.</small>
                            </div>

                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="inp_updcharge_duedate" class="form-label col-form-label">Due date: <span class="text-danger fw-700">*</span></label>
                                <input type="text" class="form-control" id="inp_updcharge_duedate" name="inp_updcharge_duedate" aria-describedby="input1_help" dmx-bind:placeholder="appSettings.localization_dateformat" placeholder="DD/MM/YYYY" is="dmx-date-picker" dmx-bind:format="appSettings.localization_dateformat.uppercase()" format="DD/MM/YYYY" dmx-bind:value="due ? due : null" dmx-bind:name="'charges['+$index+'][duedate]'" required="">
                            </div>

                        </div>
                    </div>
                </div>
            </form>
            <div class="modal-footer d-flex justify-content-between border-top">
                <button type="button" class="btn btn-outline-danger" dmx-on:click="run([{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`enrolmentSearchModal.show()`}}])" data-bs-dismiss="modal">Back</button>
                <button class="btn btn-primary" dmx-on:click="run({condition:{if:`newEnrolmentModal.var_overbookingPotential.value`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Change enrolment.'}},message:`'<p>The next availability for this class is <strong>'+newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')+'</strong>.</p><p>The start date you have entered is <strong>'+newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.value.formatDate('dd MMMM yyyy')+'</strong>.</p>Would you like to overbook this class or change the enrolment?'`,title:'Overbook Warning',then:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}}},else:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}})">Create Enrolment</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" is="dmx-bs5-modal" tabindex="-1" role="dialog" id="newMakeupCasualModal" nocloseonclick="true" dmx-on:hidden-bs-modal="run({run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue(null);newEnrolmentModal.var_classDetailsObject.setValue(null)`}})">
    <dmx-value id="var_mu_studentDetailsObject"></dmx-value>
    <dmx-value id="var_mu_classDetailsObject"></dmx-value>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <dmx-value id="var_mu_overbookingPotential"></dmx-value>

            <div class="modal-header" dmx-class:bg-makeup="newMakeupCasualModal.createMakeupForm.sel_mu_enrolmentType.value == 1" dmx-class:bg-casual="newMakeupCasualModal.createMakeupForm.sel_mu_enrolmentType.value == 3">
                <h5 class="modal-title fw-500" dmx-text="'Enrol: '+var_mu_studentDetailsObject.value.firstName+' '+var_mu_studentDetailsObject.value.lastName">Enrol: Jane Doe<br>
                </h5>
                <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="d-flex align-items-center mb-2 pb-2 border-bottom" dmx-html="'<i class=&quot;bi-arrow-right-circle fs-5 me-2&quot;></i> Class: '+var_mu_classDetailsObject.value.day_name+' - '+var_mu_classDetailsObject.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_mu_classDetailsObject.value.classLevel].name+' - '+appSettings.instructorsById[var_mu_classDetailsObject.value.instructorid].trunc_name"><i class="bi-arrow-right-circle fs-5 me-2"></i>Class Details
                </p>
                <form is="dmx-serverconnect-form" id="createMakeupForm" method="post" action="/api/classes/createEnrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-param:isvalid="1" dmx-on:success="run([{run:{action:`notifies1.success(var_studentDetailsObject.value.getValueOrKey(\'fullName\')+\' enroled successfully to - \'+classHumanDetailsGlobal.data.classHumanDetails.day+\' \'+classHumanDetailsGlobal.data.classHumanDetails.level+\' - with \'+classHumanDetailsGlobal.data.classHumanDetails.instructor)`}},{run:{action:`createEnrolmentForm.reset()`}},{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`classesBase.load({days: classesQuery.data.days, times: classesQuery.data.times},true)`}},{run:{action:`enrolmentSearchModal.inp_searchModal.setValue(null);queryManager.remove(\'searchtextfilter\')`}}])">
                    <input type="hidden" class="form-control" id="inp_mu_classId" name="classId" aria-describedby="inp_classId_help" placeholder="Enter Class" dmx-bind:value="newEnrolmentModal.var_classDetailsObject.value.id">
                    <input type="hidden" class="form-control" id="inp_mu_student" name="student" aria-describedby="inp_student_help" placeholder="Enter Student" dmx-bind:value="newEnrolmentModal.var_studentDetailsObject.value.id">
                    <div class="row row-cols-3 gy-2">
                        <div class="col">
                            <label for="inp_enrolmentType" class="col-form-label form-label">Enrolment type</label>
                            <select id="sel_mu_enrolmentType" class="form-select" name="enrolmentType1" dmx-bind:options="classesBase.data.enrolmentTypes.where('id', [2,4], 'inArray')" optiontext="type" optionvalue="id" dmx-bind:value="1" dmx-on:changed="run({condition:{if:`sel_enrolmentType.value == 5 || sel_enrolmentType.value == 2`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(inp_ne_startDate.value)`}}},else:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})"></select>
                        </div>
                        <div class="col-break w-100"></div>
                        <div class="col">

                            <label for="inp_mu_startDate" class="col-form-label form-label">Start date:</label>

                            <input step="7" is="dmx-date-picker" dmx-bind:mindate="dateAndTime_days.datetime.addDays(dateAndTime_days.datetime.getDate() + ((((var_mu_classDetailsObject.value.day_int - 1) + 7 - dateAndTime_days.datetime.getDay()) % 7) || 7) - dateAndTime_days.datetime.getDate()).addWeeks(-2).formatDate('yyyy-MM-dd')" class="form-control" id="inp_mu_startDate" name="startDate" aria-describedby="inp_ne_startDate_help" placeholder="dd/mm/yyyy" dmx-on:changed="run({condition:{if:`!inp_ne_dropDate.value &amp;&amp; -inp_ne_dropDate.value.formatDate(\'yyyy-MM-dd\').toTimestring() < inp_ne_startDate.value.formatDate(\'yyyy-MM-dd\').toTimesting()`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})" opens="left" format="DD/MM/YYYY" showdropdowns="true" onkeydown="return false">

                        </div>
                        <div class="col">

                            <label for="inp_dropDate" class="col-form-label form-label">Drop date</label>
                            <input class="form-control" id="inp_mu_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="dd/mm/yyyy" type="text" is="dmx-date-picker" showdropdowns="true" format="DD/MM/YYYY">

                        </div>
                    </div>
                    <div class="row mt-3 row-cols-1 gx-0">
                        <div class="col" dmx-show="newEnrolmentModal.var_overbookingPotential.value === true">
                            <p class="fs-5 fw-600 mb-0 text-danger"><i class="bi-exclamation-octagon-fill me-2"></i>WARNING: OVERBOOKING POTENTIAL</p>

                            <p class="mb-2 small">Please confirm start date with customer. Puddle has defaulted the start date to the next available date for permanent enrolments (active/trial).&nbsp;<br>The next available date for a <b>permanent</b> enrolment is <b>{{newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')}}&nbsp;.</b></p>
                        </div>
                        <div class="col my-2 border-top pt-2" dmx-show="dateAndTime_days.datetime.getDay() == (newEnrolmentModal.var_classDetailsObject.value.day_int - 1)">
                            <div class="row g-0">
                                <div class="col">
                                    <p class="fs-5 fw-600 mb-0 text-danger"><i class="bi-exclamation-octagon-fill me-2"></i>WARNING: CONFIRM START DATE</p>

                                    <p class="small mb-0">By default, Puddle automatically sets the start date to the next day (including today) that the class is available.&nbsp;Time is not currently factored into start dates, and there is potential to enrol a student to start today when the class time has already passed.</p>
                                </div>
                            </div>


                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer d-flex justify-content-between border-top">
                <button type="button" class="btn btn-outline-danger" dmx-on:click="run([{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`enrolmentSearchModal.show()`}}])" data-bs-dismiss="modal">Back</button>
                <button class="btn" dmx-class:btn-active="newEnrolmentModal.createEnrolmentForm.sel_enrolmentType.value == 1" dmx-class:btn-trial="newEnrolmentModal.createEnrolmentForm.sel_enrolmentType.value == 3" dmx-on:click="run({condition:{if:`newEnrolmentModal.var_overbookingPotential.value`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Change enrolment.'}},message:`'<p>The next availability for this class is <strong>'+newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')+'</strong>.</p><p>The start date you have entered is <strong>'+newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.value.formatDate('dd MMMM yyyy')+'</strong>.</p>Would you like to overbook this class or change the enrolment?'`,title:'Overbook Warning',then:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}}},else:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}})">Create Enrolment</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="newWaitlistModal" is="dmx-bs5-modal" tabindex="-1" nocloseonclick="true" dmx-on:hidden-bs-modal="var_wl_classDetailsObject.setValue(null);var_wl_studentDetailsObject.setValue(null)">
    <dmx-value id="var_wl_classDetailsObject"></dmx-value>
    <dmx-value id="var_wl_studentDetailsObject"></dmx-value>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header text-white bg-dark">
                <h5 class="modal-title"><i class="fas fa-history me-2"></i>Confirm Waitlist
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col mb-3 pb-3 border-bottom">
                        <p dmx-html="'<i class=&quot;bi-arrow-return-right me-2&quot;></i>'+var_wl_classDetailsObject.value.day_name+' - '+var_wl_classDetailsObject.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_wl_classDetailsObject.value.classLevel].name+' - '+appSettings.instructorsById[var_wl_classDetailsObject.value.instructorid].trunc_name" class="mb-3 "><i class="bi-arrow-return-right me-2"></i>Class Details</p>
                        <p class="text-muted small mb-0"><i class="bi-exclamation-triangle-fill me-2 text-warning"></i>Note: To add longer waitlist time periods, please add waitlist from student details page. The details for this waitlist form are specific to the class listed above. Multiple days per waitlist request are not currently supported.</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h6 class="fw-bold">Waitlist Details</h6>
                        <div class="row row-cols-1 gy-1">
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Day:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_classDetailsObject.value.day_name">Monday</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Start Time:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_classDetailsObject.value.startTimeDisplay">10:00 AM</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">End Time:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_classDetailsObject.value.endTimeDisplay">10:30 AM</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Level:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="appSettings.classLevelsByID[var_wl_classDetailsObject.value.classLevel].name">Duckling</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Instructor:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="appSettings.instructorsById[var_wl_classDetailsObject.value.instructorid].trunc_name">Jane D.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <h6 class="fw-bold">Student for Waitlist</h6>
                        <div class="row row-cols-1 gy-1">
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">First Name:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.firstName">Jane</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Last Name:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.lastName">Doe</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Date of Birth:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.dob.formatDate('dd-MM-yyyy')">10-11-2011</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Age:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.age">10y 0m</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Level:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.level">Duckling</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Gender:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.gender">F</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col mt-2 pt-2 border-top">
                        <form id="form_waitlistCreate" method="post" is="dmx-serverconnect-form" action="/api/classes/createWaitlist" dmx-on:success="notifies1.success('Waitlist successfully created.');newWaitlistModal.hide();enrolmentSearchModal.inp_searchModal.setValue(null);form_waitlistCreate.reset();classesBase.load({},true)" dmx-on:error="notifies1.danger('Something went wrong. Please try again. Error: '+newWaitlistModal.form_waitlistCreate.lastError.status +' - '+newWaitlistModal.form_waitlistCreate.lastError.message+' - '+newWaitlistModal.form_waitlistCreate.lastError.response)">
                            <input id="inp_wl_starttime" name="starttimedec" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.startTimeDecimal">
                            <input id="inp_wl_endtime" name="endtimedec" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.endTimeDecimal">
                            <input id="inp_wl_dayint" name="dayint" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.day_int">
                            <input id="inp_wl_instructor" name="instructor" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.instructorid">
                            <input id="inp_wl_studentid" name="studentid" type="hidden" class="form-control" dmx-bind:value="var_wl_studentDetailsObject.value.id">
                            <input id="inp_wl_classlevel" name="classlevel" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.classLevel">
                            <div class="mb-3">
                                <label for="inp_wl_requestdate" class="form-label col-form-label">Request Date</label>
                                <input type="date" class="form-control" id="inp_wl_requestdate" name="request_date" aria-describedby="input1_help" readonly="true" style="" dmx-bind:value="dateAndTime_days.datetime.formatDate('yyyy-MM-dd')">
                            </div>
                            <div class="mb-3">
                                <label for="textarea1" class="form-label col-form-label w-100">Waitlist Notes:</label>
                                <small id="textarea_wl_notes_Help" class="form-text text-muted m-0">Add any notes to this waitlist. E.g. <i>"Waiting for sibling with other waitlist."</i></small>
                                <textarea id="textarea_wl_notes" name="notes" class="form-control rounded-3 w-100" rows="4"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal" dmx-on:click="run([{run:{action:`newWaitlistModal.hide()`}},{run:{action:`enrolmentSearchModal.show()`}}])">Back</button>
                <button type="button" class="btn btn-primary" dmx-on:click="form_waitlistCreate.submit();enrolmentSearchModal.inp_searchModal.setValue(null);queryManager.remove('searchtextfilter');notifies1.success('Waitlist Created.');classesBase.load({},true)">Add Waitlist</button>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="upgradeWaitlistModal" is="dmx-bs5-modal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title fw-light">Upgrade Waitlist</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body border-bottom">
                <dmx-value id="var_uw_studentDetailsObject"></dmx-value>
                <dmx-value id="var_uw_classDetailsObject"></dmx-value>
                <p class="mb-0 d-flex align-items-center fw-500" dmx-html="'<i class=&quot;bi-arrow-right-circle me-2 fs-5&quot;></i>Target Class: '+upgradeWaitlistModal.dd_uw_classDetails.data.day_name+' - '+upgradeWaitlistModal.dd_uw_classDetails.data.startTimeDisplay+' '+appSettings.classLevelsByID[upgradeWaitlistModal.dd_uw_classDetails.data.classLevel].name+' - '+appSettings.instructorsById[upgradeWaitlistModal.dd_uw_classDetails.data.instructorid].trunc_name"><i class="bi-arrow-right-circle me-2 fs-5"></i>Target Class: Monday - 10:00 AM Duckling - John D.
                </p>
            </div>
            <div class="modal-body border-bottom">
                <form id="form_upgradeWaitlist" is="dmx-serverconnect-form" method="post" action="/api/classes/waitlist/upgradeWaitlist">
                    <dmx-value id="var_uw_details"></dmx-value>
                    <div class="mb-3">
                        <label for="inp_uw_startDate" class="form-label col-form-label">Start Date <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="inp_uw_startDate" name="startDate" aria-describedby="input1_help" placeholder="dd/mm/yyyy" is="dmx-date-picker" format="DD/MM/YYYY" required="" data-msg-required="Please add a start date." dmx-bind:value="form_upgradeWaitlist.var_uw_details.value">
                    </div>

                    <div class="row">
                        <div class="col">
                            <div class="mb-3">
                                <label for="sel_uw_enroltype" class="form-label col-form-label">Enrolment Type <span class="text-danger">*</span></label>
                                <select id="sel_uw_enroltype" class="form-select" required="">
                                    <option value="1">Active Enrolment</option>
                                    <option value="3">Trial Enrolment</option>
                                </select>
                                <small id="select1Help" class="form-text text-muted">Select between active and trial enrolment types. Default is active.</small>
                            </div>

                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-body">
                <dmx-data-detail id="dd_uw_waitlistDetails" dmx-bind:data="dd_uw_classDetails.data.wait_enrols" key="id"></dmx-data-detail>
                <dmx-data-detail id="dd_uw_classDetails" dmx-bind:data="classesBase.data.rp_enrols" key="id">

                </dmx-data-detail>
                <div class="row">
                    <div class="col">
                        <div class="row g-0">
                            <div class="col p-3 border small" style="background: #fbfbfb;">
                                <h6 class="fw-500">Waitlist Details</h6>
                                <div class="row row-cols-1 gy-1">
                                    <div class="col mb-2 pb-2 border-bottom">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Request Date:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="dd_uw_waitlistDetails.data.request_date.formatDate('dd/MM/yyyy')">15/11/2021</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">

                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Day:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.days_array[dd_uw_waitlistDetails.data.dayint]">Monday</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Wait From:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.ct_obj[dd_uw_waitlistDetails.data.starttimedec].display">10:00 AM</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Wait To:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.ct_obj[dd_uw_waitlistDetails.data.endtimedec].display">10:30 AM</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Level:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.classLevelsByID[dd_uw_waitlistDetails.data.classlevel].name">Duckling</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Instructor:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.instructorsById[dd_uw_waitlistDetails.data.instructor].trunc_name">Jane D.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-12">
                                                <p class="mb-0 text-muted">Notes:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="dd_uw_waitlistDetails.data.notes || '-'">Lorem ipsum dolor sit amet. Consecuteur something something...</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col p-3 border border-start-0">
                                <h6 class="fw-500">Student for Waitlist</h6>
                                <div class="row row-cols-1 gy-1">
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">First Name:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.firstName">Jane</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Last Name:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.lastName">Doe</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Date of Birth:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.dob.formatDate('dd-MM-yyyy')">10-11-2011</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Age:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.age">10y 0m</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Level:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.classLevelsByID[upgradeWaitlistModal.var_uw_studentDetailsObject.value.classlevel].name">Duckling</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

            <div class="modal-footer border-top d-flex justify-content-between">
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary"><i class="bi-stars me-2"></i>Upgrade
                </button>
            </div>
        </div>
    </div>

</div>

<div class="modal fade" id="createClassModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:hidden-bs-modal="createClassForm.reset()">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header align-items-center bg-primary text-light">
                <h5 class="modal-title fw-light">Create New Class</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">


                <form id="createClassForm" is="dmx-serverconnect-form" method="post" action="/api/classes/createClass" dmx-on:success="classesBase.load();createClassModal.hide()">



                    <div class="row">
                        <div class="col">
                            <h5 class="text-uppercase mb-2 pb-2 border-bottom">Schedule</h5>
                        </div>
                    </div>

                    <fieldset dmx-bind:disabled="ncm_timeslotError.collapsed ? false : true">
                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">


                            <dmx-value id="var_selectedTimeDecimal"></dmx-value>
                            <dmx-value class="d-none" id="var_classDurationSum" dmx-bind:value="(ncm_startTimeSelect.value.toNumber() + ncm_durationSelect.value.toNumber())" dmx-on:updated="startEndTimeCalc.run()"></dmx-value>
                            <dmx-value id="var_startTimeDisplay" dmx-on:updated="hd_inputClassStartDisplay.setValue(value)"></dmx-value>
                            <dmx-value id="var_endTimeDisplay"></dmx-value>
                            <script is="dmx-flow" id="startEndTimeCalc" type="text/dmx-flow">
                                {
                                condition: {
                                    if: "{{ncm_startTimeSelect.value !== \"\" && ncm_durationSelect.value !== \"\"}}",
                                    then: {
                                    steps: {
                                        runJS: {
                                            function: "decimalToTime",
                                            args: ["{{var_classDurationSum.value}}"],
                                            name: "endTimeCalc",
                                            output: true
                                        }
                                    }
                                    }
                                }
                            }
                        </script>
                            <script is="dmx-flow" id="timeToDisplay" type="text/dmx-flow" dmx-on:done="run({run:{action:`var_startTimeDisplay.setValue(timeToDisplay.data.displayTime)`}})">
                                {
                                runJS: {
                                    function: "selectedTimeToDisplay",
                                    args: ["{{var_selectedTimeDecimal.value}}"],
                                    name: "displayTime",
                                    output: true
                                }
                            }
                        </script>
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_daySelect" class="col-form-label form-label">Day</label>
                                    <select id="ncm_daySelect" class="form-select" dmx-bind:options="classesBase.data.days.days" optiontext="name" optionvalue="id">
                                        <option selected="" value="" disabled="">Select Day</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_startTimeSelect" class="col-form-label form-label">Start Time:</label>
                                    <select id="ncm_startTimeSelect" class="form-select" dmx-bind:options="appSettings.ct_array" optiontext="display" optionvalue="decimal" dmx-on:changed="var_selectedTimeDecimal.setValue(value);timeToDisplay.run()">
                                        <option selected="" value="">Select Start Time</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_durationSelect" class="col-form-label form-label">Duration</label>
                                    <select id="ncm_durationSelect" class="form-select" dmx-bind:options="appSettings.duration_array" optiontext="display" optionvalue="value">
                                        <option selected="" value="">Select Class Duration</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">

                                <div class="mb-3">
                                    <label for="ncm_endTimeInput" class="col-form-label form-label">End Time:</label>
                                    <input type="text" class="form-control" id="ncm_endTimeInput" aria-describedby="input1_help" disabled="true" dmx-bind:value="startEndTimeCalc.data.endTimeCalc">
                                    <small id="bs4-form-group-help8" class="form-text text-muted">Calculated from class start and duration.</small>
                                </div>
                            </div>
                        </div>

                        <hr>
                        <div class="row">
                            <div class="col">
                                <h5 class="text-uppercase mb-2 pb-2 border-bottom">Class Details</h5>
                            </div>
                        </div>

                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">


                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_daySelect" class="col-form-label form-label">Instructor</label>
                                    <select id="ncm_instructorSelect" class="form-select" dmx-bind:value="getInstructors.data.getInstructors" required="" dmx-bind:options="getInstructors.data.getInstructors.sort(firstName)" optionvalue="id" optiontext="firstName+' '+lastName.trunc(1, true, '.')">
                                        <option selected="" value="">Select Instructor</option>
                                    </select>
                                </div>

                            </div>



                        </div>
                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_daySelect" class="col-form-label form-label">Class Level</label>
                                    <select id="ncm_classLevelSelect" class="form-select" required="" dmx-bind:options="getLevels.data.query" optiontext="name " optionvalue="id" dmx-on:updated="run([{runJS:{function:'getSelectText',args:['#ncm_classLevelSelect'],name:'getSelectText'}},{run:{action:`createClassModal.createClassForm.inp_hd_classType.setValue(appSettings.classLevels[getSelectText].classType);createClassModal.createClassForm.var_classTypeName.setValue(appSettings.classLevels[getSelectText].classType_longName)`}}])">
                                        <option selected="" value="">Select Level</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3 mb-0">
                                    <label for="classType" class="col-form-label form-label">Class Type</label>
                                    <input type="text" class="form-control" id="classType" name="classTypeLongName" aria-describedby="input1_help" readonly="true" dmx-bind:value="var_classTypeName.value" disabled="true">
                                    <small id="bs4-form-group-help7" class="form-text text-muted">Auto-updated after class level selected.</small>

                                </div>
                                <dmx-value id="var_classTypeName"></dmx-value>

                            </div>
                        </div>
                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                            <div class="col">
                                <div class="mb-3">
                                    <label for="inp_max" class="col-form-label form-label">Max Students</label>
                                    <input type="text" class="form-control" id="inp_max" name="max" aria-describedby="input1_help" placeholder="E.g. 1" required="" data-rule-number="" data-msg-number="Numbers only.">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <div class="row" id="r_timeslotCheckError">
                        <div class="col">
                            <input id="inp_hd_classType" name="classType" class="form-control" type="hidden"><input id="hd_inputClassDay" name="day" type="hidden" class="form-control" dmx-bind:value="ncm_daySelect.value">
                            <input id="hd_inputClassStart" name="startTimeDecimal" type="hidden" class="form-control" dmx-bind:value="ncm_startTimeSelect.value">
                            <input id="hd_inputClassEnd" name="endTimeDecimal" type="hidden" class="form-control" dmx-bind:value="var_classDurationSum.value">
                            <input id="hd_inputClassStartDisplay" name="startTimeDisplay" type="hidden" class="form-control" dmx-bind:value="var_startTimeDisplay.value">
                            <input id="hd_inputClassEndDisplay" name="endTimeDisplay" type="hidden" class="form-control" dmx-bind:value="ncm_endTimeInput.value">
                            <input id="hd_inputInstructor" name="instructor" type="hidden" class="form-control" dmx-bind:value="ncm_instructorSelect.value">
                            <input id="hd_inputLevel" name="classLevel" type="hidden" class="form-control" dmx-bind:value="ncm_classLevelSelect.value">
                        </div>
                    </div>

                </form>

                <div class="collapse" id="ncm_timeslotError" is="dmx-bs5-collapse" dmx-bind:show="checkClassTimeslot.data.classTSAvailability > 0">
                    <hr>
                    <div class="d-flex align-items-stretch flex-column">
                        <div class="card text-white bg-danger">

                            <div class="card-header">
                                <h5 class="mb-0">{{checkClassTimeslot.data.classTSAvailability[0].instructorName}} already has classes at this time.</h5>
                            </div>
                            <div class="card-body bg-light">
                                <div class="d-flex">
                                    <div class="table-responsive">
                                        <table class="table table-sm mb-0">
                                            <thead>
                                                <tr>
                                                    <th>Id</th>
                                                    <th>Day</th>
                                                    <th>Level</th>
                                                    <th>Start</th>
                                                    <th>End</th>
                                                    <th>Instructor</th>
                                                </tr>
                                            </thead>
                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="checkClassTimeslot.data.classTSAvailability" id="tableRepeat2">
                                                <tr>
                                                    <td dmx-text="id"></td>
                                                    <td dmx-text="dayName"></td>
                                                    <td dmx-text="levelName"></td>
                                                    <td dmx-text="startTimeDisplay"></td>
                                                    <td dmx-text="endTimeDisplay"></td>
                                                    <td dmx-text="instructorName"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div class="d-flex justify-content-between">

                                    <button id="changeClassDetailsBtn" class="btn btn-outline-light" dmx-on:click="run([{run:{action:`createClassModal.ncm_timeslotError.hide()`}},{wait:{delay:300}},{run:{action:`checkClassTimeslot.reset()`}}])"><i class="fas fa-undo-alt  fa-fw me-1"></i>Change</button><button id="submitFormAnywayBtn" class="btn btn-outline-light"><i class="fas fa-plus-circle fa-fw me-1"></i>Create Anyway
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <p></p>
            <div class="modal-footer">
                <fieldset dmx-bind:disabled="ncm_timeslotError.collapsed ? false : true">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>

                    <button class="btn btn-primary" dmx-on:click="run({condition:{if:`content.createClassModal.ncm_timeslotError.collapsed`,then:{steps:[{run:{action:`checkClassTimeslot.load({instructor: createClassForm.hd_inputInstructor.value, day: createClassForm.hd_inputClassDay.value, starttimedecimal: createClassForm.hd_inputClassStart.value, endtimedecimal: createClassForm.hd_inputClassEnd.value, classid: \'\', isactive: \'1\'})`}},{wait:{delay:200}},{condition:{if:`content.checkClassTimeslot.data.classTSAvailability.length > 0`,then:{steps:{run:{action:`createClassModal.ncm_timeslotError.show()`}}},else:{steps:{run:{action:`createClassModal.createClassForm.submit()`}}}}}]},else:{steps:{run:{action:`createClassModal.createClassForm.submit()`}}}}})">Create
                        Class</button>
                </fieldset>
            </div>
        </div>
    </div>
</div>
<div class="modal fade draggable-modal" id="editClassModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:show-bs-modal="run([{run:{action:`editClassForm.ec_startEndTimeCalc.run()`}},{run:{action:`editClassForm.ec_timeToDisplay.run()`}}])" dmx-on:hidden-bs-modal="run([{run:{action:`checkClassTimeslot.reset()`}},{run:{action:`editClassForm.reset();editClassModal.var_classDetails.setValue(null)`}},{runJS:{function:'pd_dirtyFormCheck_destroy'}}])" dmx-on:shown-bs-modal="run({runJS:{function:'pd_dirtyFormCheck_init',args:['editClassForm']}})">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <dmx-value id="var_classDetails"></dmx-value>
            <dmx-value id="var_timeslotCheck" dmx-bind:value="checkClassTimeslot.data.classTSAvailability.length > 0"></dmx-value>

            <div class="modal-header align-items-center bg-secondary text-white">
                <dmx-value id="ec_var_classTitle"></dmx-value>
                <h5 class="modal-title text-start fw-light" dmx-text="'Edit Class: '+var_classDetails.value.day_name+' - '+var_classDetails.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_classDetails.value.classLevel].name+' - '+appSettings.instructorsById[var_classDetails.value.instructorid].trunc_name">Edit Class: Monday - 10:00 AM Duckling - Ron S.</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <dmx-data-detail id="dd_editClass" dmx-bind:data="classesBase.data.rp_enrols" key="id">
                    <form id="editClassForm" is="dmx-serverconnect-form" method="post" action="/api/classes/updateClass" dmx-on:success="editClassModal.hide();classesBase.load({sort: classesQuery.data.sort, dir: classesQuery.data.dir, offset: classesQuery.data.offset, limit: classesQuery.data.limit, days: classesQuery.data.days, times: classesQuery.data.times, levels: classesQuery.data.levels, instructors: classesQuery.data.instructors})" dmx-param:classid="getClassDetails.data.getClassDetails.id">
                        <fieldset dmx-bind:disabled="ecm_timeslotError.collapsed ? false : true">

                            <div class="row">
                                <div class="col">
                                    <p class="fw-500 mb-0">Schedule</p>
                                </div>
                            </div>

                            <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">

                                <dmx-value id="ec_var_selectedTimeDecimal"></dmx-value>
                                <dmx-value class="d-none" id="ec_var_classDurationSum" dmx-bind:value="(ecm_startTimeSelect.value.toNumber() + ecm_durationSelect.value.toNumber())" dmx-on:updated="ec_startEndTimeCalc.run()"></dmx-value>
                                <dmx-value id="ec_var_startTimeDisplay" dmx-on:updated="ec_hd_inputClassStartDisplay.setValue(value)"></dmx-value>
                                <dmx-value id="ec_var_endTimeDisplay"></dmx-value>
                                <script is="dmx-flow" id="ec_startEndTimeCalc" type="text/dmx-flow" dmx-on:done="ecm_endTimeInput.setValue(ec_startEndTimeCalc.data.endTimeCalc)">
                                    {
                                    condition: {
                                        if: "{{ecm_startTimeSelect.value !== \"\" && ecm_durationSelect.value !== \"\"}}",
                                        then: {
                                        steps: {
                                            runJS: {
                                                function: "decimalToTime",
                                                args: ["{{ec_var_classDurationSum.value}}"],
                                                name: "endTimeCalc",
                                                output: true
                                            }
                                        }
                                        }
                                    }
                                }
                            </script>
                                <script is="dmx-flow" id="ec_timeToDisplay" type="text/dmx-flow" dmx-on:done="run({run:{action:`ec_var_startTimeDisplay.setValue(ec_timeToDisplay.data.displayTime);editClassModal.editClassForm.ec_var_startTimeDisplay.setValue(ec_timeToDisplay.data.displayTime)`}})">
                                    {
                                    runJS: {
                                        function: "selectedTimeToDisplay",
                                        args: ["{{ec_var_selectedTimeDecimal.value}}"],
                                        name: "displayTime",
                                        output: true
                                    }
                                }
                            </script>
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="ecm_daySelect" class="col-form-label form-label">Day</label>
                                        <select id="ecm_daySelect" class="form-select" dmx-bind:value="var_classDetails.value.day_int" dmx-bind:options="appSettings.days_obj" optiontext="dayname" optionvalue="dayint">
                                            <option selected="" value="" disabled="">Select Day</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="ecm_startTimeSelect" class="col-form-label form-label">Start Time:</label>
                                        <select id="ecm_startTimeSelect" class="form-select" dmx-bind:options="appSettings.ct_array" optiontext="display" optionvalue="decimal" dmx-on:updated="ec_var_selectedTimeDecimal.setValue(value);ec_timeToDisplay.run()" dmx-bind:value="var_classDetails.value.startTimeDecimal">
                                            <option selected="" value="">Select Start Time</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="ecm_durationSelect" class="col-form-label form-label">Duration</label>
                                        <select id="ecm_durationSelect" class="form-select" dmx-bind:options="appSettings.duration_array" optiontext="display" optionvalue="value" dmx-bind:value="(var_classDetails.value.endTimeDecimal - var_classDetails.value.startTimeDecimal)">
                                            <option selected="" value="">Select Class Duration</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col">

                                    <div class="mb-3">
                                        <label for="ecm_endTimeInput1" class="col-form-label form-label">End Time:</label>
                                        <input type="text" class="form-control" id="ecm_endTimeInput" aria-describedby="input1_help" dmx-bind:value="dd_classDetails.data.endTimeDisplay" readonly="true">
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col">
                                    <p class="fw-500 mb-0">Class Details</p>

                                </div>
                            </div>
                            <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="ecm_daySelect1" class="col-form-label form-label">Instructor</label>
                                        <select id="ecm_instructorSelect" class="form-select" dmx-bind:value="var_classDetails.value.instructorid" required="" dmx-bind:options="appSettings.instructors" optionvalue="id" optiontext="trunc_name">
                                            <option selected="" value="">Select Instructor</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="ecm_daySelect1" class="col-form-label form-label">Class Level</label>
                                        <select id="ecm_classLevelSelect" class="form-select" dmx-bind:value="var_classDetails.value.classLevel" required="" dmx-bind:options="getLevels.data.query" optiontext="name" optionvalue="id">
                                            <option selected="" value="">Select Level</option>
                                        </select>
                                    </div>
                                </div>

                            </div>
                            <hr>


                        </fieldset>
                        <div class="row justify-content-end">
                            <div class="col d-flex w-100 justify-content-start flex-column">
                                <p class="mb-0 fw-500">Additional</p>
                                <div class="mb-3 flex-row" id="input1_group" is="dmx-checkbox-group">

                                    <div class="col-sm-10 align-self-center ps-0">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="ec_checkboxIsActive" dmx-bind:checked="editClassModal.dd_editClass.data.isactive" dmx-bind:value="checked ? true : false" required="" value="true">
                                            <label class="form-check-label clickable fw-bold" for="ec_checkboxIsActive" dmx-text="ec_checkboxIsActive.checked ? &quot;Active&quot; : &quot;Inactive&quot;" dmx-class:text-primary="ec_checkboxIsActive.checked">Active</label>
                                        </div><small id="bs4-form-group-help1" class="form-text text-muted mt-2">You can deactivate this class by setting the toggle to the "off" position.</small>


                                    </div>
                                </div>
                                <small id="bs4-form-group-help2" class="form-text text-muted text-end" dmx-text="'Class ID: '+var_classDetails.value.id">ClassID: 12345</small>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">

                                <input id="ec_hd_inputClassID" name="classid" type="hidden" class="form-control" dmx-bind:value="getClassDetails.data.getClassDetails.id">
                                <input id="ec_hd_inputClassDay" name="day" type="hidden" class="form-control" dmx-bind:value="ecm_daySelect.value"><input id="ec_hd_inputClassStart" name="startTimeDecimal" type="hidden" class="form-control" dmx-bind:value="ecm_startTimeSelect.value">
                                <input id="ec_hd_inputClassEnd" name="endTimeDecimal" type="hidden" class="form-control" dmx-bind:value="ec_var_classDurationSum.value">
                                <input id="ec_hd_inputClassStartDisplay" name="startTimeDisplay" type="hidden" class="form-control" dmx-bind:value="ec_var_startTimeDisplay.value">
                                <input id="ec_hd_inputClassEndDisplay" name="endTimeDisplay" type="hidden" class="form-control" dmx-bind:value="ecm_endTimeInput.value">
                                <input id="ec_hd_inputInstructor" name="instructor" type="hidden" class="form-control" dmx-bind:value="ecm_instructorSelect.value">
                                <input id="ec_hd_inputLevel" name="classLevel" type="hidden" class="form-control" dmx-bind:value="ecm_classLevelSelect.value">
                                <input id="ec_hd_inputIsActive" name="isactive" class="form-control" dmx-bind:value="input1_group.ec_checkboxIsActive.checked ? 1 : 0" type="hidden">
                            </div>
                        </div>
                    </form>
                    <div class="collapse" id="ecm_timeslotError" is="dmx-bs5-collapse" dmx-bind:show="editClassModal.var_timeslotCheck.value">
                        <hr>
                        <div class="d-flex align-items-stretch flex-column">
                            <div class="card text-white bg-danger">

                                <div class="card-header">
                                    <h5 class="mb-0">{{checkClassTimeslot.data.classTSAvailability[0].instructorName}} already has classes at this time.</h5>
                                </div>
                                <div class="card-body bg-light">
                                    <div class="d-flex">
                                        <div class="table-responsive">
                                            <table class="table table-sm mb-0">
                                                <thead>
                                                    <tr>
                                                        <th>Id</th>
                                                        <th>Day</th>
                                                        <th>Level</th>
                                                        <th>Start</th>
                                                        <th>End</th>
                                                        <th>Instructor</th>
                                                    </tr>
                                                </thead>
                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="checkClassTimeslot.data.classTSAvailability" id="tableRepeat1">
                                                    <tr>
                                                        <td dmx-text="id"></td>
                                                        <td dmx-text="dayName"></td>
                                                        <td dmx-text="levelName"></td>
                                                        <td dmx-text="startTimeDisplay"></td>
                                                        <td dmx-text="endTimeDisplay"></td>
                                                        <td dmx-text="instructorName"></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <button id="btn3" class="btn btn-outline-light" dmx-on:click="run([{run:{action:`editClassModal.ecm_timeslotError.hide()`}},{wait:{delay:300}},{run:{action:`checkClassTimeslot.reset()`}}])"><i class="fas fa-undo-alt  fa-fw me-1"></i>Change</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </dmx-data-detail>



            </div>
            <div class="modal-footer border-top d-flex justify-content-between">
                <dmx-value id="var_editclass_dirtyform" dmx-bind:value="browser1"></dmx-value>
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                <button class="btn text-light btn-primary" dmx-on:click="run([{run:{action:`checkClassTimeslot.load({instructor: var_classDetails.value.instructorid, day: var_classDetails.value.day_int, starttimedecimal: var_classDetails.value.startTimeDecimal, endtimedecimal: var_classDetails.value.endTimeDecimal, classid: var_classDetails.value.id, isactive: var_classDetails.value.isactive})`}},{condition:{if:`checkClassTimeslot.data.classTSAvailability.length > 0`,else:{steps:{run:{action:`editClassModal.dd_editClass.editClassForm.submit()`}}}}}])" dmx-bind:disabled="pd_dirtyFormCheck.editClassForm.dirty === false">Edit
                    Class</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="classTransferSearchModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" style="z-index: 99999;">
    <div class="modal-dialog modal-dialog-scrollable modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header text-light bg-primary ">
                <h5 class="modal-title">Enrolment Transfer Search:</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="tsm_searchClassForm">
                    <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                        <div class="col">
                            <div class="mb-3">
                                <label for="cb_tr_addTransferReason" class="col-form-label form-label">Day</label>
                                <select id="tr_selDay" class="form-select" dmx-bind:options="classesBase.data.days.days" optiontext="name" optionvalue="id" name="day">
                                    <option value="">Select Day</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="inp_updcharge_duedate" class="col-form-label form-label">Time</label>
                                <select id="tr_selTime" class="form-select" dmx-bind:options="appSettings.ct_array" optiontext="display" optionvalue="decimal" name="startdecimal">
                                    <option selected="" value="">Select Time</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="input3" class="col-form-label form-label">Level</label>
                                <select id="tr_selLevel" class="form-select" dmx-bind:options="getLevels.data.query" optiontext="name" optionvalue="id" name="classlevel">
                                    <option value="">Select Level</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="input4" class="col-form-label form-label">Instructor</label>
                                <select id="tr_selInstructor" class="form-select" dmx-bind:options="getAllStaff.data.instructors.getInstructors" optiontext="firstName+' '+lastName.trunc(1, true, '.')" optionvalue="id" name="instructor">
                                    <option value="">Select Instructor</option>
                                </select>
                            </div>

                        </div>
                    </div>
                    <div class="row justify-content-end no-gutters"><button id="tr_searchButton" class="btn btn-light" dmx-on:click="searchClasses.load({instructor: tr_selInstructor.value, startdecimal: tr_selTime.value, day: tr_selDay.value, classlevel: tr_selLevel.value})"><i class="fas fa-search me-1"></i>Search</button></div>

                </form>
                <hr>
                <div class="row">
                    <div class="col">
                        <header>
                            <h5 class="fw-light mb-0">Search Results:</h5>
                            <small class="text-muted">Only the top 10 results are shown. If the class you're searching for isn't shown, please narrow down the search even further.</small>
                        </header>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr class="fw-bold small">
                                        <th class="border-0">Day</th>
                                        <th class="border-0">Class Time</th>
                                        <th class="border-0">Class Level</th>
                                        <th class="border-0">Instructor</th>
                                        <th scope="row" class="border-0">Availability</th>
                                        <th scope="row" class="border-0"></th>
                                    </tr>
                                </thead>
                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="searchClasses.data.classesSearch" id="tableRepeat3">
                                    <tr>
                                        <td dmx-text="day" class="align-middle"></td>
                                        <td dmx-text="startTimeDisplay.replace(' AM', '').replace(' PM', '') +' - '+endTimeDisplay" class="align-middle"></td>
                                        <td dmx-text="classLevel" class="align-middle"></td>
                                        <td dmx-text="instructorFirst +' '+instructorLast.trunc(1, true, '.')" class="align-middle"></td>
                                        <td class="align-middle" dmx-text="availability"></td>
                                        <td class="text-end align-middle"><button id="transferButton" class="btn btn-light btn-sm" wappler-command="editContent" dmx-hide="availability == 'FULL' || availability == 'OVERBOOKED'" dmx-on:click="transferEnrolmentModal.transferEnrolmentForm.var_transferToClass.setValue({'id': classid, 'day': day, 'level': classLevel, 'instructor': instructorFirst + ' ' + instructorLast.trunc(1, true, '.'), 'time': startTimeDisplay});classTransferSearchModal.hide()"><i class="fas fa-random me-1"></i>Transfer
                                            </button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="transferEnrolmentModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:hidden-bs-modal="getEnrolmentSingle.reset();transferEnrolmentForm.reset();classTransferSearchModal.tsm_searchClassForm.reset()" dmx-style:opacity="">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-header text-light bg-secondary">
                <h5 class="modal-title">Transfer Enrolment: {{getEnrolmentSingle.data.student.firstName+' '+getEnrolmentSingle.data.student.lastName}}<br></h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <form is="dmx-serverconnect-form" id="transferEnrolmentForm" method="post" action="/api/classes/transferEnrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-on:success="transferEnrolmentModal.hide();notifies1.success(getEnrolmentSingle.data.student.firstName+' '+getEnrolmentSingle.data.student.lastName+'\'s enrolment successfully transferred.');classesBase.load()" dmx-param:fromenrolmentid="{{getEnrolmentSingle.data.enrolment.id}}">

                    <div class="row" id="row_transferringFrom">
                        <div class="col">
                            <p class="text-muted rounded-small border p-2">
                                <strong>Transferring From:<br></strong>
                                {{getEnrolmentSingle.data.class.dayName+' '+getEnrolmentSingle.data.class.levelName+' - '+getEnrolmentSingle.data.class.startTimeDisplay+' - '+getEnrolmentSingle.data.class.instructorFirstName+' '+getEnrolmentSingle.data.class.instructorLastName.trunc(1, true, '.')}}
                            </p>

                        </div>
                        <div class="col-break w-100"></div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="inp_dropDate" class="col-form-label form-label">Drop date (current class)</label>
                                <input type="date" class="form-control" id="inp_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="Enter Drop date" dmx-bind:value="getEnrolmentSingle.data.enrolment.dropDate.formatDate('yyyy-MM-dd')" required="">
                            </div>
                        </div>
                        <div class="col-break w-100"></div>
                        <div class="col">
                            <div class="mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" value="" id="cb_tr_addTransferReason" name="input1">
                                    <label class="form-check-label" for="cb_tr_addTransferReason">Add transfer reason?</label>
                                </div>
                            </div>


                            <div class="collapse" id="transferReasonCollapse" is="dmx-bs5-collapse" dmx-bind:show="cb_tr_addTransferReason.checked">
                                <div class="mb-3">
                                    <label class="col-form-label form-label" for="cb_tr_futureDropDate">Transfer Reason:</label>
                                    <textarea id="inp_tr_dropReason" type="textarea" class="form-control border p-2 rounded-small" rows="4"></textarea>
                                    <input id="inp_hd_dropReason" name="dropReason" type="hidden" class="form-control" dmx-bind:value="inp_tr_dropReason.value == &quot;&quot; ? 'Transferred to: ' +getEnrolmentSingle.data.class.dayName+' '+getEnrolmentSingle.data.class.levelName+' - '+getEnrolmentSingle.data.class.startTimeDisplay+' - '+getEnrolmentSingle.data.class.instructorFirstName+' '+getEnrolmentSingle.data.class.instructorLastName.trunc(1, true, '.') : inp_tr_dropReason.value">
                                </div>
                            </div>

                        </div>
                        <hr>
                    </div>

                    <div class="row" id="row_transferringTo">

                        <div class="col">

                            <div class="row no-gutters">
                                <dmx-value id="var_transferToClass"></dmx-value>
                                <div class="col-break w-100"></div>

                            </div>
                            <hr>
                            <div class="row gx-3">
                                <div class="col mb-2">
                                    <p class="text-muted rounded-small border p-2 border-success" dmx-hide="var_transferToClass.value == null"><strong>Transferring To:<br></strong>
                                        {{var_transferToClass.value.day + ' ' + var_transferToClass.value.level + ' - ' + var_transferToClass.value.time + ' - ' + var_transferToClass.value.instructor }}</p>
                                    <p class="text-muted rounded-small border border-danger p-2" dmx-show="var_transferToClass.value == null"><strong>Transferring To:<br></strong><i class="fas fa-exclamation-triangle text-danger"></i>&nbsp;<span class="text-danger">Please select a class to transfer to.</span></p>
                                    <button id="btn_changeTransfer" class="btn btn-outline-primary btn-sm float-end" dmx-hide="var_transferToClass.value == null" dmx-on:click="classTransferSearchModal.show()"><i class="fas fa-sync me-1 fa-xs fa-fw"></i>Change</button>
                                    <button id="btn_addTransfer" class="btn btn-outline-primary btn-sm float-end" dmx-hide="var_transferToClass.value != null" dmx-on:click="classTransferSearchModal.show()"><i class="fas fa-plus  me-1 fa-fw fa-sm"></i>Add Class</button>
                                </div>
                                <div class="col-break w-100"></div>
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="inp_tr_startDate" class="col-form-label form-label">Start date</label>
                                        <input type="date" class="form-control" id="inp_tr_startDate" name="startDateTo" aria-describedby="inp_startDate_help" placeholder="Enter Start date" required="">
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-3">
                                <div class="col">
                                    <div class="mb-3 mt-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" value="" id="cb_tr_futureDropDate" name="input2">
                                            <label class="form-check-label" for="cb_tr_futureDropDate">Add future drop date?</label>
                                        </div>
                                    </div>
                                    <div class="collapse" id="futureDropdateCollapse" is="dmx-bs5-collapse" dmx-bind:show="cb_tr_addTransferReason.checked">
                                        <div class="mb-3">
                                            <label class="col-form-label form-label" for="cb_tr_futureDropDate">Future Drop Date:</label>
                                            <input id="inp_futureDropDate" name="dropDateTo" class="form-control" type="date">
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="row gx-3">
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="sel_tr_enrolmentType" class="col-form-label form-label">Enrolment Type:</label>
                                        <select id="sel_tr_enrolmentType" class="form-select" name="enrolmentTypeTo" dmx-bind:options="classesBase.data.enrolmentTypes" optiontext="type" optionvalue="id" dmx-bind:value="getEnrolmentSingle.data.enrolment.enrolmentType"></select>
                                    </div>
                                </div>
                            </div>
                            <small id="bs4-form-group-help6" class="form-text text-muted text-end">EnrolmentID: {{getEnrolmentSingle.data.enrolment.id}}</small>

                        </div>
                        <input id="inp_hd_toClassId" name="toClassId" type="hidden" class="form-control" dmx-bind:value="var_transferToClass.value.id">
                        <input id="inp_hd_studentId" name="student" type="hidden" class="form-control" dmx-bind:value="getEnrolmentSingle.data.student.id">
                    </div>
                </form>
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-secondary" dmx-on:click="transferEnrolmentModal.hide();notifies1.info('Enrolment transfer cancelled.')" data-bs-dismiss="modal">Cancel</button>
                <button class="btn btn-primary" form="editEnrolmentForm" dmx-on:click="transferEnrolmentForm.submit()">Transfer</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="editEnrolmentModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:hidden-bs-modal="editEnrolmentForm.reset();GET_ENROLMENT_single.reset()">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-header text-light bg-secondary">
                <h5 class="modal-title">Edit Enrolment: {{GET_ENROLMENT_single.data.student.firstName+' '+GET_ENROLMENT_single.data.student.lastName}}<br></h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <dmx-serverconnect id="GET_ENROLMENT_single" url="/api/classes/enrolments/GET_ENROLMENT_single" noload></dmx-serverconnect>
                <dmx-value id="var_editenrolment_enroldetail"></dmx-value>
                <div class="row">
                    <div class="col">
                        <p class="text-muted">
                            {{GET_ENROLMENT_single.data.class.dayName+' '+GET_ENROLMENT_single.data.class.levelName+' - '+GET_ENROLMENT_single.data.class.startTimeDisplay+' - '+GET_ENROLMENT_single.data.class.instructorFirstName+' '+GET_ENROLMENT_single.data.class.instructorLastName.trunc(1, true, '.')}}
                        </p>
                        <hr>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <form is="dmx-serverconnect-form" id="editEnrolmentForm" method="post" action="/api/classes/editEnrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-on:success="classesBase.load(true);editEnrolmentModal.hide();notifies1.success(getEnrolmentSingle.data.student.firstName+' '+getEnrolmentSingle.data.student.lastName+'\'s enrolment successfully edited.');classesBase.load()">
                            <input type="hidden" class="form-control" id="inp_id" name="id" aria-describedby="inp_id_help" placeholder="Enter Id" data-msg-required="" dmx-bind:value="getEnrolmentSingle.data.enrolment.id">
                            <div class="row gx-3">
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="sel_tr_enrolmentType" class="col-form-label form-label">Enrolment Type</label>
                                        <select id="sel_enrolmentType" class="form-select" name="enrolmentType-sel" dmx-bind:options="appSettings.enrolTypesArray" optiontext="type" dmx-bind:value="GET_ENROLMENT_single.data.enrolment.enrolmentType" disabled="true" optionvalue="id">
                                        </select>
                                        <small id="bs5-form-group-help1" class="form-text text-muted">To change enrolment type, please use the enrolment converter.</small>
                                        <input id="inp_enrolmentType" name="enrolmentType" type="hidden" class="form-control" dmx-bind:value="editEnrolmentModal.editEnrolmentForm.sel_enrolmentType.value">
                                    </div>
                                </div>
                            </div>
                            <fieldset dmx-bind:disabled="">

                                <div class="row gx-3">
                                    <div class="col">
                                        <div class="mb-3">
                                            <label for="inp_startDate" class="form-label col-form-label">Start date</label>
                                            <input type="text" class="form-control" id="inp_startDate" name="startDate" aria-describedby="inp_startDate_help" placeholder="dd/mm/yyyy" dmx-bind:value="GET_ENROLMENT_single.data.enrolment.startDate.formatDate('yyyy-MM-dd')" is="dmx-date-picker" format="DD/MM/YYYY">
                                        </div>
                                    </div>
                                </div>
                                <div class="row gx-3">
                                    <div class="col">
                                        <div class="mb-3">
                                            <label for="inp_dropDate" class="form-label col-form-label">Drop date</label>
                                            <input type="text" class="form-control" id="inp_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="dd/mm/yyyy" dmx-bind:value="GET_ENROLMENT_single.data.enrolment.dropDate.formatDate('yyyy-MM-dd')" is="dmx-date-picker" format="DD/MM/YYYY">
                                        </div>
                                        <div class="collapse" id="editEnrolmentDropReasonCollapse" is="dmx-bs5-collapse" dmx-bind:show="getEnrolmentSingle.data.enrolment.dropDate">
                                            <p><strong>Drop Reason:</strong><br>{{getEnrolmentSingle.data.enrolment.dropReason}}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row py-3 my-2 border-top border-bottom">
                                    <div class="col">

                                        <button id="btn1" class="btn btn-outline-danger">Delete Enrolment</button>
                                    </div>
                                </div>
                                <p class="text-muted small mb-0">EnrolmentID: {{GET_ENROLMENT_single.data.enrolment.uuid}}</p>
                            </fieldset>
                        </form>

                    </div>
                </div>
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary" form="editEnrolmentForm">Save Enrolment</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="dropEnrolmentModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger text-light">
                <h5 class="modal-title">Drop Enrolment: {{getEnrolmentSingle.data.student.firstName+' '+getEnrolmentSingle.data.student.lastName}}</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <p>{{getEnrolmentSingle.data.class.dayName+' '+getEnrolmentSingle.data.class.levelName+' - '+getEnrolmentSingle.data.class.startTimeDisplay+' - '+getEnrolmentSingle.data.class.instructorFirstName+' '+getEnrolmentSingle.data.class.instructorLastName.trunc(1, true, '.')}}
                </p>
                <hr>
                <form id="dropEnrolmentForm" is="dmx-serverconnect-form" method="post" action="/api/classes/getEnrolmentSingle" dmx-on:success="notifies1.success('Enrolment successfully dropped: '+getEnrolmentSingle.data.student.firstName+' '+getEnrolmentSingle.data.student.lastName+' - '+getEnrolmentSingle.data.class.dayName+' '+getEnrolmentSingle.data.class.levelName+' - '+getEnrolmentSingle.data.class.startTimeDisplay+' with '+getEnrolmentSingle.data.class.instructorFirstName+' '+getEnrolmentSingle.data.class.instructorLastName.trunc(1, '.', true));dropEnrolmentModal.hide();getEnrolmentSingle.reset()">

                    <div class="mb-3">
                        <label for="classType" class="col-form-label form-label">Drop Date:</label>
                        <input id="inp_dropDate_dropmodal" class="form-control clickable" name="dropDate" is="dmx-date-picker" required="" opens="center">
                        <small id="bs4-form-group-help3" class="form-text text-muted">Please select the last day of enrolment.<br> This date is inclusive and the enrolment will be inactive from the day after the drop date.</small>

                    </div>
                    <div class="mb-3">
                        <label for="ta_dropReason" class="col-form-label form-label">Drop Reason:&nbsp;</label>
                        <textarea id="ta_dropReason" class="form-control border rounded-small p-3" rows="6" name="dropReason"></textarea>
                    </div>
                    <small id="bs4-form-group-help4" class="form-text text-muted text-end">EnrolmentID: {{getEnrolmentSingle.data.enrolment.id}}</small>

                </form>

            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button for="dropEnrolmentForm" type="submit" class="btn btn-primary">Drop Enrolment</button>
            </div>
        </div>
    </div>
</div>
<meta name="ac:route" content="/classes">

<main class="d-flex flex-grow-1 p-4">

    <div class="row flex-grow-1 g-0">

        <div class="col">
            <div class="row align-items-center">
                <div class="col d-flex justify-content-start flex-row align-items-center">
                    <h2 class="mb-0 me-3 fw-bold">Classes</h2>
                    <a href="/classes/calview" class="btn btn-outline-secondary btn-sm bg-white" internal>Calendar View</a>
                    <div class="spinner-grow ms-3 text-primary spinner-grow-sm" role="status" id="loading_spinner" dmx-show="content.classesBase.state.executing">
                    </div>
                </div>


            </div>
            <%- await include('/partials/classes/_weekrange', Object.assign({}, locals)) %>
                <%- await include('/partials/classes/_classfilters', Object.assign({}, locals)) %>
                    <div class="row g-0">
                        <div class="col p-3 bg-white border rounded-3">
                            <div id="rp_tabs" class="row row-cols-1 g-0" is="dmx-repeat" dmx-bind:repeat="classesBase.data.nextavail.classes" dmx-class:loading-block="content.classesBase.state.executing">
                                <div class="col class-card border rounded-3 bg-white postition-relative mb-2 py-2 px-3" dmx-style:border-left-color.important="'#'+appSettings.classLevelsByID[classlevel_uuid].colour">
                                    <div class="row row-cols-8 clickable g-0" dmx-on:click="enrolmentsCollapse.toggle()">

                                        <div class="align-self-center col class-info d-flex flex-column justify-content-start align-items-start">
                                            <p class="mb-0 small fw-bold" dmx-html="appSettings.classLevelsByID[classlevel_uuid].name"><strong>Duckling </strong></p>
                                            <p class="mb-0 small" dmx-text="appSettings.days_array[day]">Monday</p>
                                            <p class="mb-1 pb-1 border-bottom small" dmx-html="startTimeDisplay.replace(' AM', '').replace(' PM', '')+' - '+endTimeDisplay" style="white-space: nowrap;">9:00 - 9:30am</p>
                                            <p class="mb-0 small" dmx-text="details.weekday.formatDate('dd MMM yyyy')">Week Date</p>
                                        </div>
                                        <div class="align-self-center col">
                                            <p class="mb-0 small text-start" dmx-text="instructorid === null ? '&lt;&lt;NO INSTRUCTOR FOUND&gt;&gt;' : appSettings.instructorsById[instructorid].trunc_name">Instructor</p>
                                        </div>

                                        <div class="col align-self-center">
                                            <div class="row row-cols-2 w-100 gx-2 gy-3" dmx-hide="details.total === 0" style="white-space: nowrap;">
                                                <div class="col align-self-center d-flex justify-content-start align-items-center" dmx-hide="details.enrolments.active_enrols.length === 0">
                                                    <i class="fas fa-check-circle me-2 text-active-light fa-fw"></i>
                                                    <p class="mb-0 small" dmx-text="details.enrolments.active_enrols.length+' Act.'">0 Act.</p>
                                                </div>
                                                <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_enrolCountMakeup" dmx-hide="!details.enrolments.makeup_enrols">
                                                    <i class="fas fa-arrow-alt-circle-up me-2 text-makeup fa-fw"></i>
                                                    <p class="mb-0 small" dmx-html="details.enrolments.makeup_enrols.length+' M/Up'">0 M/Ups</p>
                                                </div>
                                                <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_enrolCountTrial" dmx-hide="!details.enrolments.trial_enrols">
                                                    <i class="fas fa-question-circle me-2 text-trial-light fa-fw"></i>
                                                    <p class="mb-0 small" dmx-html="details.enrolments.trial_enrols.length+' Trial'">0 Trials</p>
                                                </div>
                                                <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_waitlistCount" dmx-hide="!waitlists">
                                                    <i class="fas fa-history me-2 text-waitlist fa-fw"></i>

                                                    <p class="mb-0 small" dmx-html="waitlists.length+' Wait'">0 Wait</p>
                                                </div>
                                                <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_casualCount" dmx-hide="!details.enrolments.casual_enrols">
                                                    <i class="fas fa-bookmark me-2 text-casual fa-fw"></i>
                                                    <p class="mb-0 small" dmx-html="details.enrolments.casual_enrols.length+' Cas.'">0 Cas.</p>
                                                </div>
                                            </div>
                                            <div class="row" dmx-show="details.total === 0">
                                                <div class="col">
                                                    <p class="fw-bold mb-0 text-danger"><i class="bi-slash-square me-2 text-danger"></i>Empty</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col align-self-center d-flex flex-column justify-content-center align-items-end">
                                            <p class="text-center mb-1 small text-muted">Makeup/Casual
                                                <i onclick="return false;" class="fas fa-question-circle-fill ms-1" dmx-bs-popover="'<p>Makeup/casual availabilities are automatically calculated by Puddle. The calculations are based off your Makeup Book Ahead settings.</p><p>Your current settings are set to allow Makeup/Casual enrolments to be booked <strong>'+appSettings.enrol_makeup_book_ahead_days+' days ahead.</strong></p><p class=&quot;mb-0&quot;>Casual enrolment availabilities are calculated the same as Makeup enrolments due to the temporary nature of both enrolment types.</p>'" dmx-bind:popover-title="'Makeup/Casual Availabilities'" data-bs-html="true" data-bs-trigger="hover"></i>
                                            </p>
                                            <p class="small text-center mb-0" dmx-repeat:rp_makeupavail_disp="details.makeup" dmx-hide="details.makeup_response.code !== 100" dmx-html="'<strong>'+availabilities+'</strong> spots - '+date.formatDate('dd MMM')"><b>4</b> spots - 21 Nov</p>
                                            <p class="text-center mb-0 fst-italic small" dmx-show="details.makeup_response.code !== 100" dmx-text="details.makeup_response.response">Too far in future.</p>


                                        </div>

                                        <div class="col align-self-center">
                                            <p class="text-end mb-0 small text-muted">Availability</p>
                                            <p class="text-end mb-0" dmx-show="details.total != max" dmx-html="'<strong>'+(max - details.total)+'</strong> / '+max+' max.'">4/4</p>
                                            <p class="text-end mb-0 fw-bold text-danger" dmx-show="details.total == max">FULL</p>
                                            <p class="text-end mb-0 small" dmx-show="details.total == max" dmx-text="(details.active !== 0 &amp;&amp; details.active) ? 'Next Open: '+details.active.formatDate('dd MMM yyyy') : 'No availabilities.'">OPENING ON:&nbsp;</p>
                                            <p class="text-end mb-0 fw-bold text-danger" dmx-show="details.total > max">OVERBOOKED</p>
                                        </div>
                                    </div>
                                    <div class="border-top-0 border-bottom-0">
                                        <div class="collapse" id="enrolmentsCollapse" is="dmx-bs5-collapse" dmx-bind:id="enrolmentsCollapse_{{$index}}">
                                            <dmx-value id="var_classid" dmx-bind:value="uuid"></dmx-value>
                                            <div class="row g-0 d-flex flex-column pb-4  pt-2 mt-2 border-top">
                                                <div class="col">

                                                    <div class="row row-cols-2 gx-2 my-2 pb-3 border-bottom">
                                                        <div class="col-12">
                                                            <div class="row">
                                                                <div class="col-auto">

                                                                    <button id="btn_newEnrolment" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-active-outline btn-sm icon-hover-white" dmx-on:click="run({condition:{if:`waitlists !== null`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'Yes'},cancel:{label:'Cancel'}},title:'<h3 class=&quot;mb-0&quot;><i class=&quot;fas fa-history me-2 text-waitlist fa-fw&quot;></i>Waitlist active.</h3>',message:'There is a waitlist currently waiting to enrol into this class. <br><br> Are you sure you want to add an enrolment?',then:{steps:{condition:{if:`!details.active`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Are you sure you want to overbook this class?',title:'<h3 class=&quot;mb-0&quot;><i class=&quot;fas fa-exclamation-triangle me-2 text-danger&quot;></i>Overbook Warning</h3>',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'active\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'active\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}}}}},else:{steps:{condition:{if:`!details.active`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Are you sure you want to overbook this class?',title:'<h3 class=&quot;mb-0&quot;><i class=&quot;fas fa-exclamation-triangle me-2 text-danger&quot;></i>Overbook Warning</h3>',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'active\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'active\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}}}})"><i class="fas fa-check-circle me-2 text-active-light"></i>New Active</button>
                                                                    <button id="btn_trialEnrolment" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-trial-outline btn-sm icon-hover-white" dmx-on:click="run({condition:{if:`waitlists !== null`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'Yes'},cancel:{label:'Cancel'}},title:'<h3 class=&quot;mb-0&quot;><i class=&quot;fas fa-history me-2 text-waitlist fa-fw&quot;></i>Waitlist active.</h3>',message:'There is a waitlist currently waiting to enrol into this class. <br><br> Are you sure you want to add an enrolment?',then:{steps:{condition:{if:`!details.active`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Are you sure you want to overbook this class?',title:'<h3 class=&quot;mb-0&quot;><i class=&quot;fas fa-exclamation-triangle me-2 text-danger&quot;></i>Overbook Warning</h3>',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'trial\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'trial\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}}}}},else:{steps:{condition:{if:`!details.active`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Are you sure you want to overbook this class?',title:'<h3 class=&quot;mb-0&quot;><i class=&quot;fas fa-exclamation-triangle me-2 text-danger&quot;></i>Overbook Warning</h3>',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'trial\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'trial\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}}}})"><i class="fas fa-question-circle me-2 text-trial-light"></i>New Trial</button>
                                                                    <button id="btn_newMakeup" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-makeup-outline btn-sm" dmx-on:click="run({condition:{if:`details.makeup.length < 1`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no makeup availabilities for this class in the future. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'makeup\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'makeup\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}})" dmx-bind:disabled="details.makeup_response.code === 101 || details.makeup_response.code === 102"><i class="fas fa-arrow-alt-circle-up me-2"></i>New Makeup</button>
                                                                    <button id="btn_newCasual" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-casual-outline btn-sm" dmx-on:click="run({condition:{if:`details.makeup.length < 1`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for casual enrolments this class. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'casual\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'casual\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}})" dmx-bind:disabled="details.makeup_response.code === 101 || details.makeup_response.code === 102"><i class="fas fa-bookmark me-2"></i>New Casual</button>
                                                                    <button id="btn_newWaitlist" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-sm btn-waitlist-outline" dmx-on:click="enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue('waitlist');enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value);enrolmentSearchModal.show()">
                                                                        <i class="fas fa-history me-2"></i>New Waitlist
                                                                    </button>
                                                                    <div class="row" dmx-hide="details.makeup_response.code === 100">
                                                                        <div class="col mt-2 fw-500">
                                                                            <p class="fst-italic small text-muted mb-0" dmx-show="details.makeup_response.code === 101">New Makeup and New Casual enrolment buttons have been disabled to prevent overbooking.</p>
                                                                            <p class="fst-italic small text-muted mb-0" dmx-show="details.makeup_response.code === 102">New Makeup and New Casual enrolment buttons have been disabled because your dates are too far into the future.</p>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col">
                                                                    <div class="row g-0">
                                                                        <div class="col d-flex justify-content-end">
                                                                            <div class="dropdown">
                                                                                <button id="dd_modifyclass" class="btn btn-secondary dropdown-toggle btn-sm change-chevron" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Modify<i class="bi-chevron-down ms-2 small"></i></button>
                                                                                <div class="dropdown-menu" aria-labelledby="dd_modifyclass">
                                                                                    <a class="dropdown-item small border-bottom" href="#" dmx-on:click="run([{run:{action:`editClassModal.var_classDetails.setValue($value)`}},{wait:{delay:200}},{run:{action:`editClassModal.show()`}}])"><i class="fas fa-pen me-2"></i>Edit Class</a>
                                                                                    <a class="dropdown-item text-danger small" href="#"><i class="bi-slash-circle-fill me-2"></i>Cancel Class</a>
                                                                                </div>
                                                                            </div>



                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>




                                                    </div>
                                                    <div class="row row-cols-1 g-2 mt-3 align-items-stretch row-cols-lg-2">
                                                        <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.active_enrols.length > 0">
                                                            <div class="row g-0 w-100">
                                                                <div class="col">
                                                                    <div class="card">
                                                                        <div class="card-header text-white bg-active">
                                                                            <h6 class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-5 fas fa-check-circle me-2 text-white fa-fw"></i>Active Enrolments
                                                                            </h6>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <div class="table-responsive">
                                                                                <table class="table mb-0 table-small table-sm small">
                                                                                    <thead class="border-bottom">
                                                                                        <tr class="border-0 small fw-bold">
                                                                                            <th scope="row" class="border-0 tc_td_min"></th>
                                                                                            <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                            <th class="border-0" style="width: 15%;">Start date</th>
                                                                                            <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.active_enrols" id="activeEnrolmentsTableRepeat1">
                                                                                        <tr>
                                                                                            <td style="width: 1%; white-space: nowrap; padding-right: 1rem;" class="tc_td_min align-middle">
                                                                                                <div class="dropdown no-caret">
                                                                                                    <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown2" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown">
                                                                                                        <i class="fas fa-ellipsis-v text-muted"></i>
                                                                                                    </button>
                                                                                                    <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="editEnrolmentModal.editEnrolmentForm.hdn_inp_isValid.setValue(isValid);editEnrolmentModal.GET_ENROLMENT_single.load({uuid: uuid});editEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-pencil"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Edit Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-arrow-down-circle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Drop Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-shuffle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    Transfer Enrolment
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-people"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </td>
                                                                                            <td class="align-middle" dmx-text="firstName +' '+lastName" style="padding-left: 20px !important;"></td>
                                                                                            <td dmx-text="startDate.formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                            <td dmx-text="dropDate.formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col border rounded-3 p-3 visually-hidden">

                                                                    <header class="pt-2 pb-2 mb-2 border-bottom">

                                                                        <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-check-circle me-2 text-active-light fa-fw"></i>Active Enrolments
                                                                        </h6>
                                                                    </header>


                                                                    <div class="table-responsive">
                                                                        <table class="table mb-0 table-small table-sm small">
                                                                            <thead class="border-bottom">
                                                                                <tr class="border-0 small fw-bold">
                                                                                    <th scope="row" class="border-0 tc_td_min"></th>
                                                                                    <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                    <th class="border-0" style="width: 15%;">Start date</th>
                                                                                    <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.active_enrols" id="activeEnrolmentsTableRepeat">
                                                                                <tr>
                                                                                    <td style="width: 1%; white-space: nowrap; padding-right: 1rem;" class="tc_td_min align-middle">
                                                                                        <div class="dropdown no-caret">
                                                                                            <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown">
                                                                                                <i class="fas fa-ellipsis-v text-muted"></i>
                                                                                            </button>
                                                                                            <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="editEnrolmentModal.GET_ENROLMENT_single.load({uuid: uuid});editEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-pencil"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Edit Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-arrow-down-circle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Drop Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-shuffle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            Transfer Enrolment
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-people"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                            </div>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td class="align-middle" dmx-text="firstName +' '+lastName" style="padding-left: 20px !important;"></td>
                                                                                    <td dmx-text="startDate.formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                    <td dmx-text="dropDate.formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.trial_enrols.length > 0">
                                                            <div class="row g-0 w-100">
                                                                <div class="col">
                                                                    <div class="card">
                                                                        <div class="card-header bg-trial border-0">
                                                                            <h6 class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-5 fas fa-question-circle me-2 fa-fw text-white" style="color: #f90;"></i>Trial Enrolments
                                                                            </h6>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <div class="table-responsive small">
                                                                                <table class="table mb-0 table-small table-sm">
                                                                                    <thead class="border-bottom">
                                                                                        <tr class="border-0 small fw-bold">
                                                                                            <th scope="row" class="border-0  tc_td_min"></th>
                                                                                            <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                            <th class="border-0" style="width: 15%;">Start date</th>
                                                                                            <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.trial_enrols" id="trialEnrolmentsTableRepeat">
                                                                                        <tr>
                                                                                            <td class="tc_td_min">
                                                                                                <div class="dropdown no-caret">
                                                                                                    <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                    <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                        <a class="dropdown-item border-bottom bg-primary text-white" href="#">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-stars"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    Upgrade to Active
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>

                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-pencil"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Edit Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>

                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-arrow-down-circle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Drop Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-shuffle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    Transfer Enrolment
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-people"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <!-- <button id="btn_trEnr_details" dmx-bind:id="btn_trEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                            dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap"></i></button>
                                                                        <button id="btn_trEnr_drop" dmx-bind:id="btn_trEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down"></i></button>
                                                                        <button id="btn_trEnr_transfer" dmx-bind:id="btn_trEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random"></i></button> -->
                                                                                            </td>
                                                                                            <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                            <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                            <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col border rounded-3 p-3 visually-hidden">
                                                                    <header class="pt-2 pb-2 mb-2 border-bottom ">
                                                                        <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-question-circle me-2 fa-fw" style="color: #f90;"></i>Trial Enrolments
                                                                        </h6>

                                                                    </header>

                                                                    <div class="table-responsive small">
                                                                        <table class="table mb-0 table-small table-sm">
                                                                            <thead class="border-bottom">
                                                                                <tr class="border-0 small fw-bold">
                                                                                    <th scope="row" class="border-0  tc_td_min"></th>
                                                                                    <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                    <th class="border-0" style="width: 15%;">Start date</th>
                                                                                    <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.trial_enrols" id="trialEnrolmentsTableRepeat">
                                                                                <tr>
                                                                                    <td class="tc_td_min">
                                                                                        <div class="dropdown no-caret">
                                                                                            <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                            <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                <a class="dropdown-item border-bottom bg-primary text-white" href="#">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-stars"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            Upgrade to Active
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>

                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-pencil"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Edit Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-arrow-down-circle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Drop Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-shuffle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            Transfer Enrolment
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-people"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                            </div>
                                                                                        </div>
                                                                                        <!-- <button id="btn_trEnr_details" dmx-bind:id="btn_trEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap"></i></button>
                                                                    <button id="btn_trEnr_drop" dmx-bind:id="btn_trEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down"></i></button>
                                                                    <button id="btn_trEnr_transfer" dmx-bind:id="btn_trEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random"></i></button> -->
                                                                                    </td>
                                                                                    <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                    <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                    <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>


                                                                </div>

                                                            </div>
                                                        </div>
                                                        <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.makeup_enrols.length > 0">
                                                            <div class="row g-0 w-100">
                                                                <div class="col">
                                                                    <div class="card">
                                                                        <div class="card-header bg-makeup">
                                                                            <h6 class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-5 fas fa-arrow-alt-circle-up me-2 fa-fw text-white" style="color: #319bfa;"></i>Makeup Enrolments
                                                                            </h6>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <div class="table-responsive small">
                                                                                <table class="table mb-0 table-small">
                                                                                    <thead class="border-bottom">
                                                                                        <tr class="border-0 small fw-bold">
                                                                                            <th scope="row" class="border-0 fw-light  tc_td_min"></th>
                                                                                            <th class="border-0" style="padding-left: 20px !important; width: 25%;">Student</th>
                                                                                            <th class="border-0" style="width: 15%;">Start date</th>
                                                                                            <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.makeup_enrols" id="makeupEnrolmentsTableRepeat1">
                                                                                        <tr>
                                                                                            <td class=" tc_td_min align-middle">
                                                                                                <div class="dropdown no-caret">
                                                                                                    <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown3" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                    <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-pencil"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Edit Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-arrow-down-circle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Drop Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-shuffle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    Transfer Enrolment
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-people"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <!-- <button id="btn_muEnr_details" dmx-bind:id="btn_muEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_muEnr_drop" dmx-bind:id="btn_muEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_muEnr_transfer" dmx-bind:id="btn_muEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                            </td>
                                                                                            <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                            <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                            <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col p-3 border rounded-3 visually-hidden">
                                                                    <header class="pt-2 pb-2 mb-2 border-bottom">
                                                                        <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-arrow-alt-circle-up me-2 fa-fw" style="color: #319bfa;"></i>Makeup Enrolments
                                                                        </h6>

                                                                    </header>

                                                                    <div class="table-responsive small">
                                                                        <table class="table mb-0 table-small">
                                                                            <thead class="border-bottom">
                                                                                <tr class="border-0 small fw-bold">
                                                                                    <th scope="row" class="border-0 fw-light  tc_td_min"></th>
                                                                                    <th class="border-0" style="padding-left: 20px !important; width: 25%;">Student</th>
                                                                                    <th class="border-0" style="width: 15%;">Start date</th>
                                                                                    <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.makeup_enrols" id="makeupEnrolmentsTableRepeat">
                                                                                <tr>
                                                                                    <td class=" tc_td_min align-middle">
                                                                                        <div class="dropdown no-caret">
                                                                                            <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                            <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-pencil"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Edit Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-arrow-down-circle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Drop Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-shuffle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            Transfer Enrolment
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-people"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                            </div>
                                                                                        </div>
                                                                                        <!-- <button id="btn_muEnr_details" dmx-bind:id="btn_muEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_muEnr_drop" dmx-bind:id="btn_muEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_muEnr_transfer" dmx-bind:id="btn_muEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                    </td>
                                                                                    <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                    <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                    <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>


                                                                </div>


                                                            </div>

                                                        </div>
                                                        <div class="col d-flex align-items-stretch" dmx-show="waitlists">
                                                            <div class="row g-0 w-100">
                                                                <div class="col">
                                                                    <div class="card">
                                                                        <div class="card-header bg-waitlist">
                                                                            <h6 class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-5 fas fa-history me-2 fa-fw text-white" style="color: #000;"></i>Waitlisted
                                                                            </h6>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <div class="table-responsive small">
                                                                                <table class="table mb-0 table-small">
                                                                                    <thead class="border-bottom">
                                                                                        <tr class="small fw-bold">
                                                                                            <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                            <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                            <th class="border-0" style="width: 15%;">Request Date</th>
                                                                                            <th class="border-0" style="width: 15%;">Notes</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="waitlists" id="waitlistedTableRepeat">
                                                                                        <tr>
                                                                                            <td class=" tc_td_min align-middle">
                                                                                                <div class="dropdown no-caret">
                                                                                                    <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                    <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                        <a class="dropdown-item border-bottom bg-primary text-white" href="#" dmx-on:click="run({condition:{if:`details.active == 0`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate(\'yyyy-MM-dd\')`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]},name:'Overbooking'}}},else:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate('yyyy-MM-dd'))`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]}}})">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-stars"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    Upgrade to Active
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a><a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-pencil"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Edit Waitlist</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="#" dmx-on:click="run({'bootbox.confirm':{buttons:{confirm:{label:'Delete Waitlist',className:'btn-danger'},cancel:{}},message:`\'Are you sure you want to delete \'+firstName +\' \'+lastName+\'\\\'s waitlist entry? Deleted waitlists are unrecoverable.\'`,title:'Are you sure?',then:{steps:{run:{action:`form_deleteWaitlist.submit()`}}}}})">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-slash-circle-fill text-danger"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">

                                                                                                                    <p class="mb-0">Cancel Waitlist</p>
                                                                                                                    <form id="form_deleteWaitlist" is="dmx-serverconnect-form" action="/api/classes/waitlist/deleteWaitlist" method="post" dmx-on:success="run([{run:{action:`notifies1.success(\'Waitlist deleted.\')`}},{wait:{delay:500}},{run:{action:`classesBase.load()`}}])">
                                                                                                                        <input id="inp_delWait_id" name="id" type="hidden" class="form-control" dmx-bind:value="id">
                                                                                                                    </form>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-people"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                                                                                            dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                                                                                        <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                                                                                        <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                            </td>
                                                                                            <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                            <td dmx-text="request_date.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                            <td dmx-text="notes" class=" align-middle"></td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col p-3 border rounded-3 visually-hidden">
                                                                    <header class="pt-2 pb-2 mb-2 border-bottom">
                                                                        <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-history me-2 fa-fw" style="color: #000;"></i>Waitlisted
                                                                        </h6>


                                                                    </header>


                                                                    <div class="table-responsive small">
                                                                        <table class="table mb-0 table-small">
                                                                            <thead class="border-bottom">
                                                                                <tr class="small fw-bold">
                                                                                    <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                    <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                    <th class="border-0" style="width: 15%;">Request Date</th>
                                                                                    <th class="border-0" style="width: 15%;">Notes</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="waitlists" id="waitlistedTableRepeat">
                                                                                <tr>
                                                                                    <td class=" tc_td_min align-middle">
                                                                                        <div class="dropdown no-caret">
                                                                                            <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                            <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                <a class="dropdown-item border-bottom bg-primary text-white" href="#" dmx-on:click="run({condition:{if:`details.active == 0`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate(\'yyyy-MM-dd\')`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]},name:'Overbooking'}}},else:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate('yyyy-MM-dd'))`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]}}})">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-stars"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            Upgrade to Active
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a><a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-pencil"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Edit Waitlist</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="#" dmx-on:click="run({'bootbox.confirm':{buttons:{confirm:{label:'Delete Waitlist',className:'btn-danger'},cancel:{}},message:`\'Are you sure you want to delete \'+firstName +\' \'+lastName+\'\\\'s waitlist entry? Deleted waitlists are unrecoverable.\'`,title:'Are you sure?',then:{steps:{run:{action:`form_deleteWaitlist.submit()`}}}}})">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-slash-circle-fill text-danger"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">

                                                                                                            <p class="mb-0">Cancel Waitlist</p>
                                                                                                            <form id="form_deleteWaitlist" is="dmx-serverconnect-form" action="/api/classes/waitlist/deleteWaitlist" method="post" dmx-on:success="run([{run:{action:`notifies1.success(\'Waitlist deleted.\')`}},{wait:{delay:500}},{run:{action:`classesBase.load()`}}])">
                                                                                                                <input id="inp_delWait_id" name="id" type="hidden" class="form-control" dmx-bind:value="id">
                                                                                                            </form>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-people"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                            </div>
                                                                                        </div>
                                                                                        <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                    </td>
                                                                                    <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                    <td dmx-text="request_date.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                    <td dmx-text="notes" class=" align-middle"></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                        <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.casual_enrols.length > 0">
                                                            <div class="row g-0 w-100">
                                                                <div class="col">
                                                                    <div class="card">
                                                                        <div class="card-header bg-casual">
                                                                            <h6 class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-5 fas fa-bookmark me-2 text-white fa-fw" style="color: #000;"></i>Casual</h6>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <div class="table-responsive small">
                                                                                <table class="table mb-0 table-small">
                                                                                    <thead class="border-bottom">
                                                                                        <tr class="small fw-bold">
                                                                                            <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                            <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                            <th class="border-0" style="width: 15%;">Start date</th>
                                                                                            <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.casual_enrols" id="casualTableRepeat">
                                                                                        <tr>
                                                                                            <td class=" tc_td_min align-middle">
                                                                                                <div class="dropdown no-caret">
                                                                                                    <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown1" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                    <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-pencil"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Edit Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-arrow-down-circle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Drop Enrolment</p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-shuffle"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    Transfer Enrolment
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                        <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                            <div class="row flex-nowrap">
                                                                                                                <div class="col-1">
                                                                                                                    <i class="bi-people"></i>
                                                                                                                </div>
                                                                                                                <div class="col-auto">
                                                                                                                    <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </a>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                            </td>
                                                                                            <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                            <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                            <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col p-3 border rounded-3 visually-hidden">
                                                                    <header class="pt-2 pb-2 mb-2 border-bottom">

                                                                        <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-bookmark me-2 text-primary fa-fw" style="color: #000;"></i>Casual</h6>
                                                                    </header>


                                                                    <div class="table-responsive small">
                                                                        <table class="table mb-0 table-small">
                                                                            <thead class="border-bottom">
                                                                                <tr class="small fw-bold">
                                                                                    <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                    <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                    <th class="border-0" style="width: 15%;">Start date</th>
                                                                                    <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.casual_enrols" id="casualTableRepeat">
                                                                                <tr>
                                                                                    <td class=" tc_td_min align-middle">
                                                                                        <div class="dropdown no-caret">
                                                                                            <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown1" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                            <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-pencil"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Edit Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-arrow-down-circle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Drop Enrolment</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-shuffle"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            Transfer Enrolment
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                                <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                    <div class="row flex-nowrap">
                                                                                                        <div class="col-1">
                                                                                                            <i class="bi-people"></i>
                                                                                                        </div>
                                                                                                        <div class="col-auto">
                                                                                                            <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </a>
                                                                                            </div>
                                                                                        </div>
                                                                                        <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="getEnrolmentSingle.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                    </td>
                                                                                    <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                    <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                    <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row row-cols-1 gy-2" dmx-show="details.total == 0 &amp;&amp; !waitlists">
                                                        <div class="col py-5">
                                                            <h5 class="text-center fw-300 m-0 text-body">
                                                                This class has no enrolments or waitlists.</h5>
                                                            <p class="text-center mb-0">Add an enrolment above.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col d-flex flex-row justify-content-start">
                                    <ul class="pagination" dmx-populate="classesBase.data" dmx-state="queryManager" dmx-offset="offset" dmx-generator="bs5paging">
                                        <li class="page-item" dmx-class:disabled="classesBase.data.page.current == 1" aria-label="First">
                                            <a href="javascript:void(0)" class="page-link" dmx-on:click="queryManager.set('offset',classesBase.data.page.offset.first)"><span aria-hidden="true">&lsaquo;&lsaquo;</span></a>
                                        </li>
                                        <li class="page-item" dmx-class:disabled="classesBase.data.page.current == 1" aria-label="Previous">
                                            <a href="javascript:void(0)" class="page-link" dmx-on:click="queryManager.set('offset',classesBase.data.page.offset.prev)"><span aria-hidden="true">&lsaquo;</span></a>
                                        </li>
                                        <li class="page-item" dmx-class:active="title == classesBase.data.page.current" dmx-class:disabled="!active" dmx-repeat="classesBase.data.getServerConnectPagination(2,1,'...')">
                                            <a href="javascript:void(0)" class="page-link" dmx-on:click="queryManager.set('offset',(page-1)*classesBase.data.limit)">{{title}}</a>
                                        </li>
                                        <li class="page-item" dmx-class:disabled="classesBase.data.page.current ==  classesBase.data.page.total" aria-label="Next">
                                            <a href="javascript:void(0)" class="page-link" dmx-on:click="queryManager.set('offset',classesBase.data.page.offset.next)"><span aria-hidden="true">&rsaquo;</span></a>
                                        </li>
                                        <li class="page-item" dmx-class:disabled="classesBase.data.page.current ==  classesBase.data.page.total" aria-label="Last">
                                            <a href="javascript:void(0)" class="page-link" dmx-on:click="queryManager.set('offset',classesBase.data.page.offset.last)"><span aria-hidden="true">&rsaquo;&rsaquo;</span></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>


        </div>
    </div>

</main>