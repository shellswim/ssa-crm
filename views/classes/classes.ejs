<!-- Wappler include head-page="layouts/layout2" is="dmx-app" id="classes" appconnect="local" fontawesome_5="cdn" components="{dmxBootstrap4Modal:{},dmxValidator:{},dmxFormatter:{},dmxBootbox:{},dmxDataTraversal:{},dmxBootstrap4PagingGenerator:{},dmxBootstrap4Alert:{},dmxBootstrap4TableGenerator:{},dmxBootstrap4Collapse:{},dmxStateManagement:{},dmxPreloader:{},dmxDatePicker:{},dmxBootstrap5Navigation:{},dmxBootstrap5Collapse:{},dmxBootstrap5Modal:{},dmxBootstrap5PagingGenerator:{},dmxBootstrap5TableGenerator:{},dmxSockets:{},dmxBootstrap5Popovers:{},dmxBootstrap5Tooltips:{},dmxRouting:{},dmxAnimateCSS:{},dmxFormRepeat:{},dmxBootstrap5Offcanvas:{},dmxScheduler:{}}" jquery_35="cdn" moment_2="local with locales" bootstrap5="local" dmx-on:load="run([{setGlobal:{key:'contentTitle',value:'Classes'}},{run:{action:`classesQuery.set(\'limit\',20)`}},{run:{action:`classesQuery.set(\'offset\',0)`}}])" bootstrap_icons="cdn" -->

<%- await include('/partials/elements/_topbar', Object.assign({contentTitle: '<i class="fas fa-chalkboard-teacher fa-fw pe-2"></i> Classes' }, locals)) %>
<script is="dmx-flow" id="flow_pagetitle" type="text/dmx-flow" src="/app/flows/utilities/pagetitle.json" dmx-param:title="'Classes'" autorun></script>
<dmx-toggle id="toggle_classes_loading" checked="true"></dmx-toggle>
<meta name="ac:route" content="/classes">
<script is="dmx-flow" id="tuitioncharge_existsChargeAhead" type="text/dmx-flow">{
  meta: {
    $param: [ 
      {type: "date", name: "startdate"},
      {type: "object", name: "class"},
      {type: "number", name: "familyid"},
      {type: "date", name: "timenow"},
      {type: "object", name: "student"}, 
      {type: "number", name: "enroltype"}
    ]
  },
  exec: {
    steps: [
      {
        serverConnect: {
          url: "/api/families/ledger/tuition_checkCurrentPeriodExists",
          site: "SSA-CRM",
          params: {
            startdate: "{{$param.startdate}}",
            chargeahead: "{{appSettings.billing_cycle_charge_ahead}}",
            familyid: "{{$param.familyid}}",
            family_uuid: "{{$param.familyid}}"
          },
          name: "checkTuitionCharges",
          output: true
        }
      },
      {
        run: {
          action: "{{newEnrolmentModal.var_chargeObject.setValue(checkTuitionCharges.data.chargeDetails);newEnrolmentModal.var_ne_enrolType.setValue($_PARAM.enroltype);newEnrolmentModal.var_classDetailsObject.setValue($_PARAM.class);newEnrolmentModal.var_studentDetailsObject.setValue($_PARAM.student)}}"
        }
      }
    ]
  }
}</script>

<dmx-query-manager id="classesQuery"></dmx-query-manager>
<dmx-serverconnect id="checkClassTimeslot" noload url="/api/classes/checkClassTimeslot"></dmx-serverconnect>


<dmx-serverconnect id="classesBase" url="api/classes/classesBase" dmx-param:sort="classesQuery.data.sort" dmx-param:dir="classesQuery.data.dir" dmx-param:offset="query.offset||0" dmx-param:limit="query.limit||25" dmx-param:startdate="dr_startDate.value" dmx-param:enddate="dr_endDate.value" dmx-param:checkavail_max="appSettings.enrol_availability_max_weeks" dmx-param:makeup_max_book_days="appSettings.enrol_makeup_book_ahead_days" dmx-param:viewtype="'list'" dmx-param:filter_days="class_filter_store.data.filter_days || []" dmx-param:filter_times="class_filter_store.data.filter_times || []" dmx-param:filter_levels="class_filter_store.data.filter_levels || []" dmx-param:filter_instructors="class_filter_store.data.filter_instructors || []" dmx-param:avails_amount="class_filter_store.data.availabilities.amount" dmx-param:avails_type="class_filter_store.data.availabilities.type" dmx-on:success="var_classlist_count.setValue(classesBase.data.nextavail.classes.length)" dmx-param:weekdate="weekrange_todaydate_picker.value" dmx-param:startofweek="appSettings.weekstart" dmx-on:error="run({condition:{if:`classesBase.lastError.response.message.startsWith(\'Date Range Error\')`,then:{steps:[{runJS:{function:'swal_alert',args:['error','Date Range Error',`classesBase.lastError.response.message`]}},{run:{action:`weekrange_todaydate_picker.setValue(dateAndTime_days.datetime.formatDate(\'yyyy-MM-dd\'))`}}]}}})" dmx-on:start="toggle_classes_loading.check()" dmx-on:done="run([{wait:{delay:1000}},{run:{action:`toggle_classes_loading.uncheck()`}}])">
</dmx-serverconnect>


<dmx-serverconnect id="getInstructors" url="/api/staff/getInstructors"></dmx-serverconnect>


<dmx-serverconnect id="searchClasses" url="/api/classes/searchClasses" noload dmx-param:offset=""></dmx-serverconnect>
<dmx-serverconnect id="classHumanDetailsGlobal" url="/api/classes/getClassHumanDetails_SINGLE" noload=""></dmx-serverconnect>

<dmx-serverconnect id="getClassDetails" url="/api/classes/getClassDetails" noload></dmx-serverconnect>

<div class="modal fade" is="dmx-bs5-modal" tabindex="-1" role="dialog" id="newEnrolmentModal" nocloseonclick="true" dmx-on:hidden-bs-modal="run({run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue(null);newEnrolmentModal.var_classDetailsObject.setValue(null);newEnrolmentModal.sc_quote.reset()`}})">
    <dmx-serverconnect id="sc_quote" url="/api/classes/enrolments/GENERATE_QUOTE_enrolment" dmx-param:enrolmenttype="1" dmx-param:student_uuid="" dmx-param:startdate="" dmx-param:class_uuid="" dmx-param:family_uuid="" dmx-param:enabledummyenrol="" noload=""></dmx-serverconnect>
    <div class="offcanvas offcanvas-end" id="oc_quoteDetails" is="dmx-bs5-offcanvas" tabindex="-1" dmx-on:hidden-bs-offcanvas="run({run:{action:`newEnrolmentModal.oc_quoteDetails.sc_existingChargeDetails.reset();newEnrolmentModal.oc_quoteDetails.var_newChargeDetails.setValue(null)`}})" scroll="true" style="">
        <div class="offcanvas-header border-bottom">
            <h4 class="offcanvas-title fw-700"><i class="fas fa-hand-holding-usd me-2 text-primary"></i>Charge Details</h4>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body light-blue-bg overflow-scroll">
            <dmx-serverconnect id="sc_existingChargeDetails" noload url="/api/families/ledger/charges/GET_CHARGE_detail"></dmx-serverconnect>
            <dmx-value id="var_newChargeDetails"></dmx-value>
            <section id="oc_sec_newChargeDetails" class="p-3 bg-white mb-4 pdl-surface-shadow rounded-3">
                <h5 class="fw-700"><i class="fas fa-certificate me-2 fa-sm fa-fw"></i>New Charge Details
                </h5>

                <div class="row align-items-center my-2 py-2 border-top border-bottom">

                    <div class="col">
                        <p class="text-muted small">Charge Period</p>
                        <p class="mb-0" dmx-text="var_newChargeDetails.value.chargefor">April - 2022</p>
                    </div>
                    <div class="col">
                        <p class="text-muted small">Grand Total</p>

                        <p class="mb-0 fw-700" dmx-text="var_newChargeDetails.value.tuitiontotals.enrolgrandtotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$100.00</p>
                    </div>
                    <div class="col">
                        <p class="text-muted small">Total Discounts</p>

                        <p class="mb-0 text-ledger" dmx-text="((var_newChargeDetails.value.tuitiontotals.multienrol_discount + var_newChargeDetails.value.tuitiontotals.family_discount) + var_newChargeDetails.value.tuitiontotals.holding_fee).round(2).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$20.00</p>
                    </div>
                    <div class="col">
                        <p class="text-muted small">Base Rate</p>

                        <p class="mb-0 text-muted" dmx-text="var_newChargeDetails.value.tuitiontotals.baseRate.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$120.00</p>
                    </div>
                    <div class="col-auto align-self-center"><button id="btn_nc_details_show" class="btn btn-sm btn-link" dmx-on:click="collapse_chargeDetails.toggle()"><i class="fas fa-plus-circle me-1 fa-fw fa-sm"></i>Details
                        </button></div>
                </div>
                <div class="collapse" id="collapse_chargeDetails" is="dmx-bs5-collapse">
                    <div class="container p-0">
                        <div class="row row-cols-1 g-0" id="rp_chargestudents" is="dmx-repeat" dmx-bind:repeat="var_newChargeDetails.value.students">
                            <div class="col-12 pt-2 border-bottom">
                                <div class="row g-0 mb-2">
                                    <div class="col d-flex flex-row justify-content-start align-items-center">
                                        <h5 class="mb-0 fw-550 text-primary" dmx-text="firstName+' '+lastName"><i class="fas fa-child me-2 fa-sm"></i>Student Name</h5>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-bordered align-middle charge-details-table">
                                        <thead>
                                            <tr class="small fw-600">
                                                <th scope="col">Week Of</th>
                                                <th scope="col">Class Date</th>
                                                <th scope="col">Enrolment</th>
                                                <th scope="col">Base Rate</th>
                                                <th scope="col">Discounts</th>
                                                <th scope="col">Holding Fee</th>
                                                <th scope="col">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody is="dmx-repeat" id="rp_studentenrolments" dmx-bind:repeat="all_enrolments">
                                            <tr class="small user-select-none">
                                                <td dmx-text="startofweek.formatDate('dd MMM')">21 March</td>
                                                <td dmx-text="classdate.formatDate(appSettings.localization_puddle_dateformat)">21/03/2022</td>
                                                <td dmx-text="appSettings.days_array[classday]+' - '+startTimeDisplay+' '+appSettings.classLevelsByID[classlevel_uuid].name+' - '+appSettings.instructorsById[instructor_uuid].trunc_name">Wed Duckling 9:30AM - Melanie M.</td>
                                                <td dmx-text="pricing.baseRate.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$18.88</td>
                                                <td dmx-bs-popover="'<strong>Enrolment Discount:</strong> '+pricing.multienrol_discount.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)+(pricing.multienrol_discount > 0 ? '<br><strong>ED Description:</strong> ' + pricing.multienrol_discount_description : '')+'<br><strong>Family Discount:</strong> '+pricing.family_discount.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)+(pricing.family_discount> 0 ? '<br><strong>FD Description:</strong> ' + pricing.familydiscount_description : '')" dmx-bind:popover-title="'Discounts'" data-bs-html="true" data-bs-trigger="hover" data-bs-placement="left" dmx-text="((pricing.multienrol_discount+pricing.family_discount)===0)? '-' : (pricing.multienrol_discount + pricing.family_discount).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)" class="clickable popover-enabled">$3.50</td>
                                                <td dmx-text="(pricing.holding_fee===0)?'-':pricing.holding_fee.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$1.00</td>
                                                <td dmx-text="pricing.enrolgrandtotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$14.38</td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr class="fw-800">
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td>Totals:</td>
                                                <td dmx-text="tuitiontotals.multienrol_discount.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)"></td>
                                                <td dmx-text="tuitiontotals.holding_fee.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)"></td>
                                                <td dmx-text="tuitiontotals.enrolgrandtotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)"></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>

            </section>
            <section id="oc_sec_oldChargeDetails" class="p-3 bg-white pdl-surface-shadow rounded-3">
                <h5 class="fw-700"><i class="fas fa-money-bill-alt me-2 fa-sm"></i>Existing Charge Details</h5>
                <div class="row" is="dmx-if" id="cr_nc_existingCharge" dmx-bind:condition="sc_existingChargeDetails.data.family_charge.uuid">
                    <div class="col">
                        <div class="row align-items-center my-2 py-2 border-top border-bottom">
                            <div class="col">
                                <p class="text-muted small">Charge Period</p>
                                <p class="mb-0" dmx-text="sc_existingChargeDetails.data.family_charge.chargeFor_monthly.formatDate('MMMM - yyyy')">April - 2022</p>
                            </div>
                            <div class="col">
                                <p class="text-muted small">Grand Total</p>

                                <p class="mb-0 fw-700" dmx-text="sc_existingChargeDetails.data.family_charge.total.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$100.00</p>
                            </div>
                            <div class="col">
                                <p class="text-muted small">Total Discounts</p>

                                <p class="mb-0 text-ledger" dmx-text="sc_existingChargeDetails.data.family_charge.discounttotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$20.00</p>
                            </div>
                            <div class="col">
                                <p class="text-muted small">Base Rate</p>

                                <p class="mb-0 text-muted" dmx-text="sc_existingChargeDetails.data.family_charge.basetotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$120.00</p>
                            </div>
                            <div class="col-auto align-self-center"><button id="btn_nc_details_show1" class="btn btn-sm btn-link" dmx-on:click="collapse_existingChargeDetails.toggle()"><i class="fas fa-plus-circle me-1 fa-fw fa-sm"></i>Details
                                </button></div>
                        </div>
                    </div>

                </div>
                <div class="row align-items-center" is="dmx-if" id="cr_nc_noExistingCharge" dmx-bind:condition="!sc_existingChargeDetails.data.family_charge.uuid">

                    <div class="col my-2 py-3 border-top border-bottom">
                        <p class="mb-0 text-center">There is no existing charge for <i style="font-weight: bold;">{{var_newChargeDetails.value.chargefor}} </i>for this family.</p>
                    </div>
                </div>
                <div class="collapse" id="collapse_existingChargeDetails" is="dmx-bs5-collapse">
                    <div class="container p-0">
                        <div class="row row-cols-1 g-0" id="rp_existingchargestudents" is="dmx-repeat" dmx-bind:repeat="sc_existingChargeDetails.data.students">
                            <div class="col-12 pt-2 border-bottom">
                                <div class="row g-0 mb-2">
                                    <div class="col d-flex flex-row justify-content-start align-items-center">
                                        <h5 class="mb-0 fw-550 text-primary" dmx-text="firstName+' '+lastName"><i class="fas fa-child me-2 fa-sm"></i>Student Name</h5>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-bordered align-middle charge-details-table">
                                        <thead>
                                            <tr class="small fw-600">
                                                <th scope="col">Week Of</th>
                                                <th scope="col">Class Date</th>
                                                <th scope="col">Enrolment</th>
                                                <th scope="col">Base Rate</th>
                                                <th scope="col">Discounts</th>
                                                <th scope="col">Holding Fee</th>
                                                <th scope="col">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody is="dmx-repeat" id="rp_ec_studentenrolments" dmx-bind:repeat="query_enrolment_charges">
                                            <tr class="small user-select-none">
                                                <td dmx-text="startofweek.formatDate('dd MMM')">21 March</td>
                                                <td dmx-text="classDate.formatDate(appSettings.localization_puddle_dateformat)">21/03/2022</td>
                                                <td dmx-text="appSettings.days_array[classday]+' - '+startTimeDisplay+' '+appSettings.classLevelsByID[classlevel_uuid].name+' - '+appSettings.instructorsById[instructor_uuid].trunc_name">Wed Duckling 9:30AM - Melanie M.</td>
                                                <td dmx-text="baseRate.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$18.88</td>
                                                <td dmx-bs-popover="'<strong>Enrolment Discount:</strong> '+endisc.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)+((endisc > 0) ? '<br><strong>ED Description:</strong> ' + endiscdescription : '')+'<br><strong>Family Discount:</strong> '+familydiscounttotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)+((familydiscounttotal> 0) ? '<br><strong>FD Description:</strong> ' + familydiscountdesc : '')" dmx-bind:popover-title="'Discounts'" data-bs-html="true" data-bs-trigger="hover" data-bs-placement="left" dmx-text="((endisc+familydiscounttotal)===0)? '-' : (endisc + familydiscounttotal).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)" class="clickable popover-enabled">$3.50</td>
                                                <td dmx-text="(holding_fee===0)?'-':holding_fee.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$1.00</td>
                                                <td dmx-text="enrolgrandtotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$14.38</td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr class="fw-800">
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td>Totals:</td>
                                                <td dmx-text="(query_enrolment_charges.sum('endisc') + query_enrolment_charges.sum('familydiscounttotal')).round(2).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)"></td>
                                                <td dmx-text="query_enrolment_charges.sum('holding_fee').round(2).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)"></td>
                                                <td dmx-text="query_enrolment_charges.sum('enrolgrandtotal').round(2).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)"></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>

            </section>
        </div>
    </div>
    <dmx-value id="var_studentDetailsObject"></dmx-value>
    <dmx-value id="var_tuitionquote"></dmx-value>
    <dmx-value id="var_classDetailsObject"></dmx-value>
    <div class="modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-xl-down" role="document">
        <div class="modal-content">
            <dmx-value id="var_chargeObject"></dmx-value>
            <dmx-value id="var_ne_enrolType"></dmx-value>
            <dmx-value id="var_overbookingPotential"></dmx-value>

            <div class="modal-header">
                <h5 class="modal-title fw-500"><i class="fas fa-user-plus me-2 fa-fw fa-sm"></i>Create New Enrolment</h5>
                <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">&times;</span>
                </button>
            </div>
            <div class="modal-body border-top light-blue-bg">
                <form is="dmx-serverconnect-form" id="createEnrolmentForm" method="post" action="/api/classes/enrolments/CREATE_enrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-param:isvalid="1" dmx-param:chargeahead="appSettings.billing_charge_ahead" dmx-param:family_uuid="var_studentDetailsObject.value.family" dmx-on:success="run([{run:{action:`flow_swal_toast_colored.run({icon: \'success\', title: \'Enrolment Success\', message: var_studentDetailsObject.value.firstName+\' \'+var_studentDetailsObject.value.lastName+\' enrolled successfully to - \'+appSettings.days_array[var_classDetailsObject.value.classday]+\' - \'+var_classDetailsObject.value.startTimeDisplay+\' \'+appSettings.classLevelsByID[var_classDetailsObject.value.classlevel_uuid].name+\' - with \'+appSettings.instructorsById[var_classDetailsObject.value.instructor_uuid].trunc_name, timer: 5000, timerprogressbar: true})`}},{wait:{delay:300}},{run:{action:`classesBase.load({},true)`}},{run:{action:`createEnrolmentForm.reset()`}},{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`enrolmentSearchModal.inp_searchModal.setValue(null);queryManager.remove(\'searchtextfilter\')`}}])" dmx-on:error="run({condition:{if:`newEnrolmentModal.createEnrolmentForm.lastError.status == 901`,then:{steps:{run:{action:`newEnrolEnterDueDate.var_chargeDates.setValue(inp_ne_startDate.value);newEnrolEnterDueDate.show()`}}}}})">
                    <div class="row mb-3 align-items-stretch">
                        <div class="col-auto d-flex align-items-stretch">
                            <section class="p-3 bg-white rounded-3 pdl-surface-shadow d-flex">
                                <div class="row g-0">
                                    <div class="col align-self-center"><input type="hidden" class="form-control" id="inp_student" name="student_uuid" aria-describedby="inp_student_help" placeholder="Enter Student" dmx-bind:value="newEnrolmentModal.var_studentDetailsObject.value.uuid"><input type="hidden" class="form-control" id="inp_class_uuid" name="class_uuid" aria-describedby="inp_classId_help" placeholder="Enter Class" dmx-bind:value="newEnrolmentModal.var_classDetailsObject.value.uuid">
                                        <h5 class="fw-700 text-uppercase text-primary" dmx-html="'<i class=&quot;fas fa-child me-2 fa-sm fa-fw&quot;></i>'+var_studentDetailsObject.value.firstName+' '+var_studentDetailsObject.value.lastName"><i class="fas fa-child me-1 fa-sm fa-fw"></i>Jeffery Doe
                                        </h5>
                                        <p class="mb-0" dmx-html="appSettings.days_array[var_classDetailsObject.value.classday]+' - '+var_classDetailsObject.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_classDetailsObject.value.classlevel_uuid].name+' - '+appSettings.instructorsById[var_classDetailsObject.value.instructor_uuid].trunc_name">Monday - 9:30AM Duckling - Troy F.</p>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <div class="col-3 d-flex align-self-stretch flex-row align-items-stretch">
                            <section class="w-100 p-3 bg-white rounded-3 pdl-surface-shadow">
                                <div class="row g-0 align-items-center">
                                    <div class="col">
                                        <label for="inp_enrolmentType" class="col-form-label form-label">Enrolment type</label>
                                        <select id="sel_enrolmentType" class="form-select" name="enrolmentType-sel" dmx-bind:options="appSettings.enrolTypesArray" optiontext="type" optionvalue="id" dmx-bind:value="newEnrolmentModal.var_ne_enrolType.value" dmx-on:changed="run({condition:{if:`sel_enrolmentType.value == 5 || sel_enrolmentType.value == 2`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(inp_ne_startDate.value)`}}},else:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})" readonly="true" disabled="true"></select>
                                        <input id="inp_hd_enrolType" name="enrolmentType" type="hidden" class="form-control" dmx-bind:value="sel_enrolmentType.value">
                                    </div>


                                </div>
                            </section>
                        </div>
                        <div class="align-self-stretch col-auto d-flex align-items-stretch flex-row">
                            <section class="p-3 bg-white rounded-3 pdl-surface-shadow">
                                <div class="row g-0 align-items-center">
                                    <div class="col-auto">

                                        <label for="inp_ne_startDate" class="col-form-label form-label ps-0">Start date:</label>

                                        <input size="10" is="dmx-date-picker" dmx-bind:mindate="dateAndTime_days.datetime.addDays(dateAndTime_days.datetime.getDate() + ((((var_classDetailsObject.value.day_int - 1) + 7 - dateAndTime_days.datetime.getDay()) % 7) || 7) - dateAndTime_days.datetime.getDate()).addWeeks(-2).formatDate('yyyy-MM-dd')" class="form-control form-control-plaintext w-auto" id="inp_ne_startDate" name="startDate" aria-describedby="inp_ne_startDate_help" placeholder="dd/mm/yyyy" dmx-on:changed="run({condition:{if:`!inp_ne_dropDate.value &amp;&amp; -inp_ne_dropDate.value.formatDate(\'yyyy-MM-dd\').toTimestring() < inp_ne_startDate.value.formatDate(\'yyyy-MM-dd\').toTimesting()`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})" opens="left" format="DD/MM/YYYY" showdropdowns="true" onkeydown="return false" readonly="true">

                                    </div>
                                    <div class="col-auto">

                                        <label for="inp_dropDate" class="col-form-label form-label ps-0">Drop date:&nbsp;</label>
                                        <input class="form-control form-control-plaintext" id="inp_ne_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="dd/mm/yyyy" type="text" is="dmx-date-picker" showdropdowns="true" format="DD/MM/YYYY" readonly="true" size="10">

                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                    <div class="row" is="dmx-if" id="cr_newQuoteDetails" dmx-bind:condition="var_ne_enrolType.value===1">
                        <div class="col-12">
                            <section class="p-3 bg-white rounded-3 pdl-surface-shadow">
                                <h5>Charges for New Enrolment</h5>

                                <div class="row g-0">
                                    <div class="col">
                                        <div class="table-responsive">
                                            <table class="table table-bordered align-middle mb-0">
                                                <thead>
                                                    <tr>
                                                        <th scope="col"></th>
                                                        <th scope="col">
                                                            <p class="small mb-0 text-muted">Charge Period</p>
                                                        </th>
                                                        <th scope="col">
                                                            <p class="small mb-0 text-muted">Grand Total</p>
                                                        </th>
                                                        <th scope="col">
                                                            <p class="small mb-0 text-muted">Discounts<i class="fas fa-question-circle ms-2 clickable user-select-none fa-sm" dmx-bs-popover="'Includes enrolment, family and holding fee discounts.'" data-bs-trigger="hover" data-bs-placement="right" data-bs-html="true" dmx-bind:popover-title="'All Discounts'"></i></p>
                                                        </th>
                                                        <th scope="col">
                                                            <p class="small mb-0 text-muted">Base Rate<i class="fas fa-question-circle ms-2 clickable user-select-none fa-sm" dmx-bs-popover="'The base rate is the price of all enrolments before enrolment discounts and family discounts have been applied.'" data-bs-trigger="hover" data-bs-placement="right" data-bs-html="true" dmx-bind:popover-title="'Base Rate'"></i></p>
                                                        </th>
                                                        <th scope="col">
                                                            <p class="small mb-0 text-muted">* Charge Date:</p>
                                                        </th>
                                                        <th scope="col">
                                                            <p class="small mb-0 text-muted">* Due Date:</p>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr dmx-repeat:rp_ne_familycharges="sc_quote.data.exec_tuitioncalc.repeat" dmx-hide="newEnrolmentModal.sc_quote.state.executing">
                                                        <td class="collapse-cell"><button id="btn_showQuoteDetails" class="btn btn-primary btn-sm text-nowrap" dmx-on:click="run([{condition:{if:`calculate_charges.existingcharge.chargeexists===true`,then:{steps:{run:{action:`newEnrolmentModal.oc_quoteDetails.sc_existingChargeDetails.load({charge_uuid: calculate_charges.existingcharge.details.uuid})`}}}}},{run:{action:`newEnrolmentModal.oc_quoteDetails.var_newChargeDetails.setValue(calculate_charges)`}},{run:{action:`newEnrolmentModal.oc_quoteDetails.show()`}}])" style="width: 95px !important;"><i class="fas fa-plus-circle fa-sm fa-fw me-1"></i>Details
                                                            </button></td>
                                                        <td>
                                                            <p class="mb-0 fw-550" dmx-html="calculate_charges.chargefor+(calculate_charges.monthlychargeexists.exists == true &amp;&amp; calculate_charges.monthlychargeexists.status == 200 ? '<small class=&quot;fst-italic lh-1 text-danger fw-400&quot;>Monthly charge already exists. <br> Created: '+calculate_charges.monthlychargeexists.created.formatDate('yyyy-MM-dd')+'.</small>': calculate_charges.monthlychargeexists.exists == true &amp;&amp; calculate_charges.monthlychargeexists.status == 409 ? '<small class=&quot;lh-1 fst-italic text-danger fw-400&quot;><i class=&quot;bi-exclamation-octagon-fill text-danger me-2&quot;></i>'+calculate_charges.monthlychargeexists.chargeid+'</small>':'')">April 2022</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 fw-550" dmx-text="calculate_charges.tuitiontotals.enrolgrandtotal.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$77.50</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 fw-500 text-ledger" dmx-text="((calculate_charges.tuitiontotals.multienrol_discount + calculate_charges.tuitiontotals.family_discount) + calculate_charges.tuitiontotals.holding_fee).round(2).formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$22.50</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 text-muted" dmx-text="calculate_charges.tuitiontotals.baseRate.formatCurrency(localization.data.localization.currrency_symbol, appSettings.localization_num_separator, appSettings.localization_num_delimeter, 2)">$100.00</p>
                                                        </td>
                                                        <td><input id="inp_chargeDate" name="chargedate" type="text" class="form-control form-control-plaintext text-decoration-underline clickable" is="dmx-date-picker" dmx-bind:format="appSettings.localization_dateformat" dmx-bind:placeholder="appSettings.localization_dateformat" dmx-bind:value="calculate_charges.existingcharge.chargeexists ? calculate_charges.existingcharge.details.chargeDate.formatDate('yyyy-MM-dd') : dateAndTime_days.datetime.formatDate('yyyy-MM-dd')" placeholder="dd/MM/yyyy">
                                                        </td>
                                                        <td><input id="inp_dueDate" name="duedate" type="text" class="form-control form-control-plaintext text-decoration-underline clickable" is="dmx-date-picker" dmx-bind:format="appSettings.localization_dateformat" dmx-bind:placeholder="appSettings.localization_dateformat" dmx-bind:value="calculate_charges.existingcharge.chargeexists ? calculate_charges.existingcharge.details.dueDate.formatDate('yyyy-MM-dd') : ''" placeholder="dd/mm/yyyy" required="" data-msg-required="Due date is required."></td>
                                                    </tr>
                                                    <tr dmx-show="newEnrolmentModal.sc_quote.state.executing" class="placeholder-glow">
                                                        <td class="collapse-cell"><button class="btn btn-primary btn-sm text-nowrap placeholder disabled" style="width: 95px !important;"><i class="fas fa-plus-circle fa-sm fa-fw me-1"></i>Details
                                                            </button></td>
                                                        <td>
                                                            <p class="mb-0 fw-550 placeholder w-100">April 2022</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 fw-550 placeholder w-100">$77.50</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 fw-500 text-ledger placeholder w-100">$22.50</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 text-muted placeholder w-100">$100.00</p>


                                                        </td>
                                                        <td>
                                                            <p class="mb-0 text-muted placeholder w-100">$100.00</p>
                                                        </td>
                                                        <td>
                                                            <p class="mb-0 text-muted placeholder w-100">$100.00</p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <p class="mt-1 text-muted fst-italic small">* Charge Date and Due Date automatically set from existing charges on family's account.<br>** <b>CLICK</b>&nbsp;dates to change.</p>
                            </section>

                        </div>
                    </div>
                    <div class="row" id="newenrol_hiddeninputs">
                        <div class="col">
                            <input id="inp_hd_ne_dummyenrol_json" name="dummyenrol" type="hidden" class="form-control">
                            <input id="inp_hd_ne_familyuuid" name="family_uuid" type="hidden" class="form-control" dmx-bind:value="var_studentDetailsObject.value.family">
                            <div class="row" id="rp_hiddeninput_percharge" is="dmx-repeat" dmx-bind:repeat="sc_quote.data.exec_tuitioncalc.repeat">
                                <input id="inp_hd_ne_title" name="title" type="hidden" class="form-control" dmx-bind:name="record[{{$index}}][title]" dmx-bind:value="'Family Tuition Charge: '+calculate_charges.chargefor_date.formatDate('MMMM yyyy')">
                                <input id="inp_hd_ne_monthtoprocess" name="monthtoprocess" type="hidden" class="form-control" dmx-bind:name="record[{{$index}}][monthtoprocess]" dmx-bind:value="calculate_charges.chargefor_date.formatDate('yyyy-MM-dd')">
                                <input id="inp_hd_ne_charge_date" name="charge_date" type="hidden" class="form-control" dmx-bind:name="record[{{$index}}][charge_date]" dmx-bind:value="cr_newQuoteDetails.rp_ne_familycharges[$index].inp_chargeDate.value.formatDate('yyyy-MM-dd')">
                                <input id="inp_hd_ne_due_date" name="due_date" type="hidden" class="form-control" dmx-bind:name="record[{{$index}}][due_date]" dmx-bind:value="cr_newQuoteDetails.rp_ne_familycharges[$index].inp_dueDate.value.formatDate('yyyy-MM-dd')">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer d-flex justify-content-between border-top">
                <button type="button" class="btn btn-outline-danger" dmx-on:click="run([{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`enrolmentSearchModal.show()`}}])" data-bs-dismiss="modal">Back</button>
                <button class="btn btn-primary" dmx-on:click="run({condition:{if:`newEnrolmentModal.var_overbookingPotential.value`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Change enrolment.'}},message:`'<p>The next availability for this class is <strong>'+newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')+'</strong>.</p><p>The start date you have entered is <strong>'+newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.value.formatDate('dd MMMM yyyy')+'</strong>.</p>Would you like to overbook this class or change the enrolment?'`,title:'Overbook Warning',then:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}}},else:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}})" dmx-bind:disabled="sc_quote.state.executing">Create Enrolment</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" is="dmx-bs5-modal" tabindex="-1" role="dialog" id="newMakeupCasualModal" nocloseonclick="true" dmx-on:hidden-bs-modal="run({run:{action:`newEnrolmentModal.var_studentDetailsObject.setValue(null);newEnrolmentModal.var_classDetailsObject.setValue(null)`}})">
    <dmx-value id="var_mu_studentDetailsObject"></dmx-value>
    <dmx-value id="var_mu_classDetailsObject"></dmx-value>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <dmx-value id="var_mu_overbookingPotential"></dmx-value>

            <div class="modal-header" dmx-class:bg-makeup="newMakeupCasualModal.createMakeupForm.sel_mu_enrolmentType.value == 1" dmx-class:bg-casual="newMakeupCasualModal.createMakeupForm.sel_mu_enrolmentType.value == 3">
                <h5 class="modal-title fw-500" dmx-text="'Enrol: '+var_mu_studentDetailsObject.value.firstName+' '+var_mu_studentDetailsObject.value.lastName">Enrol: Jane Doe<br>
                </h5>
                <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="d-flex align-items-center mb-2 pb-2 border-bottom" dmx-html="'<i class=&quot;bi-arrow-right-circle fs-5 me-2&quot;></i> Class: '+var_mu_classDetailsObject.value.day_name+' - '+var_mu_classDetailsObject.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_mu_classDetailsObject.value.classLevel].name+' - '+appSettings.instructorsById[var_mu_classDetailsObject.value.instructorid].trunc_name"><i class="bi-arrow-right-circle fs-5 me-2"></i>Class Details
                </p>
                <form is="dmx-serverconnect-form" id="createMakeupForm" method="post" action="/api/classes/createEnrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-param:isvalid="1" dmx-on:success="run([{run:{action:`notifies1.success(var_studentDetailsObject.value.getValueOrKey(\'fullName\')+\' enroled successfully to - \'+classHumanDetailsGlobal.data.classHumanDetails.day+\' \'+classHumanDetailsGlobal.data.classHumanDetails.level+\' - with \'+classHumanDetailsGlobal.data.classHumanDetails.instructor)`}},{run:{action:`createEnrolmentForm.reset()`}},{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`classesBase.load({days: classesQuery.data.days, times: classesQuery.data.times},true)`}},{run:{action:`enrolmentSearchModal.inp_searchModal.setValue(null);queryManager.remove(\'searchtextfilter\')`}}])">
                    <input type="hidden" class="form-control" id="inp_mu_classId" name="classId" aria-describedby="inp_classId_help" placeholder="Enter Class" dmx-bind:value="newEnrolmentModal.var_classDetailsObject.value.id">
                    <input type="hidden" class="form-control" id="inp_mu_student" name="student" aria-describedby="inp_student_help" placeholder="Enter Student" dmx-bind:value="newEnrolmentModal.var_studentDetailsObject.value.id">
                    <div class="row row-cols-3 gy-2">
                        <div class="col">
                            <label for="inp_enrolmentType" class="col-form-label form-label">Enrolment type</label>
                            <select id="sel_mu_enrolmentType" class="form-select" name="enrolmentType1" dmx-bind:options="classesBase.data.enrolmentTypes.where('id', [2,4], 'inArray')" optiontext="type" optionvalue="id" dmx-bind:value="1" dmx-on:changed="run({condition:{if:`sel_enrolmentType.value == 5 || sel_enrolmentType.value == 2`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(inp_ne_startDate.value)`}}},else:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})"></select>
                        </div>
                        <div class="col-break w-100"></div>
                        <div class="col">

                            <label for="inp_mu_startDate" class="col-form-label form-label">Start date:</label>

                            <input step="7" is="dmx-date-picker" dmx-bind:mindate="dateAndTime_days.datetime.addDays(dateAndTime_days.datetime.getDate() + ((((var_mu_classDetailsObject.value.day_int - 1) + 7 - dateAndTime_days.datetime.getDay()) % 7) || 7) - dateAndTime_days.datetime.getDate()).addWeeks(-2).formatDate('yyyy-MM-dd')" class="form-control" id="inp_mu_startDate" name="startDate" aria-describedby="inp_ne_startDate_help" placeholder="dd/mm/yyyy" dmx-on:changed="run({condition:{if:`!inp_ne_dropDate.value &amp;&amp; -inp_ne_dropDate.value.formatDate(\'yyyy-MM-dd\').toTimestring() < inp_ne_startDate.value.formatDate(\'yyyy-MM-dd\').toTimesting()`,then:{steps:{run:{action:`inp_ne_dropDate.setValue(null)`}}}}})" opens="left" format="DD/MM/YYYY" showdropdowns="true" onkeydown="return false">

                        </div>
                        <div class="col">

                            <label for="inp_dropDate" class="col-form-label form-label">Drop date</label>
                            <input class="form-control" id="inp_mu_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="dd/mm/yyyy" type="text" is="dmx-date-picker" showdropdowns="true" format="DD/MM/YYYY">

                        </div>
                    </div>
                    <div class="row mt-3 row-cols-1 gx-0">
                        <div class="col" dmx-show="newEnrolmentModal.var_overbookingPotential.value === true">
                            <p class="fs-5 fw-600 mb-0 text-danger"><i class="bi-exclamation-octagon-fill me-2"></i>WARNING: OVERBOOKING POTENTIAL</p>

                            <p class="mb-2 small">Please confirm start date with customer. Puddle has defaulted the start date to the next available date for permanent enrolments (active/trial).&nbsp;<br>The next available date for a <b>permanent</b> enrolment is <b>{{newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')}}&nbsp;.</b></p>
                        </div>
                        <div class="col my-2 border-top pt-2" dmx-show="dateAndTime_days.datetime.getDay() == (newEnrolmentModal.var_classDetailsObject.value.day_int - 1)">
                            <div class="row g-0">
                                <div class="col">
                                    <p class="fs-5 fw-600 mb-0 text-danger"><i class="bi-exclamation-octagon-fill me-2"></i>WARNING: CONFIRM START DATE</p>

                                    <p class="small mb-0">By default, Puddle automatically sets the start date to the next day (including today) that the class is available.&nbsp;Time is not currently factored into start dates, and there is potential to enrol a student to start today when the class time has already passed.</p>
                                </div>
                            </div>


                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer d-flex justify-content-between border-top">
                <button type="button" class="btn btn-outline-danger" dmx-on:click="run([{run:{action:`newEnrolmentModal.hide()`}},{run:{action:`enrolmentSearchModal.show()`}}])" data-bs-dismiss="modal">Back</button>
                <button class="btn" dmx-class:btn-active="newEnrolmentModal.createEnrolmentForm.sel_enrolmentType.value == 1" dmx-class:btn-trial="newEnrolmentModal.createEnrolmentForm.sel_enrolmentType.value == 3" dmx-on:click="run({condition:{if:`newEnrolmentModal.var_overbookingPotential.value`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Change enrolment.'}},message:`'<p>The next availability for this class is <strong>'+newEnrolmentModal.var_classDetailsObject.value.details.active.formatDate('dd MMMM yyyy')+'</strong>.</p><p>The start date you have entered is <strong>'+newEnrolmentModal.createEnrolmentForm.inp_ne_startDate.value.formatDate('dd MMMM yyyy')+'</strong>.</p>Would you like to overbook this class or change the enrolment?'`,title:'Overbook Warning',then:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}}},else:{steps:{run:{action:`newEnrolmentModal.createEnrolmentForm.submit()`}}}}})">Create Enrolment</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="newWaitlistModal" is="dmx-bs5-modal" tabindex="-1" nocloseonclick="true" dmx-on:hidden-bs-modal="var_wl_classDetailsObject.setValue(null);var_wl_studentDetailsObject.setValue(null)">
    <dmx-value id="var_wl_classDetailsObject"></dmx-value>
    <dmx-value id="var_wl_studentDetailsObject"></dmx-value>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header text-white bg-dark">
                <h5 class="modal-title"><i class="fas fa-history me-2"></i>Confirm Waitlist
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col mb-3 pb-3 border-bottom">
                        <p dmx-html="'<i class=&quot;bi-arrow-return-right me-2&quot;></i>'+var_wl_classDetailsObject.value.day_name+' - '+var_wl_classDetailsObject.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_wl_classDetailsObject.value.classLevel].name+' - '+appSettings.instructorsById[var_wl_classDetailsObject.value.instructorid].trunc_name" class="mb-3 "><i class="bi-arrow-return-right me-2"></i>Class Details</p>
                        <p class="text-muted small mb-0"><i class="bi-exclamation-triangle-fill me-2 text-warning"></i>Note: To add longer waitlist time periods, please add waitlist from student details page. The details for this waitlist form are specific to the class listed above. Multiple days per waitlist request are not currently supported.</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h6 class="fw-bold">Waitlist Details</h6>
                        <div class="row row-cols-1 gy-1">
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Day:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_classDetailsObject.value.day_name">Monday</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Start Time:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_classDetailsObject.value.startTimeDisplay">10:00 AM</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">End Time:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_classDetailsObject.value.endTimeDisplay">10:30 AM</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Level:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="appSettings.classLevelsByID[var_wl_classDetailsObject.value.classLevel].name">Duckling</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Instructor:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="appSettings.instructorsById[var_wl_classDetailsObject.value.instructorid].trunc_name">Jane D.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <h6 class="fw-bold">Student for Waitlist</h6>
                        <div class="row row-cols-1 gy-1">
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">First Name:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.firstName">Jane</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Last Name:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.lastName">Doe</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Date of Birth:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.dob.formatDate('dd-MM-yyyy')">10-11-2011</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Age:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.age">10y 0m</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Level:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.level">Duckling</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row gx-2">
                                    <div class="col-auto">
                                        <p class="mb-0 text-muted fw-light">Gender:</p>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0" dmx-text="var_wl_studentDetailsObject.value.gender">F</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col mt-2 pt-2 border-top">
                        <form id="form_waitlistCreate" method="post" is="dmx-serverconnect-form" action="/api/classes/createWaitlist" dmx-on:success="notifies1.success('Waitlist successfully created.');newWaitlistModal.hide();enrolmentSearchModal.inp_searchModal.setValue(null);form_waitlistCreate.reset();classesBase.load({},true)" dmx-on:error="notifies1.danger('Something went wrong. Please try again. Error: '+newWaitlistModal.form_waitlistCreate.lastError.status +' - '+newWaitlistModal.form_waitlistCreate.lastError.message+' - '+newWaitlistModal.form_waitlistCreate.lastError.response)">
                            <input id="inp_wl_starttime" name="starttimedec" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.startTimeDecimal">
                            <input id="inp_wl_endtime" name="endtimedec" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.endTimeDecimal">
                            <input id="inp_wl_dayint" name="dayint" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.day_int">
                            <input id="inp_wl_instructor" name="instructor" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.instructorid">
                            <input id="inp_wl_studentid" name="studentid" type="hidden" class="form-control" dmx-bind:value="var_wl_studentDetailsObject.value.id">
                            <input id="inp_wl_classlevel" name="classlevel" type="hidden" class="form-control" dmx-bind:value="var_wl_classDetailsObject.value.classLevel">
                            <div class="mb-3">
                                <label for="inp_wl_requestdate" class="form-label col-form-label">Request Date</label>
                                <input type="date" class="form-control" id="inp_wl_requestdate" name="request_date" aria-describedby="input1_help" readonly="true" style="" dmx-bind:value="dateAndTime_days.datetime.formatDate('yyyy-MM-dd')">
                            </div>
                            <div class="mb-3">
                                <label for="textarea_edit_dropReason" class="form-label col-form-label w-100">Waitlist Notes:</label>
                                <small id="textarea_wl_notes_Help" class="form-text text-muted m-0">Add any notes to this waitlist. E.g. <i>"Waiting for sibling with other waitlist."</i></small>
                                <textarea id="textarea_wl_notes" name="notes" class="form-control rounded-3 w-100" rows="4"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal" dmx-on:click="run([{run:{action:`newWaitlistModal.hide()`}},{run:{action:`enrolmentSearchModal.show()`}}])">Back</button>
                <button type="button" class="btn btn-primary" dmx-on:click="form_waitlistCreate.submit();enrolmentSearchModal.inp_searchModal.setValue(null);queryManager.remove('searchtextfilter');notifies1.success('Waitlist Created.');classesBase.load({},true)">Add Waitlist</button>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="upgradeWaitlistModal" is="dmx-bs5-modal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title fw-light">Upgrade Waitlist</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body border-bottom">
                <dmx-value id="var_uw_studentDetailsObject"></dmx-value>
                <dmx-value id="var_uw_classDetailsObject"></dmx-value>
                <p class="mb-0 d-flex align-items-center fw-500" dmx-html="'<i class=&quot;bi-arrow-right-circle me-2 fs-5&quot;></i>Target Class: '+upgradeWaitlistModal.dd_uw_classDetails.data.day_name+' - '+upgradeWaitlistModal.dd_uw_classDetails.data.startTimeDisplay+' '+appSettings.classLevelsByID[upgradeWaitlistModal.dd_uw_classDetails.data.classLevel].name+' - '+appSettings.instructorsById[upgradeWaitlistModal.dd_uw_classDetails.data.instructorid].trunc_name"><i class="bi-arrow-right-circle me-2 fs-5"></i>Target Class: Monday - 10:00 AM Duckling - John D.
                </p>
            </div>
            <div class="modal-body border-bottom">
                <form id="form_upgradeWaitlist" is="dmx-serverconnect-form" method="post" action="/api/classes/waitlist/upgradeWaitlist">
                    <dmx-value id="var_uw_details"></dmx-value>
                    <div class="mb-3">
                        <label for="inp_uw_startDate" class="form-label col-form-label">Start Date <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="inp_uw_startDate" name="startDate" aria-describedby="input1_help" placeholder="dd/mm/yyyy" is="dmx-date-picker" format="DD/MM/YYYY" required="" data-msg-required="Please add a start date." dmx-bind:value="form_upgradeWaitlist.var_uw_details.value">
                    </div>

                    <div class="row">
                        <div class="col">
                            <div class="mb-3">
                                <label for="sel_uw_enroltype" class="form-label col-form-label">Enrolment Type <span class="text-danger">*</span></label>
                                <select id="sel_uw_enroltype" class="form-select" required="">
                                    <option value="1">Active Enrolment</option>
                                    <option value="3">Trial Enrolment</option>
                                </select>
                                <small id="select1Help" class="form-text text-muted">Select between active and trial enrolment types. Default is active.</small>
                            </div>

                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-body">
                <dmx-data-detail id="dd_uw_waitlistDetails" dmx-bind:data="dd_uw_classDetails.data.wait_enrols" key="id"></dmx-data-detail>
                <dmx-data-detail id="dd_uw_classDetails" dmx-bind:data="classesBase.data.rp_enrols" key="id">

                </dmx-data-detail>
                <div class="row">
                    <div class="col">
                        <div class="row g-0">
                            <div class="col p-3 border small" style="background: #fbfbfb;">
                                <h6 class="fw-500">Waitlist Details</h6>
                                <div class="row row-cols-1 gy-1">
                                    <div class="col mb-2 pb-2 border-bottom">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Request Date:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="dd_uw_waitlistDetails.data.request_date.formatDate('dd/MM/yyyy')">15/11/2021</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">

                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Day:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.days_array[dd_uw_waitlistDetails.data.dayint]">Monday</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Wait From:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.ct_obj[dd_uw_waitlistDetails.data.starttimedec].display">10:00 AM</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Wait To:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.ct_obj[dd_uw_waitlistDetails.data.endtimedec].display">10:30 AM</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Level:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.classLevelsByID[dd_uw_waitlistDetails.data.classlevel].name">Duckling</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted">Instructor:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.instructorsById[dd_uw_waitlistDetails.data.instructor].trunc_name">Jane D.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-12">
                                                <p class="mb-0 text-muted">Notes:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="dd_uw_waitlistDetails.data.notes || '-'">Lorem ipsum dolor sit amet. Consecuteur something something...</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col p-3 border border-start-0">
                                <h6 class="fw-500">Student for Waitlist</h6>
                                <div class="row row-cols-1 gy-1">
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">First Name:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.firstName">Jane</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Last Name:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.lastName">Doe</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Date of Birth:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.dob.formatDate('dd-MM-yyyy')">10-11-2011</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Age:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="upgradeWaitlistModal.var_uw_studentDetailsObject.value.age">10y 0m</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row gx-2">
                                            <div class="col-auto">
                                                <p class="mb-0 text-muted fw-light">Level:</p>
                                            </div>
                                            <div class="col">
                                                <p class="mb-0" dmx-text="appSettings.classLevelsByID[upgradeWaitlistModal.var_uw_studentDetailsObject.value.classlevel].name">Duckling</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

            <div class="modal-footer border-top d-flex justify-content-between">
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary"><i class="bi-stars me-2"></i>Upgrade
                </button>
            </div>
        </div>
    </div>

</div>

<div class="modal fade" id="createClassModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:hidden-bs-modal="createClassForm.reset()">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header align-items-center bg-primary text-light">
                <h5 class="modal-title fw-light">Create New Class</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">


                <form id="createClassForm" is="dmx-serverconnect-form" method="post" action="/api/classes/createClass" dmx-on:success="classesBase.load();createClassModal.hide()">



                    <div class="row">
                        <div class="col">
                            <h5 class="text-uppercase mb-2 pb-2 border-bottom">Schedule</h5>
                        </div>
                    </div>

                    <fieldset dmx-bind:disabled="ncm_timeslotError.collapsed ? false : true">
                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">


                            <dmx-value id="var_selectedTimeDecimal"></dmx-value>
                            <dmx-value class="d-none" id="var_classDurationSum" dmx-bind:value="(ncm_startTimeSelect.value.toNumber() + ncm_durationSelect.value.toNumber())" dmx-on:updated="startEndTimeCalc.run()"></dmx-value>
                            <dmx-value id="var_startTimeDisplay" dmx-on:updated="hd_inputClassStartDisplay.setValue(value)"></dmx-value>
                            <dmx-value id="var_endTimeDisplay"></dmx-value>
                            <script is="dmx-flow" id="startEndTimeCalc" type="text/dmx-flow">
                                {
                                condition: {
                                    if: "{{ncm_startTimeSelect.value !== \"\" && ncm_durationSelect.value !== \"\"}}",
                                    then: {
                                    steps: {
                                        runJS: {
                                            function: "decimalToTime",
                                            args: ["{{var_classDurationSum.value}}"],
                                            name: "endTimeCalc",
                                            output: true
                                        }
                                    }
                                    }
                                }
                            }
                        </script>
                            <script is="dmx-flow" id="timeToDisplay" type="text/dmx-flow" dmx-on:done="run({run:{action:`var_startTimeDisplay.setValue(timeToDisplay.data.displayTime)`}})">
                                {
                                runJS: {
                                    function: "selectedTimeToDisplay",
                                    args: ["{{var_selectedTimeDecimal.value}}"],
                                    name: "displayTime",
                                    output: true
                                }
                            }
                        </script>
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_daySelect" class="col-form-label form-label">Day</label>
                                    <select id="ncm_daySelect" class="form-select" dmx-bind:options="classesBase.data.days.days" optiontext="name" optionvalue="id">
                                        <option selected="" value="" disabled="">Select Day</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_startTimeSelect" class="col-form-label form-label">Start Time:</label>
                                    <select id="ncm_startTimeSelect" class="form-select" dmx-bind:options="appSettings.ct_array" optiontext="display" optionvalue="decimal" dmx-on:changed="var_selectedTimeDecimal.setValue(value);timeToDisplay.run()">
                                        <option selected="" value="">Select Start Time</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_durationSelect" class="col-form-label form-label">Duration</label>
                                    <select id="ncm_durationSelect" class="form-select" dmx-bind:options="appSettings.duration_array" optiontext="display" optionvalue="value">
                                        <option selected="" value="">Select Class Duration</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">

                                <div class="mb-3">
                                    <label for="ncm_endTimeInput" class="col-form-label form-label">End Time:</label>
                                    <input type="text" class="form-control" id="ncm_endTimeInput" aria-describedby="input1_help" disabled="true" dmx-bind:value="startEndTimeCalc.data.endTimeCalc">
                                    <small id="bs4-form-group-help8" class="form-text text-muted">Calculated from class start and duration.</small>
                                </div>
                            </div>
                        </div>

                        <hr>
                        <div class="row">
                            <div class="col">
                                <h5 class="text-uppercase mb-2 pb-2 border-bottom">Class Details</h5>
                            </div>
                        </div>

                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">


                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_daySelect" class="col-form-label form-label">Instructor</label>
                                    <select id="ncm_instructorSelect" class="form-select" dmx-bind:value="getInstructors.data.getInstructors" required="" dmx-bind:options="getInstructors.data.getInstructors.sort(firstName)" optionvalue="id" optiontext="firstName+' '+lastName.trunc(1, true, '.')">
                                        <option selected="" value="">Select Instructor</option>
                                    </select>
                                </div>

                            </div>



                        </div>
                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                            <div class="col">
                                <div class="mb-3">
                                    <label for="ncm_daySelect" class="col-form-label form-label">Class Level</label>
                                    <select id="ncm_classLevelSelect" class="form-select" required="" dmx-bind:options="getLevels.data.query" optiontext="name " optionvalue="id" dmx-on:updated="run([{runJS:{function:'getSelectText',args:['#ncm_classLevelSelect'],name:'getSelectText'}},{run:{action:`createClassModal.createClassForm.inp_hd_classType.setValue(appSettings.classLevels[getSelectText].classType);createClassModal.createClassForm.var_classTypeName.setValue(appSettings.classLevels[getSelectText].classType_longName)`}}])">
                                        <option selected="" value="">Select Level</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3 mb-0">
                                    <label for="classType" class="col-form-label form-label">Class Type</label>
                                    <input type="text" class="form-control" id="classType" name="classTypeLongName" aria-describedby="input1_help" readonly="true" dmx-bind:value="var_classTypeName.value" disabled="true">
                                    <small id="bs4-form-group-help7" class="form-text text-muted">Auto-updated after class level selected.</small>

                                </div>
                                <dmx-value id="var_classTypeName"></dmx-value>

                            </div>
                        </div>
                        <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                            <div class="col">
                                <div class="mb-3">
                                    <label for="inp_max" class="col-form-label form-label">Max Students</label>
                                    <input type="text" class="form-control" id="inp_max" name="max" aria-describedby="input1_help" placeholder="E.g. 1" required="" data-rule-number="" data-msg-number="Numbers only.">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <div class="row" id="r_timeslotCheckError">
                        <div class="col">
                            <input id="inp_hd_classType" name="classType" class="form-control" type="hidden"><input id="hd_inputClassDay" name="day" type="hidden" class="form-control" dmx-bind:value="ncm_daySelect.value">
                            <input id="hd_inputClassStart" name="startTimeDecimal" type="hidden" class="form-control" dmx-bind:value="ncm_startTimeSelect.value">
                            <input id="hd_inputClassEnd" name="endTimeDecimal" type="hidden" class="form-control" dmx-bind:value="var_classDurationSum.value">
                            <input id="hd_inputClassStartDisplay" name="startTimeDisplay" type="hidden" class="form-control" dmx-bind:value="var_startTimeDisplay.value">
                            <input id="hd_inputClassEndDisplay" name="endTimeDisplay" type="hidden" class="form-control" dmx-bind:value="ncm_endTimeInput.value">
                            <input id="hd_inputInstructor" name="instructor" type="hidden" class="form-control" dmx-bind:value="ncm_instructorSelect.value">
                            <input id="hd_inputLevel" name="classLevel" type="hidden" class="form-control" dmx-bind:value="ncm_classLevelSelect.value">
                        </div>
                    </div>

                </form>

                <div class="collapse" id="ncm_timeslotError" is="dmx-bs5-collapse" dmx-bind:show="checkClassTimeslot.data.classTSAvailability > 0">
                    <hr>
                    <div class="d-flex align-items-stretch flex-column">
                        <div class="card text-white bg-danger">

                            <div class="card-header">
                                <h5 class="mb-0">{{checkClassTimeslot.data.classTSAvailability[0].instructorName}} already has classes at this time.</h5>
                            </div>
                            <div class="card-body bg-light">
                                <div class="d-flex">
                                    <div class="table-responsive">
                                        <table class="table table-sm mb-0">
                                            <thead>
                                                <tr>
                                                    <th>Id</th>
                                                    <th>Day</th>
                                                    <th>Level</th>
                                                    <th>Start</th>
                                                    <th>End</th>
                                                    <th>Instructor</th>
                                                </tr>
                                            </thead>
                                            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="checkClassTimeslot.data.classTSAvailability" id="tableRepeat2">
                                                <tr>
                                                    <td dmx-text="id"></td>
                                                    <td dmx-text="dayName"></td>
                                                    <td dmx-text="levelName"></td>
                                                    <td dmx-text="startTimeDisplay"></td>
                                                    <td dmx-text="endTimeDisplay"></td>
                                                    <td dmx-text="instructorName"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div class="d-flex justify-content-between">

                                    <button id="changeClassDetailsBtn" class="btn btn-outline-light" dmx-on:click="run([{run:{action:`createClassModal.ncm_timeslotError.hide()`}},{wait:{delay:300}},{run:{action:`checkClassTimeslot.reset()`}}])"><i class="fas fa-undo-alt  fa-fw me-1"></i>Change</button><button id="submitFormAnywayBtn" class="btn btn-outline-light"><i class="fas fa-plus-circle fa-fw me-1"></i>Create Anyway
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <p></p>
            <div class="modal-footer">
                <fieldset dmx-bind:disabled="ncm_timeslotError.collapsed ? false : true">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>

                    <button class="btn btn-primary" dmx-on:click="run({condition:{if:`content.createClassModal.ncm_timeslotError.collapsed`,then:{steps:[{run:{action:`checkClassTimeslot.load({instructor: createClassForm.hd_inputInstructor.value, day: createClassForm.hd_inputClassDay.value, starttimedecimal: createClassForm.hd_inputClassStart.value, endtimedecimal: createClassForm.hd_inputClassEnd.value, classid: \'\', isactive: \'1\'})`}},{wait:{delay:200}},{condition:{if:`content.checkClassTimeslot.data.classTSAvailability.length > 0`,then:{steps:{run:{action:`createClassModal.ncm_timeslotError.show()`}}},else:{steps:{run:{action:`createClassModal.createClassForm.submit()`}}}}}]},else:{steps:{run:{action:`createClassModal.createClassForm.submit()`}}}}})">Create
                        Class</button>
                </fieldset>
            </div>
        </div>
    </div>
</div>
<div class="modal fade draggable-modal" id="editClassModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:show-bs-modal="run([{run:{action:`editClassForm.ec_startEndTimeCalc.run()`}},{run:{action:`editClassForm.ec_timeToDisplay.run()`}}])" dmx-on:hidden-bs-modal="run([{run:{action:`checkClassTimeslot.reset()`}},{run:{action:`editClassForm.reset();editClassModal.var_classDetails.setValue(null)`}},{runJS:{function:'pd_dirtyFormCheck_destroy'}}])" dmx-on:shown-bs-modal="run({runJS:{function:'pd_dirtyFormCheck_init',args:['editClassForm']}})">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">



            <div class="modal-header align-items-center bg-secondary text-white">
                <dmx-value id="ec_var_classTitle"></dmx-value>
                <h5 class="modal-title text-start fw-light" dmx-text="'Edit Class: '+var_classDetails.value.day_name+' - '+var_classDetails.value.startTimeDisplay+' '+appSettings.classLevelsByID[var_classDetails.value.classLevel].name+' - '+appSettings.instructorsById[var_classDetails.value.instructorid].trunc_name">Edit Class: Monday - 10:00 AM Duckling - Ron S.</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">




            </div>
            <div class="modal-footer border-top d-flex justify-content-between">
                <dmx-value id="var_editclass_dirtyform" dmx-bind:value="browser1"></dmx-value>
                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                <button class="btn text-light btn-primary" dmx-on:click="run([{run:{action:`checkClassTimeslot.load({instructor: var_classDetails.value.instructorid, day: var_classDetails.value.day_int, starttimedecimal: var_classDetails.value.startTimeDecimal, endtimedecimal: var_classDetails.value.endTimeDecimal, classid: var_classDetails.value.id, isactive: var_classDetails.value.isactive})`}},{condition:{if:`checkClassTimeslot.data.classTSAvailability.length > 0`,else:{steps:{run:{action:`editClassModal.dd_editClass.editClassForm.submit()`}}}}}])" dmx-bind:disabled="pd_dirtyFormCheck.editClassForm.dirty === false">Edit
                    Class</button>
            </div>
        </div>
    </div>
</div>
<%- await include('/partials/classes/oc_editClassDetails', Object.assign({}, locals)) %>

<div class="modal fade" id="classTransferSearchModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" style="z-index: 99999;">
    <div class="modal-dialog modal-dialog-scrollable modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header text-light bg-primary ">
                <h5 class="modal-title">Enrolment Transfer Search:</h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="tsm_searchClassForm">
                    <div class="row gx-3 row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
                        <div class="col">
                            <div class="mb-3">
                                <label for="cb_tr_addTransferReason" class="col-form-label form-label">Day</label>
                                <select id="tr_selDay" class="form-select" dmx-bind:options="classesBase.data.days.days" optiontext="name" optionvalue="id" name="day">
                                    <option value="">Select Day</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="inp_updcharge_duedate" class="col-form-label form-label">Time</label>
                                <select id="tr_selTime" class="form-select" dmx-bind:options="appSettings.ct_array" optiontext="display" optionvalue="decimal" name="startdecimal">
                                    <option selected="" value="">Select Time</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="input3" class="col-form-label form-label">Level</label>
                                <select id="tr_selLevel" class="form-select" dmx-bind:options="getLevels.data.query" optiontext="name" optionvalue="id" name="classlevel">
                                    <option value="">Select Level</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="input4" class="col-form-label form-label">Instructor</label>
                                <select id="tr_selInstructor" class="form-select" dmx-bind:options="getAllStaff.data.instructors.getInstructors" optiontext="firstName+' '+lastName.trunc(1, true, '.')" optionvalue="id" name="instructor">
                                    <option value="">Select Instructor</option>
                                </select>
                            </div>

                        </div>
                    </div>
                    <div class="row justify-content-end no-gutters"><button id="tr_searchButton" class="btn btn-light" dmx-on:click="searchClasses.load({instructor: tr_selInstructor.value, startdecimal: tr_selTime.value, day: tr_selDay.value, classlevel: tr_selLevel.value})"><i class="fas fa-search me-1"></i>Search</button></div>

                </form>
                <hr>
                <div class="row">
                    <div class="col">
                        <header>
                            <h5 class="fw-light mb-0">Search Results:</h5>
                            <small class="text-muted">Only the top 10 results are shown. If the class you're searching for isn't shown, please narrow down the search even further.</small>
                        </header>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr class="fw-bold small">
                                        <th class="border-0">Day</th>
                                        <th class="border-0">Class Time</th>
                                        <th class="border-0">Class Level</th>
                                        <th class="border-0">Instructor</th>
                                        <th scope="row" class="border-0">Availability</th>
                                        <th scope="row" class="border-0"></th>
                                    </tr>
                                </thead>
                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="searchClasses.data.classesSearch" id="tableRepeat3">
                                    <tr>
                                        <td dmx-text="day" class="align-middle"></td>
                                        <td dmx-text="startTimeDisplay.replace(' AM', '').replace(' PM', '') +' - '+endTimeDisplay" class="align-middle"></td>
                                        <td dmx-text="classLevel" class="align-middle"></td>
                                        <td dmx-text="instructorFirst +' '+instructorLast.trunc(1, true, '.')" class="align-middle"></td>
                                        <td class="align-middle" dmx-text="availability"></td>
                                        <td class="text-end align-middle"><button id="transferButton" class="btn btn-light btn-sm" wappler-command="editContent" dmx-hide="availability == 'FULL' || availability == 'OVERBOOKED'" dmx-on:click="transferEnrolmentModal.transferEnrolmentForm.var_transferToClass.setValue({'id': classid, 'day': day, 'level': classLevel, 'instructor': instructorFirst + ' ' + instructorLast.trunc(1, true, '.'), 'time': startTimeDisplay});classTransferSearchModal.hide()"><i class="fas fa-random me-1"></i>Transfer
                                            </button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="transferEnrolmentModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:hidden-bs-modal="GET_ENROLMENT_single.reset();transferEnrolmentForm.reset();classTransferSearchModal.tsm_searchClassForm.reset()" dmx-style:opacity="">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-random fa-sm fa-fw me-2 text-primary"></i>Transfer Enrolment:

                </h5>
                <button type="button" class="btn-close text-light" aria-label="Close" data-bs-dismiss="modal">
                    <span aria-hidden="true" class="visually-hidden">Ã—</span>
                </button>
            </div>
            <div class="modal-body light-blue-bg">
                <form is="dmx-serverconnect-form" id="transferEnrolmentForm" method="post" action="/api/classes/transferEnrolment" dmx-generator="bootstrap5" dmx-form-type="vertical" dmx-on:success="transferEnrolmentModal.hide();notifies1.success(GET_ENROLMENT_single.data.student.firstName+' '+GET_ENROLMENT_single.data.student.lastName+'\'s enrolment successfully transferred.');classesBase.load()" dmx-param:fromenrolmentid="{{GET_ENROLMENT_single.data.enrolment.id}}">

                    <div class="row row-cols-1 g-0 mb-3" id="row_transferringFrom">
                        <div class="col p-4 py-3 rounded-3 bg-white pdl-surface-shadow">

                            <h5 class="mb-2 pb-2 border-bottom" dmx-html="'<i class=&quot;fas fa-child fa-sm me-1 fa-fw text-primary&quot;></i>'+GET_ENROLMENT_single.data.student.firstName+' '+GET_ENROLMENT_single.data.student.lastName"><i class="fas fa-child fa-sm me-1 fa-fw text-primary"></i>Some Student Name</h5>
                            <p dmx-text="'Transferring From: '+appSettings.days_array[GET_ENROLMENT_single.data.class.classday] + ' - ' + GET_ENROLMENT_single.data.class.startTimeDisplay + ' ' + appSettings.classLevelsByID[GET_ENROLMENT_single.data.class.classlevel_uuid].name + ' - ' + appSettings.instructorsById[GET_ENROLMENT_single.data.class.instructor_uuid].trunc_name" class="fw-600">Transferring From:</p>

                            <div class="row mt-2 pt-2 border-top g-0">
                                <div class="col">
                                    <label for="inp_dropDate" class="col-form-label form-label">Drop date (current class)</label>
                                    <input type="text" class="form-control w-auto" id="inp_dropDate" name="dropDate" aria-describedby="inp_dropDate_help" placeholder="Enter Drop date" dmx-bind:value="GET_ENROLMENT_single.data.enrolment.dropDate.formatDate('yyyy-MM-dd')" required="" is="dmx-date-picker" dmx-bind:format="appSettings.localization_dateformat" dmx-bind:placeholder="appSettings.localization_dateformat.lowercase()" data-rule-date="" style="">
                                    <div class="row mt-2">
                                        <div class="col">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" value="" id="cb_tr_addTransferReason" name="input1">
                                                <label class="form-check-label" for="cb_tr_addTransferReason">Add transfer reason?</label>
                                            </div>
                                            <div class="collapse" id="transferReasonCollapse" is="dmx-bs5-collapse" dmx-bind:show="cb_tr_addTransferReason.checked">
                                                <div class="mb-3">
                                                    <label class="col-form-label form-label" for="cb_tr_futureDropDate">Transfer Reason:</label>
                                                    <textarea id="inp_tr_dropReason" type="textarea" class="form-control border p-2 rounded-small" rows="4"></textarea>
                                                    <input id="inp_hd_dropReason" name="dropReason" type="hidden" class="form-control" dmx-bind:value="inp_tr_dropReason.value == &quot;&quot; ? 'Transferred to: ' +GET_ENROLMENT_single.data.class.dayName+' '+GET_ENROLMENT_single.data.class.levelName+' - '+GET_ENROLMENT_single.data.class.startTimeDisplay+' - '+GET_ENROLMENT_single.data.class.instructorFirstName+' '+GET_ENROLMENT_single.data.class.instructorLastName.trunc(1, true, '.') : inp_tr_dropReason.value">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="row row-cols-1 g-0" id="row_transferringTo">

                        <div class="col p-4 py-3 rounded-3 bg-white pdl-surface-shadow">

                            <div class="row no-gutters">
                                <dmx-value id="var_transferToClass"></dmx-value>
                                <div class="col-break w-100"></div>

                            </div>
                            <div class="row gx-3">
                                <div class="col">
                                    <div class="row mb-2 align-items-center">
                                        <div class="col">
                                            <p dmx-hide="var_transferToClass.value == null" dmx-text="var_transferToClass.value.day+' - '+var_transferToClass.value.time+' - '+var_transferToClass.value.level+' - '+var_transferToClass.value.instructor " class="fw-600 mb-0">Transferring To:</p>
                                        </div>
                                        <div class="col d-flex flex-row justify-content-end"><button id="btn_addTransfer" class="btn btn-sm btn-secondary" dmx-hide="var_transferToClass.value != null" dmx-on:click="classTransferSearchModal.show()"><i class="fas fa-plus-circle  me-1 fa-fw fa-sm"></i>Add Class</button><button id="btn_changeTransfer" class="btn btn-outline-primary btn-sm" dmx-hide="var_transferToClass.value == null" dmx-on:click="classTransferSearchModal.show()"><i class="fas fa-sync me-1 fa-xs fa-fw"></i>Change</button></div>
                                    </div>

                                    <p class="text-muted rounded-small border border-danger p-2" dmx-show="var_transferToClass.value == null"><i class="fas fa-exclamation-triangle text-danger"></i>&nbsp;<span class="text-danger">Please select a class to transfer to.</span></p>


                                </div>

                            </div>
                            <div class="row">
                                <div class="col">
                                    <div class="mb-3">
                                        <label for="inp_tr_startDate" class="col-form-label form-label">Start date</label>
                                        <input type="text" class="form-control w-auto" id="inp_tr_startDate" name="startDateTo" placeholder="Enter Start date" required="" is="dmx-date-picker" dmx-bind:format="appSettings.localization_dateformat" dmx-bind:placeholder="appSettings.localization_dateformat.lowercase()" data-rule-date="">
                                    </div>
                                </div>
                                <div class="col">
                                    <label for="sel_tr_enrolmentType" class="col-form-label form-label">Enrolment Type:</label>
                                    <select id="sel_tr_enrolmentType" class="form-select w-auto" name="enrolmentTypeTo" dmx-bind:options="appSettings.enrolTypesArray" optiontext="type" optionvalue="id"></select>
                                </div>
                            </div>
                            <div class="row g-0 mb-3">
                                <div class="col">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" value="" id="cb_tr_futureDropDate" name="input2">
                                        <label class="form-check-label" for="cb_tr_futureDropDate">Add future drop date?</label>
                                    </div>
                                    <div class="collapse" id="futureDropdateCollapse" is="dmx-bs5-collapse" dmx-bind:show="cb_tr_addTransferReason.checked">
                                        <div class="mb-3">
                                            <label class="col-form-label form-label" for="cb_tr_futureDropDate">Future Drop Date:</label>
                                            <input id="inp_futureDropDate" name="dropDateTo" class="form-control w-auto" type="text" is="dmx-date-picker" dmx-bind:format="appSettings.localization_dateformat" dmx-bind:placeholder="appSettings.localization_dateformat.lowercase()" data-rule-date="">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <small id="bs4-form-group-help6" class="form-text text-muted text-end">EnrolmentID: {{GET_ENROLMENT_single.data.enrolment.uuid}}</small>

                        </div>
                        <input id="inp_hd_toClassId" name="toClassId" type="hidden" class="form-control" dmx-bind:value="var_transferToClass.value.id">
                        <input id="inp_hd_studentId" name="student" type="hidden" class="form-control" dmx-bind:value="GET_ENROLMENT_single.data.student.id">
                    </div>
                </form>
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-secondary" dmx-on:click="transferEnrolmentModal.hide();notifies1.info('Enrolment transfer cancelled.')" data-bs-dismiss="modal">Cancel</button>
                <button class="btn btn-primary" form="editEnrolmentForm" dmx-on:click="transferEnrolmentForm.submit()">Transfer</button>
            </div>
        </div>
    </div>
</div>
<%- await include('/partials/classes/_mod_classDetails', Object.assign({}, locals)) %>

<%- await include('/partials/classes/_classfilters', Object.assign({}, locals)) %>

<%- await include('/partials/classes/_mod_dropEnrolment', Object.assign({_enrolment_details: `{{GET_ENROLMENT_single.data}}`}, locals)) %>
<main class="d-flex flex-grow-1 flex-column p-5 pt-3">

    <div class="row flex-grow-1 g-0">

        <div class="col">
            <%- await include('/partials/classes/_weekrange', Object.assign({}, locals)) %><section class="large-max-width">

                <div class="row">
                    <div class="col" style="">
                        <div class="row mt-0 justify-content-end mb-3 gy-2">

                            <div class="col align-self-center d-flex flex-row align-items-center justify-content-start">
                                <button id="btn_toggle_classfilters" class="btn btn-primary" dmx-on:click="oc_classFilters.show()"><i class="fas fa-filter me-2"></i>Class Filters
                                </button>
                            </div>
                            <div class="col-auto d-flex align-items-center flex-row justify-content-end pe-4" dmx-hide="browser1.location.pathparts.contains(' classesCalendar')">
                                <p class="mb-0 me-2">View</p>
                                <div class="dropdown">
                                    <button id="dropdown_limit" class="btn dropdown-toggle change-chevron btn-outline-link p-0 text-decoration-underline" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" dmx-html="classesBase.data.nextavail.limit + '<i class=&quot;fas fa-chevron-down fa-fw ms-1 fa-xs&quot;></i>'">
                                        Limit <i class="fas fa-chevron-down fa-fw ms-1 fa-xs"></i>
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdown_limit">
                                        <a class="dropdown-item" dmx-on:click="queryManager.set('limit',25);queryManager.set('offset',0)" href="#">25</a>
                                        <a class="dropdown-item" dmx-on:click="queryManager.set('limit',50);queryManager.set('offset',0)" href="#">50</a>
                                        <a class="dropdown-item" dmx-on:click="queryManager.set('limit',75);queryManager.set('offset',0)" href="#">75</a>
                                        <a class="dropdown-item" dmx-on:click="queryManager.set('limit',100);queryManager.set('offset',0)" href="#">100</a>
                                    </div>
                                </div>

                            </div>
                            <div class="col-auto d-flex flex-row justify-content-start align items-center align-items-center">
                                <div class="dropdown">
                                    <dmx-value id="var_classlistoffset" dmx-bind:value="query.offset" dmx-on:updated="classesQuery.set('offset',value)"></dmx-value>
                                    <dmx-value id="var_classlistpage" dmx-bind:value="(query.offset==0) ? 1 : ((query.offset/query.limit)+1)"></dmx-value>
                                    <button id="dropdown_class_pagination" class="btn dropdown-toggle change-chevron btn-outline-link p-0 text-decoration-underline" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" dmx-html="'Page:&nbsp;&nbsp;&nbsp;<strong>'+classesBase.data.nextavail.page.current+'</strong><i class=&quot;fas fa-chevron-down fa-fw fa-sm ms-1&quot;></i>'">
                                        Page:&nbsp;&nbsp;&nbsp;<strong>1</strong><i class="fas fa-chevron-down fa-fw ms-1 fa-xs"></i>
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdown_class_pagination">
                                        <a class="dropdown-item" href="#" dmx-repeat:rp_pagination_options="classesBase.data.nextavail.page.total" dmx-bind:value="($index * classesBase.data.nextavail.limit)" dmx-text="($index + 1)" dmx-on:click="var_classlistpage.setValue(($index+1));var_classlistoffset.setValue((classesBase.data.nextavail.limit * ($index)))">Action</a>
                                    </div>
                                </div>
                                <p class="mb-0 d-flex align-items-center ms-2 fw-500" dmx-text="'of '+classesBase.data.nextavail.page.total">of 49</p>
                            </div>

                            <div class="col-break w-100"></div>
                        </div>
                        <div class="row mb-2" dmx-hide="arr_timesfilter.count===0&amp;&amp;arr_daysfilter.count===0&amp;&amp;arr_levelsfilter.count===0&amp;&amp;arr_instructorsfilter.count===0">
                            <div class="col">
                                <h6 class="fw-900 mb-1"><i class="fas fa-filter me-2 fa-sm text-primary"></i>Filters Applied:
                                </h6>
                                <div class="row g-0 mb-1 fw-600">
                                    <div class="col">
                                        <small class="text-muted">Press ESC to clear filters.</small>
                                    </div>
                                </div>
                                <div class="row mb-1">
                                    <div class="col-auto d-flex flex-row justify-content-start" dmx-hide="arr_daysfilter.count===0">
                                        <p class="mb-0 me-2 fw-900">Days: </p>
                                        <p class="mb-0 fw-500 me-2 clickable user-select-none" dmx-repeat:rp_classpage_filters_days="class_filter_store.data.filter_days" dmx-html="'<span class=&quot;text-decoration-underline&quot;>'+appSettings.days_array[$value]+'</span><small style=&quot;font-size:0.6rem;&quot; class=&quot;text-muted text-decoration-none&quot;>&nbsp;&#10006;</small>'" dmx-on:click="arr_daysfilter.removeAt($index)">Monday <small class="text-muted">&#10006;</small> </p>
                                    </div>
                                    <div class="col-auto d-flex flex-row justify-content-start" dmx-hide="arr_timesfilter.count===0">
                                        <p class="mb-0 me-2 fw-900">Times: </p>
                                        <p class="mb-0 fw-500 me-2 clickable user-select-none" dmx-repeat:rp_classpage_filters_times="class_filter_store.data.filter_times" dmx-html="'<span class=&quot;text-decoration-underline&quot;>'+$value.unstringify().display+'</span><small style=&quot;font-size:0.6rem;&quot; class=&quot;text-muted text-decoration-none&quot;>&nbsp;&#10006;</small>'" dmx-on:click="arr_timesfilter.removeAt($index)">3:00 - 4:00 PM <small class="text-muted">&nbsp;&#10006;</small>
                                        </p>
                                    </div>
                                    <div class="col-auto d-flex flex-row justify-content-start" dmx-hide="arr_levelsfilter.count===0">
                                        <p class="mb-0 me-2 fw-900">Levels: </p>
                                        <p class="mb-0 fw-500 me-2 clickable user-select-none" dmx-repeat:rp_classpage_filters_levels="class_filter_store.data.filter_levels" dmx-html="'<span class=&quot;text-decoration-underline&quot;>'+appSettings.classLevelsByID[$value].name+'</span><small style=&quot;font-size:0.6rem;&quot; class=&quot;text-muted text-decoration-none&quot;>&nbsp;&#10006;</small>'" dmx-on:click="arr_levelsfilter.removeAt($index)">Penguin <small class="text-muted">&#10006;</small></p>
                                    </div>
                                    <div class="col-auto d-flex flex-row justify-content-start" dmx-hide="arr_instructorsfilter.count===0">
                                        <p class="mb-0 me-2 fw-900">Instructors: </p>
                                        <p class="mb-0 fw-500 me-2 clickable user-select-none" dmx-repeat:rp_classpage_filters_instructors="class_filter_store.data.filter_instructors" dmx-html="'<span class=&quot;text-decoration-underline&quot;>'+appSettings.instructorsById[$value].trunc_name+'</span><small style=&quot;font-size:0.6rem;&quot; class=&quot;text-muted text-decoration-none&quot;>&nbsp;&#10006;</small>'" dmx-on:click="arr_instructorsfilter.removeAt($index)">Sarah J. <small class="text-muted">&#10006;</small></p>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
                <div class="row gx-3">
                    <div class="col">
                        <div class="row g-0">
                            <div class="col p-4 pdl-surface-shadow rounded-3 bg-white d-none">

                                <div class="row" id="cr_classlist_wrapper" dmx-animate-leave.duration:1000.delay:50="fadeOut" dmx-animate-enter.duration:1000.delay:50="fadeIn" dmx-hide="classesBase.state.processing||classesBase.status!==200">
                                    <div class="col">
                                        <div id="rp_tabs" class="row row-cols-1 g-0" is="dmx-repeat" dmx-bind:repeat="classesBase.data.nextavail.classes" dmx-class:loading-block="content.classesBase.state.executing">
                                            <div class="col class-card border rounded-3 bg-white postition-relative mb-2 py-3 px-3" dmx-style:border-left-color.important="'#'+appSettings.classLevelsByID[classlevel_uuid].colour">
                                                <div class="row row-cols-8 clickable g-0" dmx-on:click="enrolmentsCollapse.toggle()">

                                                    <div class="align-self-center col class-info d-flex flex-column justify-content-start align-items-start">
                                                        <p class="fw-550 fs-6 mb-1" dmx-html="appSettings.classLevelsByID[classlevel_uuid].name">Duckling</p>
                                                        <p class="mb-1" dmx-text="appSettings.days_array[classday].trunc(3,true,': ')+' '+details.weekday.formatDate('dd/MM/yyyy')">Monday</p>
                                                        <p dmx-html="startTimeDisplay.replace(' AM', '').replace(' PM', '')+' - '+endTimeDisplay" style="white-space: nowrap;" class="mb-0">9:00 - 9:30am</p>
                                                    </div>
                                                    <div class="align-self-center col">
                                                        <p class="mb-0 text-start" dmx-text="instructor_uuid === null ? '<<NO INSTRUCTOR FOUND>>' : appSettings.instructorsById[instructor_uuid].trunc_name">Instructor</p>
                                                    </div>

                                                    <div class="col align-self-center">
                                                        <div class="row row-cols-2 w-100 gx-2 gy-3" dmx-hide="details.total === 0" style="white-space: nowrap;">
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center" dmx-hide="details.enrolments.active_enrols.length === 0">
                                                                <i class="fas fa-check-circle me-2 text-active-light fa-fw"></i>
                                                                <p class="mb-0" dmx-text="details.enrolments.active_enrols.length+' Act.'">0 Act.</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_enrolCountMakeup" dmx-hide="details.enrolments.makeup_enrols.length === 0">
                                                                <i class="fas fa-arrow-alt-circle-up me-2 text-makeup fa-fw"></i>
                                                                <p class="mb-0" dmx-html="details.enrolments.makeup_enrols.length+' M/Up'">0 M/Ups</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_enrolCountTrial" dmx-hide="details.enrolments.trial_enrols.length === 0">
                                                                <i class="fas fa-question-circle me-2 text-trial-light fa-fw"></i>
                                                                <p class="mb-0" dmx-html="details.enrolments.trial_enrols.length+' Trial'">0 Trials</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_waitlistCount" dmx-hide="waitlists.length===0">
                                                                <i class="fas fa-history me-2 text-waitlist fa-fw"></i>

                                                                <p class="mb-0" dmx-html="waitlists.length+' Wait'">0 Wait</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center" id="cr_casualCount" dmx-hide="details.enrolments.casual_enrols.length === 0">
                                                                <i class="fas fa-bookmark me-2 text-casual fa-fw"></i>
                                                                <p class="mb-0" dmx-html="details.enrolments.casual_enrols.length+' Cas.'">0 Cas.</p>
                                                            </div>
                                                        </div>
                                                        <div class="row" dmx-show="details.total === 0">
                                                            <div class="col">
                                                                <p class="fw-bold mb-0 text-danger"><i class="bi-slash-square me-2 text-danger"></i>Empty</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col align-self-center d-flex flex-column justify-content-center align-items-end">
                                                        <p class="text-center mb-1 text-muted">Makeup/Casual
                                                            <i onclick="return false;" class="fas fa-question-circle-fill ms-1" dmx-bs-popover="'<p>Makeup/casual availabilities are automatically calculated by Puddle. The calculations are based off your Makeup Book Ahead settings.</p><p>Your current settings are set to allow Makeup/Casual enrolments to be booked <strong>'+appSettings.enrol_makeup_book_ahead_days+' days ahead.</strong></p><p class=&quot;mb-0&quot;>Casual enrolment availabilities are calculated the same as Makeup enrolments due to the temporary nature of both enrolment types.</p>'" dmx-bind:popover-title="'Makeup/Casual Availabilities'" data-bs-html="true" data-bs-trigger="hover"></i>
                                                        </p>
                                                        <p class="text-center mb-0" dmx-repeat:rp_makeupavail_disp="details.makeup_availabilities" dmx-hide="details.makeup_response.code !== 100" dmx-html="'<strong>'+availabilities+'</strong> spots - '+date.formatDate('dd MMM')"><b>4</b> spots - 21 Nov</p>
                                                        <p class="text-center mb-0 fst-italic fw-450" dmx-show="details.makeup_response.code !== 100" dmx-text="details.makeup_response.response">Too far in future.</p>


                                                    </div>

                                                    <div class="col align-self-center">
                                                        <p class="text-end mb-0 text-muted">Availability</p>
                                                        <p class="text-end mb-0" dmx-show="details.total != max" dmx-html="'<strong>'+(max - details.total)+'</strong> / '+max+' max.'">4/4</p>
                                                        <p class="text-end mb-0 fw-bold text-danger" dmx-show="details.total == max">FULL</p>
                                                        <p class="text-end mb-0" dmx-show="details.total == max" dmx-text="(details.active !== 0 &amp;&amp; details.active) ? 'Next Open: '+details.active.formatDate('dd MMM yyyy') : 'No availabilities.'">OPENING ON:&nbsp;</p>
                                                        <p class="text-end mb-0 fw-bold text-danger" dmx-show="details.total > max">OVERBOOKED</p>
                                                    </div>
                                                </div>
                                                <div class="border-top-0 border-bottom-0">
                                                    <div class="collapse" id="enrolmentsCollapse" is="dmx-bs5-collapse" dmx-bind:id="enrolmentsCollapse_{{$index}}" show="true">
                                                        <dmx-value id="var_classid" dmx-bind:value="uuid"></dmx-value>
                                                        <div class="row g-0 d-flex flex-column pb-4  pt-2 mt-2 border-top">
                                                            <div class="col-auto">

                                                                <div class="row gx-2 my-2 pb-3 border-bottom">
                                                                    <div class="col d-flex justify-content-end">
                                                                        <div class="dropdown">
                                                                            <button id="dd_modifyclass" class="btn btn-secondary dropdown-toggle btn-sm change-chevron" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Modify<i class="bi-chevron-down ms-2 small"></i></button>
                                                                            <div class="dropdown-menu" aria-labelledby="dd_modifyclass">
                                                                                <a class="dropdown-item small border-bottom" href="#" dmx-on:click="run([{run:{action:`editClassModal.var_classDetails.setValue($value);editClassModal.sc_classdetails.load({uuid: uuid})`}},{wait:{delay:200}},{run:{action:`editClassModal.show()`}}])"><i class="fas fa-pen me-2"></i>Edit Class</a>
                                                                                <a class="dropdown-item text-danger small" href="#"><i class="bi-slash-circle-fill me-2"></i>Cancel Class</a>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div><button id="btn_newEnrolment" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-active-outline btn-sm icon-hover-white" dmx-on:click="run([{assign:{value:`!details.nextavailable_permanent ? false : true`,name:'var_availabilities'}},{assign:{value:`waitlists.length>0`,name:'var_waitlists'}},{assign:{value:`true`,name:'var_continue'}},{condition:{if:`var_availabilities===false`,then:{steps:[{assign:{value:'<p>This class is currently overbooked.<br> Are you sure you want to continue?</p>',name:'var_overbook_message'}},{runJS:{function:'swal_confirm',args:['warning','OVERBOOKING WARNING',`true`,'Cancel',`false`,'','OVERBOOK',`false`,`false`,`var_overbook_message`],name:'overbook_confirm'}},{condition:{if:`overbook_confirm === false`,then:{steps:{assign:{value:`false`,name:'var_continue'}}}}}]}}},{condition:{if:`var_waitlists===true&amp;&amp;var_continue===true`,then:{steps:[{assign:{value:'<p>This class has waitlisted students.<br> Are you sure you want to enrol ahead of the waitlists?</p>',name:'var_waitlist_message'}},{runJS:{function:'swal_confirm',args:['warning','Waitlists Active',`true`,'Cancel',`false`,'','Continue Anyway',`false`,`false`,`var_waitlist_message`],name:'waitlist_confirm'}},{condition:{if:`waitlist_confirm === false`,then:{steps:{assign:{value:`false`,name:'var_continue'}}}}}]}}},{condition:{if:`var_continue === true`,then:{steps:[{condition:{if:`var_availabilities===false`,then:{steps:{run:{action:`enrolmentSearchModal.makeup_enroltype_toggle.disable(true);enrolmentSearchModal.casual_enroltype_toggle.disable(true)`}}}}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'active\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value);enrolmentSearchModal.var_newenrol_startdate.setValue(details.nextavailable_permanent||dateAndTime_days.datetime.formatDate(\'yyyy-MM-dd\'))`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}])"><i class="fas fa-check-circle me-2 text-active-light"></i>New Active</button>
                                                                <button id="btn_trialEnrolment" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-trial-outline btn-sm icon-hover-white" dmx-on:click="run([{assign:{value:`!details.nextavailable_permanent ? false : true`,name:'var_availabilities'}},{assign:{value:`waitlists.length>0`,name:'var_waitlists'}},{assign:{value:`true`,name:'var_continue'}},{condition:{if:`var_availabilities===false`,then:{steps:[{assign:{value:'<p>This class is currently overbooked.<br> Are you sure you want to continue?</p>',name:'var_overbook_message'}},{runJS:{function:'swal_confirm',args:['warning','OVERBOOKING WARNING',`true`,'Cancel',`false`,'','OVERBOOK',`false`,`false`,`var_overbook_message`],name:'overbook_confirm'}},{condition:{if:`overbook_confirm === false`,then:{steps:{assign:{value:`false`,name:'var_continue'}}}}}]}}},{condition:{if:`var_waitlists===true&amp;&amp;var_continue===true`,then:{steps:[{assign:{value:'<p>This class has waitlisted students.<br> Are you sure you want to enrol ahead of the waitlists?</p>',name:'var_waitlist_message'}},{runJS:{function:'swal_confirm',args:['warning','Waitlists Active',`true`,'Cancel',`false`,'','Continue Anyway',`false`,`false`,`var_waitlist_message`],name:'waitlist_confirm'}},{condition:{if:`waitlist_confirm === false`,then:{steps:{assign:{value:`false`,name:'var_continue'}}}}}]}}},{condition:{if:`var_continue === true`,then:{steps:[{condition:{if:`var_availabilities===false`,then:{steps:{run:{action:`enrolmentSearchModal.makeup_enroltype_toggle.disable(true);enrolmentSearchModal.casual_enroltype_toggle.disable(true)`}}}}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'trial\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}])"><i class="fas fa-question-circle me-2 text-trial-light"></i>New Trial</button>
                                                                <button id="btn_newMakeup" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-makeup-outline btn-sm" dmx-on:click="run({condition:{if:`details.makeup.length===0`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no makeup availabilities for this class in the future. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'makeup\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'makeup\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}})" dmx-bind:disabled="details.makeup_response.code === 101 || details.makeup_response.code === 102"><i class="fas fa-arrow-alt-circle-up me-2"></i>New Makeup</button>
                                                                <button id="btn_newCasual" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-casual-outline btn-sm" dmx-on:click="run({condition:{if:`details.makeup.length === 1`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for casual enrolments this class. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'casual\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}}},else:{steps:[{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'casual\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}]}}})" dmx-bind:disabled="details.makeup_response.code === 101 || details.makeup_response.code === 102"><i class="fas fa-bookmark me-2"></i>New Casual</button>
                                                                <button id="btn_newWaitlist" dmx-bind:id="btn_newEnrolment_{{$index}}" class="btn btn-sm btn-waitlist-outline" dmx-on:click="run([{condition:{if:`!details.nextavailable_permanent`,then:{steps:{run:{action:`enrolmentSearchModal.active_enroltype_toggle.disable(true);enrolmentSearchModal.trial_enroltype_toggle.disable(true);enrolmentSearchModal.makeup_enroltype_toggle.disable(true);enrolmentSearchModal.casual_enroltype_toggle.disable(true)`}}}}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.var_enroltype.setValue(\'waitlist\')`}},{run:{action:`enrolmentSearchModal.dd_classdetails_searchenrol.select(var_classid.value)`}},{run:{action:`enrolmentSearchModal.show()`}}])">
                                                                    <i class="fas fa-history me-2"></i>New Waitlist
                                                                </button>
                                                                <div class="row" dmx-hide="details.makeup_response.code === 100">
                                                                    <div class="col mt-2 fw-500">
                                                                        <p class="fst-italic small text-muted mb-0" dmx-show="details.makeup_response.code === 101">New Makeup and New Casual enrolment buttons have been disabled to prevent overbooking.</p>
                                                                        <p class="fst-italic small text-muted mb-0" dmx-show="details.makeup_response.code === 102">New Makeup and New Casual enrolment buttons have been disabled because your dates are too far into the future.</p>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col">


                                                                <div class="row row-cols-1 g-2 gy-3 mt-3 align-items-stretch">
                                                                    <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.active_enrols.length > 0">
                                                                        <div class="row g-0 w-100">
                                                                            <div class="col">
                                                                                <div class="card">
                                                                                    <div class="card-header text-white bg-active">
                                                                                        <p class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-6 fas fa-check-circle me-2 text-white fa-fw"></i>Active Enrolments
                                                                                        </p>
                                                                                    </div>
                                                                                    <div class="card-body pt-2">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table mb-0 table-small">
                                                                                                <thead class="border-bottom text-black-50 small">
                                                                                                    <tr class="border-0 fw-500">
                                                                                                        <th scope="row" class="border-0 tc_td_min"></th>
                                                                                                        <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                        <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                        <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.active_enrols" id="activeEnrolmentsTableRepeat1">
                                                                                                    <tr>
                                                                                                        <td style="width: 1%; white-space: nowrap; padding-right: 1rem;" class="tc_td_min align-middle">
                                                                                                            <div class="dropdown no-caret">
                                                                                                                <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown2" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown">
                                                                                                                    <i class="fas fa-chevron-down text-muted fa-sm"></i>
                                                                                                                </button>
                                                                                                                <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({uuid: uuid, enrolment_uuid: enrolment_uuid});editEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-pencil"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Edit Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({uuid: uuid, enrolment_uuid: enrolment_uuid});dropEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-arrow-down-circle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Drop Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({uuid: uuid, enrolment_uuid: enrolment_uuid});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-shuffle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                Transfer Enrolment
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-people"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </td>
                                                                                                        <td class="align-middle" dmx-text="firstName +' '+lastName" style="padding-left: 20px !important;"></td>
                                                                                                        <td dmx-text="startDate.formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                                        <td dmx-text="dropDate.formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                                    </tr>
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col border rounded-3 p-3 visually-hidden">

                                                                                <header class="pt-2 pb-2 mb-2 border-bottom">

                                                                                    <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-check-circle me-2 text-active-light fa-fw"></i>Active Enrolments
                                                                                    </h6>
                                                                                </header>


                                                                                <div class="table-responsive">
                                                                                    <table class="table mb-0 table-small table-sm small">
                                                                                        <thead class="border-bottom">
                                                                                            <tr class="border-0 small fw-bold">
                                                                                                <th scope="row" class="border-0 tc_td_min"></th>
                                                                                                <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.active_enrols" id="activeEnrolmentsTableRepeat">
                                                                                            <tr>
                                                                                                <td style="width: 1%; white-space: nowrap; padding-right: 1rem;" class="tc_td_min align-middle">
                                                                                                    <div class="dropdown no-caret">
                                                                                                        <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown">
                                                                                                            <i class="fas fa-ellipsis-v text-muted"></i>
                                                                                                        </button>
                                                                                                        <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({uuid: uuid});editEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-pencil"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Edit Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-arrow-down-circle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Drop Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-shuffle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        Transfer Enrolment
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-people"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </td>
                                                                                                <td class="align-middle" dmx-text="firstName +' '+lastName" style="padding-left: 20px !important;"></td>
                                                                                                <td dmx-text="startDate.formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                                <td dmx-text="dropDate.formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.trial_enrols.length > 0">
                                                                        <div class="row g-0 w-100">
                                                                            <div class="col">
                                                                                <div class="card">
                                                                                    <div class="card-header bg-trial border-0">
                                                                                        <p class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-6 fas fa-question-circle me-2 fa-fw text-white" style="color: #f90;"></i>Trial Enrolments
                                                                                        </p>
                                                                                    </div>
                                                                                    <div class="card-body pt-2">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table mb-0">
                                                                                                <thead class="border-bottom text-black-50 small">
                                                                                                    <tr class="border-0 fw-500">
                                                                                                        <th scope="row" class="border-0  tc_td_min"></th>
                                                                                                        <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                        <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                        <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.trial_enrols" id="trialEnrolmentsTableRepeat">
                                                                                                    <tr>
                                                                                                        <td class="tc_td_min">
                                                                                                            <div class="dropdown no-caret">
                                                                                                                <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                                <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                                    <a class="dropdown-item border-bottom bg-primary text-white" href="#">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-stars"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                Upgrade to Active
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>

                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-pencil"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Edit Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>

                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-arrow-down-circle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Drop Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-shuffle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                Transfer Enrolment
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-people"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <!-- <button id="btn_trEnr_details" dmx-bind:id="btn_trEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                            dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap"></i></button>
                                                                        <button id="btn_trEnr_drop" dmx-bind:id="btn_trEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down"></i></button>
                                                                        <button id="btn_trEnr_transfer" dmx-bind:id="btn_trEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random"></i></button> -->
                                                                                                        </td>
                                                                                                        <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                        <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                                        <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                                    </tr>
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col border rounded-3 p-3 visually-hidden">
                                                                                <header class="pt-2 pb-2 mb-2 border-bottom ">
                                                                                    <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-question-circle me-2 fa-fw" style="color: #f90;"></i>Trial Enrolments
                                                                                    </h6>

                                                                                </header>

                                                                                <div class="table-responsive small">
                                                                                    <table class="table mb-0 table-small table-sm">
                                                                                        <thead class="border-bottom">
                                                                                            <tr class="border-0 small fw-bold">
                                                                                                <th scope="row" class="border-0  tc_td_min"></th>
                                                                                                <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.trial_enrols" id="trialEnrolmentsTableRepeat">
                                                                                            <tr>
                                                                                                <td class="tc_td_min">
                                                                                                    <div class="dropdown no-caret">
                                                                                                        <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                        <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                            <a class="dropdown-item border-bottom bg-primary text-white" href="#">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-stars"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        Upgrade to Active
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>

                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-pencil"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Edit Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-arrow-down-circle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Drop Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-shuffle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        Transfer Enrolment
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-people"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <!-- <button id="btn_trEnr_details" dmx-bind:id="btn_trEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap"></i></button>
                                                                    <button id="btn_trEnr_drop" dmx-bind:id="btn_trEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down"></i></button>
                                                                    <button id="btn_trEnr_transfer" dmx-bind:id="btn_trEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random"></i></button> -->
                                                                                                </td>
                                                                                                <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;"></td>
                                                                                                <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class="align-middle"></td>
                                                                                                <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>


                                                                            </div>

                                                                        </div>
                                                                    </div>
                                                                    <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.makeup_enrols.length > 0">
                                                                        <div class="row g-0 w-100">
                                                                            <div class="col">
                                                                                <div class="card">
                                                                                    <div class="card-header bg-makeup">
                                                                                        <p class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-6 fas fa-arrow-alt-circle-up me-2 fa-fw text-white" style="color: #319bfa;"></i>Makeup Enrolments
                                                                                        </p>
                                                                                    </div>
                                                                                    <div class="card-body pt-2">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table mb-0">
                                                                                                <thead class="border-bottom text-black-50 small">
                                                                                                    <tr class="border-0 fw-500">
                                                                                                        <th scope="row" class="border-0 fw-light  tc_td_min"></th>
                                                                                                        <th class="border-0" style="padding-left: 20px !important; width: 25%;">Student</th>
                                                                                                        <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                        <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.makeup_enrols" id="makeupEnrolmentsTableRepeat1">
                                                                                                    <tr>
                                                                                                        <td class=" tc_td_min align-middle">
                                                                                                            <div class="dropdown no-caret">
                                                                                                                <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown3" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                                <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-pencil"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Edit Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-arrow-down-circle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Drop Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-shuffle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                Transfer Enrolment
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-people"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <!-- <button id="btn_muEnr_details" dmx-bind:id="btn_muEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_muEnr_drop" dmx-bind:id="btn_muEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_muEnr_transfer" dmx-bind:id="btn_muEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                                        </td>
                                                                                                        <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                        <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                                        <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                                    </tr>
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col p-3 border rounded-3 visually-hidden">
                                                                                <header class="pt-2 pb-2 mb-2 border-bottom">
                                                                                    <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-arrow-alt-circle-up me-2 fa-fw" style="color: #319bfa;"></i>Makeup Enrolments
                                                                                    </h6>

                                                                                </header>

                                                                                <div class="table-responsive small">
                                                                                    <table class="table mb-0 table-small">
                                                                                        <thead class="border-bottom">
                                                                                            <tr class="border-0 small fw-bold">
                                                                                                <th scope="row" class="border-0 fw-light  tc_td_min"></th>
                                                                                                <th class="border-0" style="padding-left: 20px !important; width: 25%;">Student</th>
                                                                                                <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.makeup_enrols" id="makeupEnrolmentsTableRepeat">
                                                                                            <tr>
                                                                                                <td class=" tc_td_min align-middle">
                                                                                                    <div class="dropdown no-caret">
                                                                                                        <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                        <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-pencil"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Edit Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-arrow-down-circle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Drop Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-shuffle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        Transfer Enrolment
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-people"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <!-- <button id="btn_muEnr_details" dmx-bind:id="btn_muEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_muEnr_drop" dmx-bind:id="btn_muEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_muEnr_transfer" dmx-bind:id="btn_muEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                                </td>
                                                                                                <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                                <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>


                                                                            </div>


                                                                        </div>

                                                                    </div>
                                                                    <div class="col d-flex align-items-stretch" dmx-show="details.enrolments.casual_enrols.length > 0">
                                                                        <div class="row g-0 w-100">
                                                                            <div class="col">
                                                                                <div class="card">
                                                                                    <div class="card-header bg-casual">
                                                                                        <p class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-6 fas fa-bookmark me-2 text-white fa-fw" style="color: #000;"></i>Casual</p>
                                                                                    </div>
                                                                                    <div class="card-body pt-2">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table mb-0">
                                                                                                <thead class="border-bottom text-black-50 small">
                                                                                                    <tr class="fw-500">
                                                                                                        <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                                        <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                        <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                        <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.casual_enrols" id="casualTableRepeat">
                                                                                                    <tr>
                                                                                                        <td class=" tc_td_min align-middle">
                                                                                                            <div class="dropdown no-caret">
                                                                                                                <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown1" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                                <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-pencil"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Edit Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-arrow-down-circle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Drop Enrolment</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-shuffle"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                Transfer Enrolment
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-people"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                                        </td>
                                                                                                        <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                        <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                                        <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                                    </tr>
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col p-3 border rounded-3 visually-hidden">
                                                                                <header class="pt-2 pb-2 mb-2 border-bottom">

                                                                                    <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-bookmark me-2 text-primary fa-fw" style="color: #000;"></i>Casual</h6>
                                                                                </header>


                                                                                <div class="table-responsive small">
                                                                                    <table class="table mb-0 table-small">
                                                                                        <thead class="border-bottom">
                                                                                            <tr class="small fw-bold">
                                                                                                <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                                <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                <th class="border-0" style="width: 15%;">Start date</th>
                                                                                                <th class="border-0" style="width: 15%;">Drop date</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="details.enrolments.casual_enrols" id="casualTableRepeat">
                                                                                            <tr>
                                                                                                <td class=" tc_td_min align-middle">
                                                                                                    <div class="dropdown no-caret">
                                                                                                        <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown1" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                        <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-pencil"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Edit Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});dropEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-arrow-down-circle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Drop Enrolment</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});transferEnrolmentModal.show()" dmx-class:border-bottom="student.family != '' || student.family != null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-shuffle"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        Transfer Enrolment
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-people"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                                </td>
                                                                                                <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                <td dmx-text="startDate.toDate().formatDate('dd MMM yyyy')" dmx-class:fw-bold="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" dmx-class:fst-italic="(startDate.toTimestamp() > dr_endDate.value.toTimestamp())" class=" align-middle"></td>
                                                                                                <td dmx-text="dropDate.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </div>

                                                                        </div>
                                                                    </div>


                                                                </div>
                                                                <div class="row mt-3">
                                                                    <div class="col-12" dmx-show="waitlists.length > 0">
                                                                        <div class="row g-0 w-100">
                                                                            <div class="col">
                                                                                <div class="card">
                                                                                    <div class="card-header bg-waitlist">
                                                                                        <p class="mb-0 d-flex align-items-center text-white fw-350 lh-1"><i class="fs-6 fas fa-history me-2 fa-fw text-white" style="color: #000;"></i>Waitlisted
                                                                                        </p>
                                                                                    </div>
                                                                                    <div class="card-body pt-2">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table mb-0">
                                                                                                <thead class="border-bottom small">
                                                                                                    <tr class="fw-500 text-black-50">
                                                                                                        <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                                        <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                        <th class="border-0" style="width: 15%;">Request Date</th>
                                                                                                        <th class="border-0" style="width: 15%;">Notes</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="waitlists" id="waitlistedTableRepeat">
                                                                                                    <tr>
                                                                                                        <td class=" tc_td_min align-middle">
                                                                                                            <div class="dropdown no-caret">
                                                                                                                <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                                <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                                    <a class="dropdown-item border-bottom bg-primary text-white" href="#" dmx-on:click="run({condition:{if:`details.active == 0`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate(\'yyyy-MM-dd\')`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]},name:'Overbooking'}}},else:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate('yyyy-MM-dd'))`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]}}})">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-stars"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                Upgrade to Active
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a><a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-pencil"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Edit Waitlist</p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item border-bottom" href="#" dmx-on:click="run({'bootbox.confirm':{buttons:{confirm:{label:'Delete Waitlist',className:'btn-danger'},cancel:{}},message:`\'Are you sure you want to delete \'+firstName +\' \'+lastName+\'\\\'s waitlist entry? Deleted waitlists are unrecoverable.\'`,title:'Are you sure?',then:{steps:{run:{action:`form_deleteWaitlist.submit()`}}}}})">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-slash-circle-fill text-danger"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">

                                                                                                                                <p class="mb-0">Cancel Waitlist</p>
                                                                                                                                <form id="form_deleteWaitlist" is="dmx-serverconnect-form" action="/api/classes/waitlist/deleteWaitlist" method="post" dmx-on:success="run([{run:{action:`notifies1.success(\'Waitlist deleted.\')`}},{wait:{delay:500}},{run:{action:`classesBase.load()`}}])">
                                                                                                                                    <input id="inp_delWait_id" name="id" type="hidden" class="form-control" dmx-bind:value="id">
                                                                                                                                </form>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                    <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                        <div class="row flex-nowrap">
                                                                                                                            <div class="col-1">
                                                                                                                                <i class="bi-people"></i>
                                                                                                                            </div>
                                                                                                                            <div class="col-auto">
                                                                                                                                <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </a>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                                                                                            dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                                                                                        <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                                                                                        <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                                        </td>
                                                                                                        <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                        <td dmx-text="request_date.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                                        <td dmx-text="notes" class=" align-middle"></td>
                                                                                                    </tr>
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col p-3 border rounded-3 visually-hidden">
                                                                                <header class="pt-2 pb-2 mb-2 border-bottom">
                                                                                    <h6 class="mb-0 d-flex align-items-center"><i class="fs-5 fas fa-history me-2 fa-fw" style="color: #000;"></i>Waitlisted
                                                                                    </h6>


                                                                                </header>


                                                                                <div class="table-responsive small">
                                                                                    <table class="table mb-0 table-small">
                                                                                        <thead class="border-bottom">
                                                                                            <tr class="small fw-bold">
                                                                                                <th scope="row" class="border-0 fw-light tc_td_min"></th>
                                                                                                <th class="border-0" style="width: 25%; padding-left: 20px !important;">Student</th>
                                                                                                <th class="border-0" style="width: 15%;">Request Date</th>
                                                                                                <th class="border-0" style="width: 15%;">Notes</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="waitlists" id="waitlistedTableRepeat">
                                                                                            <tr>
                                                                                                <td class=" tc_td_min align-middle">
                                                                                                    <div class="dropdown no-caret">
                                                                                                        <button dmx-bind:id="enrolmentDropdown_{{id}}" id="dropdown" class="btn dropdown-toggle no-caret btn-sm btn-outline-light" type="button" aria-haspopup="true" aria-expanded="false" data-bs-toggle="dropdown"><i class="fas fa-ellipsis-v text-muted"></i></button>
                                                                                                        <div class="dropdown-menu shadow-light rounded-small" aria-labelledby="dropdown2">
                                                                                                            <a class="dropdown-item border-bottom bg-primary text-white" href="#" dmx-on:click="run({condition:{if:`details.active == 0`,then:{steps:{'bootbox.confirm':{buttons:{confirm:{label:'OVERBOOK',className:'btn-danger'},cancel:{label:'Cancel'}},message:'There are no availabilities for this class in the future. Would you like to overbook this class?',title:'Overbook Warning',then:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate(\'yyyy-MM-dd\')`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]},name:'Overbooking'}}},else:{steps:[{run:{action:`upgradeWaitlistModal.dd_uw_classDetails.select(var_classid.value)`}},{run:{action:`upgradeWaitlistModal.dd_uw_waitlistDetails.select(id)`}},{run:{action:`upgradeWaitlistModal.form_upgradeWaitlist.var_uw_details.setValue(details.active.formatDate('yyyy-MM-dd'))`}},{run:{action:`upgradeWaitlistModal.var_uw_studentDetailsObject.setValue($value)`}},{run:{action:`upgradeWaitlistModal.show()`}}]}}})">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-stars"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        Upgrade to Active
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a><a class="dropdown-item border-bottom" href="javascript:void(0);" dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-pencil"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Edit Waitlist</p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item border-bottom" href="#" dmx-on:click="run({'bootbox.confirm':{buttons:{confirm:{label:'Delete Waitlist',className:'btn-danger'},cancel:{}},message:`\'Are you sure you want to delete \'+firstName +\' \'+lastName+\'\\\'s waitlist entry? Deleted waitlists are unrecoverable.\'`,title:'Are you sure?',then:{steps:{run:{action:`form_deleteWaitlist.submit()`}}}}})">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-slash-circle-fill text-danger"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">

                                                                                                                        <p class="mb-0">Cancel Waitlist</p>
                                                                                                                        <form id="form_deleteWaitlist" is="dmx-serverconnect-form" action="/api/classes/waitlist/deleteWaitlist" method="post" dmx-on:success="run([{run:{action:`notifies1.success(\'Waitlist deleted.\')`}},{wait:{delay:500}},{run:{action:`classesBase.load()`}}])">
                                                                                                                            <input id="inp_delWait_id" name="id" type="hidden" class="form-control" dmx-bind:value="id">
                                                                                                                        </form>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                            <a class="dropdown-item" target="_blank" dmx-bind:href="'/families/familydetail/'+family" dmx-hide="family == '' || family == null">
                                                                                                                <div class="row flex-nowrap">
                                                                                                                    <div class="col-1">
                                                                                                                        <i class="bi-people"></i>
                                                                                                                    </div>
                                                                                                                    <div class="col-auto">
                                                                                                                        <p class="mb-0">Go to Family<i class="bi-box-arrow-up-right ms-2 small"></i></p>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </a>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <!-- <button id="btn_waEnr_details" dmx-bind:id="btn_waEnr_details_{{id}}_{{$index}}" class="btn btn-light circle-button-small"
                                                                        dmx-on:click="GET_ENROLMENT_single.load({enrolmentid: id});editEnrolmentModal.show()"><i class="fas fa-graduation-cap fa-fw"></i></button>
                                                                    <button id="btn_waEnr_drop" dmx-bind:id="btn_waEnr_drop_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-arrow-alt-circle-down fa-fw"></i></button>
                                                                    <button id="btn_waEnr_transfer" dmx-bind:id="btn_waEnr_transfer_{{id}}_{{$index}}" class="btn btn-light circle-button-small"><i class="fas fa-random fa-fw"></i></button> -->
                                                                                                </td>
                                                                                                <td dmx-text="firstName +' '+lastName" class=" align-middle" style="padding-left: 20px !important;: ;"></td>
                                                                                                <td dmx-text="request_date.toDate().formatDate('dd MMM yyyy')" class=" align-middle"></td>
                                                                                                <td dmx-text="notes" class=" align-middle"></td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </div>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row row-cols-1 gy-2" dmx-show="details.total == 0 &amp;&amp; !waitlists">
                                                                    <div class="col py-5">
                                                                        <h5 class="text-center fw-300 m-0 text-body">
                                                                            This class has no enrolments or waitlists.</h5>
                                                                        <p class="text-center mb-0">Add an enrolment above.</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="rp_classlist_placeholder_wrapper" class="row row-cols-1 g-0 placeholder-glow" is="dmx-repeat" dmx-bind:repeat="var_classlist_count.value||10" dmx-animate-leave.duration:1000.delay:50="fadeOut" dmx-animate-enter.duration:1000.delay:50="fadeIn" dmx-show="classesBase.state.processing||classesBase.status!==200">
                                    <div class="col" id="cr_classlistplaceholder">
                                        <div class="row row-cols-1 g-0">
                                            <div class="col class-card border rounded-3 bg-white postition-relative mb-2 py-3 px-3 placeholder">
                                                <div class="row row-cols-8 clickable g-0" dmx-on:click="enrolmentsCollapse.toggle()">

                                                    <div class="align-self-center col class-info d-flex flex-column justify-content-start align-items-start">
                                                        <p class="fw-550 fs-6 mb-1 placeholder">Duckling</p>
                                                        <p class="mb-1 placeholder">Monday 27th Febraury</p>
                                                        <p class="mb-0 placeholder">Week Date</p>
                                                    </div>
                                                    <div class="align-self-center col">
                                                        <p class="mb-0 text-start placeholder">Instructor</p>
                                                    </div>

                                                    <div class="col align-self-center">
                                                        <div class="row row-cols-2 w-100 gx-2 gy-1" dmx-hide="details.total === 0" style="white-space: nowrap;">
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center placeholder">
                                                                <p class="mb-0">0 Act.</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center placeholder">
                                                                <p class="mb-0">0 M/Ups</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center placeholder">
                                                                <p class="mb-0">0 Trials</p>
                                                            </div>
                                                            <div class="col align-self-center d-flex justify-content-start align-items-center placeholder">

                                                                <p class="mb-0">0 Wait</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col align-self-center d-flex flex-column justify-content-center align-items-end">
                                                        <p class="text-center mb-1 text-muted placeholder">Makeup/Casual
                                                            <i class="fas fa-question-circle-fill ms-1"></i>
                                                        </p>
                                                        <p class="text-center mb-0 placeholder"><b>4</b> spots - 21 Nov</p>
                                                    </div>

                                                    <div class="col align-self-center d-flex flex-column justify-content-end align-items-end">
                                                        <p class="text-end mb-0 text-muted placeholder mb-1">Availability</p>
                                                        <p class="text-end mb-0 placeholder mb-1">4/4</p>
                                                        <p class="text-end mb-0 placeholder">OPENING ON:&nbsp;</p>
                                                    </div>
                                                </div>
                                                <div class="border-top-0 border-bottom-0">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col">



                                <div class="row g-0" dmx-hide="toggle_classes_loading.checked" id="cr_classes_content">
                                    <div class="col">
                                        <div class="table-responsive">
                                            <table class="table table-hover align-middle bg-white table-bordered" style="">
                                                <thead class="pdl-main-bg">
                                                    <tr class="fw-bold align-middle">

                                                        <th rowspan="2" class="text-center">Class Date</th>
                                                        <th rowspan="2" class="text-center collapse-cell">Level</th>
                                                        <th rowspan="2" class="text-center">Day</th>
                                                        <th rowspan="2" class="text-center">Schedule</th>


                                                        <th rowspan="2" class="text-center">Instructor</th>
                                                        <th rowspan="2" class="text-center">Enrolments</th>
                                                        <th colspan="2" class="text-center">Availabilities</th>

                                                    </tr>
                                                    <tr class="fw-450 fst-italic small">
                                                        <th class="text-center fw-500">Next Permanent</th>
                                                        <th class="text-center fw-500">Temporary</th>
                                                    </tr>
                                                </thead>
                                                <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="classesBase.data.nextavail.classes" id="rp_classes_table" dmx-hide="classesBase.data.nextavail.classes.length===0">
                                                    <tr class="clickable" dmx-on:click="run({run:{action:`classDetailsModal.sc_GET_CLASS_details.load({uuid: uuid});classDetailsModal.show();classDetailsModal.dd_classdetails.select(uuid)`}})">

                                                        <td class="text-nowrap text-center" dmx-html="'<i class=&quot;far fa-calendar-alt me-1 fa-fw&quot;></i>' + details.weekday.formatDate(appSettings.localization_puddle_dateformat)">
                                                            <i class="far fa-calendar-alt me-1 fa-fw"></i><span dmx-text="details.weekday.formatDate(appSettings.localization_puddle_dateformat)">20/07/2022</span>
                                                        </td>
                                                        <!-- <td class="collapse-cell border-end-0">
                                                                                <div class="d-block circle position-relative mx-2" dmx-style:background-color="'#'+appSettings.classLevelsByID[classlevel_uuid].colour">
                                                                                    <p class="d-flex m-0 position-absolute w-100 h-100 align-items-center justify-content-center small fw-700" dmx-style:color.important="'#'+appSettings.classLevelsByID[classlevel_uuid].textcolour" dmx-text="appSettings.classLevelsByID[classlevel_uuid].name.substr(0, 1)" style="line-height: 0;">F</p>
                                                                                </div>
                                                                            </td> -->
                                                        <td class="d-flex align-items-center text-nowrap fw-900 border-0 ps-3">
                                                            <div class="d-block circle position-relative m-1 me-3" dmx-style:background-color="'#'+appSettings.classLevelsByID[classlevel_uuid].colour">
                                                                <p class="d-flex m-0 position-absolute w-100 h-100 align-items-center justify-content-center small fw-700" dmx-style:color.important="'#'+appSettings.classLevelsByID[classlevel_uuid].textcolour" dmx-text="appSettings.classLevelsByID[classlevel_uuid].name.substr(0, 1)" style="line-height: 0;">F</p>
                                                            </div>
                                                            <span class="me-3" dmx-text="appSettings.classLevelsByID[classlevel_uuid].name"></span>
                                                        </td>

                                                        <td dmx-text="appSettings.days_array[classday]" class="text-center"></td>
                                                        <td class="text-nowrap text-center position-relative">
                                                            <div class="d-flex align-items-center justify-content-center">
                                                                <i class="fas pdl-clock me-2" dmx-show="isrunning"></i>
                                                                <span dmx-html="startTimeDisplay.lowercase().replace(' am','').replace(' pm','')+ ' - ' + endTimeDisplay.lowercase().replace(' ','')">11:00 - 11:30AM</span>
                                                            </div>
                                                        </td>


                                                        <td dmx-text="appSettings.instructorsById[instructor_uuid].trunc_name" class="text-nowrap text-center"></td>
                                                        <td dmx-html="'<strong>'+details.total+'</strong> / '+max" class="text-center"></td>
                                                        <td class="text-center">
                                                            <span dmx-hide="details.nextavailable_permanent == false" dmx-text="(details.nextavailable_permanent !== false &amp;&amp; details.outofrange === false) ? details.nextavailable_permanent.formatDate(appSettings.localization_puddle_dateformat) : ''">Next Open:</span>
                                                            <span class="text-end mb-0 fw-bold text-danger" dmx-show="details.total==max&amp;&amp;details.nextavailable_permanent==false&amp;&amp;details.outofrange===false">FULL</span>
                                                            <span class="text-end mb-0 fw-bold text-danger" dmx-show="details.total>max&amp;&amp;details.outofrange===false">OVERBOOKED</span>
                                                            <span class="mb-0 fst-italic fw-450 small" dmx-show="details.outofrange">Too far in future.</span>
                                                        </td>
                                                        <td class="text-nowrap text-center">
                                                            <p class="mb-0" dmx-repeat:rp_makeupavail_disp="details.makeup_availabilities" dmx-hide="details.makeup_response.code !== 100" dmx-html="'<strong>'+availabilities+' Avail.</strong> - '+date.formatDate('dd MMM')"><b>4</b> spots - 21 Nov</p>
                                                            <span class="text-end mb-0 fw-bold text-danger" dmx-show="details.makeup_response.code !== 100" dmx-text="details.makeup_response.response">Too far in future.</span>
                                                        </td>

                                                    </tr>

                                                </tbody>
                                                <tbody dmx-show="classesBase.data.nextavail.classes.length===0">
                                                    <tr>
                                                        <td colspan="9" class="text-center p-4">No classes were found. Please adjust your filters and try again.</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>

                                    </div>

                                </div>
                                <div class="row" id="cr_classes_loading_spinner" dmx-show="toggle_classes_loading.checked">
                                    <div class="col d-flex justify-content-center flex-column align-items-center">
                                        <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                                        </div>
                                        <p class="my-3">Loading Classes...</p>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <dmx-value id="var_classlist_count"></dmx-value>



                    </div>


                </div>
            </section>








        </div>
    </div>

</main>