<!doctype html>
<html>

<head>
    <script src="/dmxAppConnect/dmxAppConnect.js"></script>
    <base href="/">
    <meta charset="UTF-8">

    <title>Untitled Document</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="/dmxAppConnect/dmxBootstrap5Navigation/dmxBootstrap5Navigation.js" defer=""></script>
    <script src="/dmxAppConnect/dmxRouting/dmxRouting.js" defer=""></script>
    <script src="/dmxAppConnect/dmxStateManagement/dmxStateManagement.js" defer=""></script>
    <script src="/dmxAppConnect/dmxDataTraversal/dmxDataTraversal.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxDropzone/dmxDropzone.css" />
    <script src="/dmxAppConnect/dmxDropzone/dmxDropzone.js" defer=""></script>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/backgrounds.css">
    <link rel="stylesheet" href="css/icons.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc" crossorigin="anonymous" />
    <link rel="stylesheet" href="/dmxAppConnect/dmxBootstrap5TableGenerator/dmxBootstrap5TableGenerator.css" />
    <script src="/dmxAppConnect/dmxFormatter/dmxFormatter.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBrowser/dmxBrowser.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxPreloader/dmxPreloader.css" />
    <script src="/dmxAppConnect/dmxPreloader/dmxPreloader.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootstrap5PagingGenerator/dmxBootstrap5PagingGenerator.js" defer=""></script>
    <script src="/dmxAppConnect/dmxDatastore/dmxDatastore.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootstrap5Modal/dmxBootstrap5Modal.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootstrap5Collapse/dmxBootstrap5Collapse.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxValidator/dmxValidator.css" />
    <script src="/dmxAppConnect/dmxValidator/dmxValidator.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxAutocomplete/dmxAutocomplete.css" />
    <script src="/dmxAppConnect/dmxAutocomplete/dmxAutocomplete.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootbox/bootbox.all.min.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootbox/dmxBootbox.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxDatePicker/daterangepicker.min.css" />
    <script src="/dmxAppConnect/dmxDatePicker/daterangepicker.min.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxDatePicker/dmxDatePicker.css" />
    <script src="/dmxAppConnect/dmxDatePicker/dmxDatePicker.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootstrap5Tooltips/dmxBootstrap5Tooltips.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootstrap5Alert/dmxBootstrap5Alert.js" defer=""></script>

    <link rel="stylesheet" href="/dmxAppConnect/dmxAnimateCSS/animate.min.css" />
    <script src="/dmxAppConnect/dmxAnimateCSS/dmxAnimateCSS.js" defer=""></script>
    <link rel="stylesheet" href="/dmxAppConnect/dmxNotifications/dmxNotifications.css" />
    <script src="/dmxAppConnect/dmxNotifications/dmxNotifications.js" defer=""></script>
    <link rel="stylesheet" href="/bootstrap/5/css/bootstrap.min.css" />
    <script src="/dmxAppConnect/dmxBootstrap5Offcanvas/dmxBootstrap5Offcanvas.js" defer=""></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" integrity="sha384-NUDU7Qr8dfscXBIhA0px/bRl3cgNrOT9l/WPm15DzH5xnBs4fL4vgRiXURs98/ID" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://unpkg.com/@fullcalendar/core@4.4.2/main.min.css" />
    <script src="https://unpkg.com/@fullcalendar/core@4.4.2/main.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/core@4.4.2/locales-all.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/interaction@4.4.2/main.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/daygrid@4.4.2/main.min.js"></script>
    <script src="/dmxAppConnect/dmxCalendar/dmxCalendar.js" defer=""></script>
    <script src="/dmxAppConnect/dmxBootstrap4Modal/dmxBootstrap4Modal.js" defer=""></script>
    <script src="/dmxAppConnect/dmxMasonry/dmxMasonry.js" defer=""></script>
    <script src="/dmxAppConnect/dmxMoment/dmxMoment.js" defer=""></script>
</head>

<body id="standardHeaderFooter" style="min-height: 100vh;" class="main-section pe-0" is="dmx-app">
    <dmx-notifications id="notifies1" newest-on-top="true" closable="true" position="bottom" opacity="1" align="left"></dmx-notifications>
    <dmx-serverconnect id="getLevels" url="/api/getLevels" dmx-on:done="appSettings.load({})"></dmx-serverconnect>
    <dmx-serverconnect id="localization" url="/api/baseActions/localization" dmx-param:localizationid="appSettings.localization" cache="sessionStorage"></dmx-serverconnect>
    <dmx-serverconnect id="mySQLUsers" url="/api/sqlCurrentUser"></dmx-serverconnect>
    <dmx-serverconnect id="appSettings" url="/api/baseActions/getAppSettings" dmx-on:done="run({runJS:{function:'appSettingsObject',name:'setSettingsObject'}})" noload>
    </dmx-serverconnect>
    <dmx-serverconnect id="getCountries" url="/api/baseActions/getCountries"></dmx-serverconnect>
    <dmx-serverconnect id="getAllStaff" url="/api/staff/getAllStaff" dmx-on:done="run([{runJS:{function:'baseValues',args:[`getAllStaff.data.instructors.getInstructors`,'instructors']}},{runJS:{function:'baseValues',args:[`getAllStaff.data.allStaff`,'allStaff']}}])"></dmx-serverconnect>
    <dmx-serverconnect id="logout" noload url="/api/loginSecurity/logout" dmx-on:success="browser1.goto('/public')"></dmx-serverconnect>
    <dmx-query-manager id="queryManager"></dmx-query-manager>
    <dmx-session-manager id="sessionStorage"></dmx-session-manager>
    <dmx-serverconnect id="userDetails" url="api/loginSecurity/userDetails"></dmx-serverconnect>
    <dmx-serverconnect id="getAllStudentsAndFamilies" url="/api/getAllStudentsAndFamilies" noload></dmx-serverconnect>
    <dmx-serverconnect id="getRelationships" url="/api/getRelationships"></dmx-serverconnect>

    <dmx-serverconnect id="getContactTypes" url="/api/getContactTypes"></dmx-serverconnect>
    <dmx-serverconnect id="getFees" url="/api/families/getFees_SingleFamily" dmx-param:familyid="query.familyid" dmx-param:monthtocount="'2021-06-23'" dmx-on:done="run({runJS:{function:'familyStudentInfo',name:'familyStudentInfo'}})" noload>
    </dmx-serverconnect>
    <div class="modal fade" id="searchAll_ResultsModal" is="dmx-bs5-modal" tabindex="-1" role="dialog" nocloseonclick="true" dmx-on:hidden-bs-modal="queryManager.remove('searchtextfilter')" dmx-on:hide-bs-modal="globalSearchForm.reset()">
        <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
            <div class="modal-content">
                <dmx-value id="searchType"></dmx-value>
                <dmx-value id="var_fulltextConvert"></dmx-value>
                <div class="modal-header">
                    <h5 class="modal-title">Search Results for "{{var_fulltextConvert.value}}"</h5>
                    <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="modal">
                        <span aria-hidden="true" class="visually-hidden">Ã—</span>
                    </button>
                </div>
                <div class="modal-body" style="background: #fdfdfd;">
                    <section class="pb-4">
                        <div class="d-flex flex-column">
                            <label for="inp_searchModal" class="col-form-label">Search</label>
                            <input id="inp_searchModal" name="inp_searchModal" type="text" class="form-control form-control-lg me-2" style="font-size: 0.9rem;" dmx-bind:value="var_fulltextConvert.value" dmx-on:keyup.enter="run([{runJS:{function:'fulltextConvert',args:[`value`],name:'fullTextConvert'}},{run:{action:`queryManager.set(\'searchtextfilter\',fullTextConvert);searchAll_ResultsModal.var_fulltextConvert.setValue(value)`}},{wait:{delay:200}},{run:{action:`getAllStudentsAndFamilies.load({searchtextfilter: query.searchtextfilter})`}}])">
                        </div>

                    </section>
                    <section>
                        <div id="rp_families" is="dmx-repeat" dmx-bind:repeat="getAllStudentsAndFamilies.data.studentsAndFamilies" key="family">
                            <div class="row row-cols-1 border mb-3 pb-2 no-gutters shadow-light overflow-hidden bg-white" dmx-animate-enter.duration:500="fadeInUp" dmx-animate-leave.duration:300="fadeOut">

                                <div class="col py-3 px-2">
                                    <div class="row border-bottom align-items-center">

                                        <div class="col d-flex flex-row align-items-center">

                                            <a href="javascript:void(0);" class="btn btn-light circle-button mx-1" dmx-bind:href="'/families/familydetail/'+family"><i class="fas fa-user-friends fa-sm"></i></a>
                                            <h5 class="fw-light mb-0 ms-2">{{' '+primaryGuardian.firstName+' '+primaryGuardian.lastName}}<br>
                                                <p class="small fw-light mb-0 mt-1" style="color: #aaa !important; font-size: 0.75rem;">{{guardians.values(`' ' + firstName +' '+lastName`)}}</p>
                                            </h5>
                                        </div>
                                        <div class="d-flex col-12 align-items-stretch flex-column">
                                            <div class="row no-gutters px-1 mt-2">
                                                <div class="align-self-end col-1">
                                                    <p class="small mb-0">Action</p>
                                                </div>
                                                <div class="col-3 align-self-end ps-2">
                                                    <p class="small mb-0">Name</p>
                                                </div>
                                                <div class="align-self-end col-2">
                                                    <p class="small mb-0">Level</p>

                                                </div>
                                                <div class="align-self-end col-2">
                                                    <p class="small mb-0">Age</p>
                                                </div>
                                                <div class="align-self-end col-2">
                                                    <p class="small mb-0">Date of Birth</p>
                                                </div>
                                                <div class="col-1">
                                                    <p class="small" style="line-height: 1; margin-bottom: 3px;">Search Relevance</p>



                                                </div>
                                            </div>

                                        </div>
                                    </div>



                                    <div class="row row-cols-1" is="dmx-repeat" id="rp_studentsInFamily" dmx-bind:repeat="students">

                                        <dmx-value id="var_studentRelevance" dmx-bind:value="score/students.max(`score`) ? score/students.max(`score`)*100 : 0"></dmx-value>
                                        <div class="col">
                                            <div class="row no-gutters px-1">


                                                <div class="align-self-center py-2 col-1 d-flex flex-row">
                                                    <a id="studentInfoButton" class="btn circle-button-small btn-light me-1" dmx-bind:href="'/students/studentDetail/'+id"><i class="fas fa-info-circle fa-xs"></i></a>
                                                    <a id="enrolStudentButton" class="btn circle-button-small btn-light" dmx-bind:href="'/students/studentDetail/'+id" dmx-hide="searchType.value !== 'enrolment'"><i class="fas fa-user-plus fa-xs"></i></a>
                                                </div>
                                                <div class="py-2 ps-2 align-self-center col-3" dmx-text="firstName+' '+lastName">Student Full Name</div>
                                                <div class="py-2 align-self-center col-2" dmx-text="level">Level</div>
                                                <div class="align-self-center col-2" dmx-text="age">10y 1m</div>
                                                <div class="py-2 align-self-center col-2" dmx-text="dob.toDate().formatDate('dd-MM-yyyy')">Date of Birth</div>
                                                <div class="align-self-center col-1">

                                                    <div class="progress" style="height: 7px;">
                                                        <div class="progress-bar bg-success" role="progressbar" style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" dmx-style:width="var_studentRelevance.value+'%'"></div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div is="dmx-browser" id="browser1"></div>




    <section class="main-section">
        <div class="row w-100 g-0">
            <div class="col-auto p-0">
                <header class="side-header bg-primary">
                    <div class="row">
                        <div class="col-12">

                            <div class="row g-0">
                                <div class="col p-4 align-self-center text-center shadow"><img src="/assets/images/logo-11.png" width="120" class="img-fluid" style="opacity: 0.9;"></div>
                            </div>
                            <nav class="navbar navbar-expand-lg flex-column justify-content-center align-items-stretch p-0 navbar-light mt-4">
                                <div class="container-fluid p-0">
                                    <div class="navbar flex-row justify-content-end align-items-stretch w-100 p-0 navbar-dark" id="mainNavSidebar">
                                        <div class="px-0 container-fluid">
                                            <ul class="navbar-nav flex-column align-items-stretch justify-content-center w-100">
                                                <li class="nav-item">
                                                    <a class="nav-link pt-3 pb-3 pe-4 ps-4 text-start" href="/" dmx-class:disabled="active === true" internal>
                                                        Dashboard
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link pt-3 pb-3  pe-4 ps-4 text-start active" id="familyNavLink" href="/families" dmx-class:disabled="active === true">
                                                        Families
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a href="/students" class="nav-link pt-3 pb-3 pe-4 ps-4 text-start" dmx-class:disabled="active === true">
                                                        Students
                                                    </a>
                                                </li>
                                                <li class="nav-item">

                                                    <a class="nav-link pt-3 pb-3 pe-4 ps-4 text-start" href="/classes">
                                                        Classes
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link pt-3 pb-3 pe-4 ps-4 text-start" href="#">
                                                        Reports
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link pt-3 pb-3 pe-4 ps-4 text-start" href="javascript.void(0);" dmx-class:disabled="active === true">Users</a>

                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link pt-3 pb-3 pe-4 ps-4 text-start" href="/settings" dmx-class:disabled="active === true">Settings</a>

                                                </li>

                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </nav>
                        </div>
                    </div>
                </header>
            </div>
            <div class="col d-flex flex-column">


                <div class="row g-0 topbar border-bottom p-3 justify-content-between">
                    <div class="d-flex align-self-center col-auto">
                        <form action="" onsubmit="return false" id="globalSearchForm">
                            <div class="d-flex justify-content-center align-items-center text-dark me-3 flex-row">




                                <input id="inp_searchAll" name="searchAll" type="text" class="form-control form-control-lg me-2 small" placeholder="Search All Active Students/Families" style="font-size: 0.9rem; min-width: 300px;" dmx-on:keyup.enter="run([{runJS:{function:'fulltextConvert',args:[`globalSearchForm.inp_searchAll.value`],name:'fullTextConvert'}},{run:{action:`queryManager.set(\'searchtextfilter\',fullTextConvert);searchAll_ResultsModal.var_fulltextConvert.setValue(globalSearchForm.inp_searchAll.value)`}},{wait:{delay:200}},{run:{action:`getAllStudentsAndFamilies.load({searchtextfilter: query.searchtextfilter})`}},{wait:{delay:100}},{run:{action:`searchAll_ResultsModal.show()`}}])">
                            </div>

                        </form>
                    </div>
                    <div class="d-flex flex-row align-items-center justify-content-end clickable col-auto" dmx-on:click="logout.load()">

                        <div class="d-flex justify-content-center align-items-center text-dark flex-row">

                            <i class="far fa-user-circle fa-2x fa-fw"></i>
                            <p dmx-text="$_SESSION.localization.name" class="mt-1 mb-0">name</p>
                        </div>

                    </div>
                </div>
                <div class="row g-0 flex-1">
                    <div class="col p-0" style="">
                        <div is="dmx-view" id="content" class="d-flex h-100">

                            <%- await include(content, locals); %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>




    <script src="/js/custom.js" defer="true"></script>
    <script src="/js/tuitioncalc.js"></script>
    <script src="/bootstrap/5/js/bootstrap.bundle.min.js"></script>
</body>

</html>